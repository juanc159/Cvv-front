import{_ as Pe}from"./BtnBack.vue_vue_type_script_setup_true_lang-CTklSnVX.js";import{_ as ke}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-DCFDDQmI.js";import{_ as he}from"./AppSelectRemote-CJVMMhm8.js";import{_ as Ee}from"./AppTextField.vue_vue_type_script_setup_true_lang-CsCt6hsx.js";import{_ as Se}from"./AppSelect.vue_vue_type_script_setup_true_lang-B7VAs8De.js";import{ag as G,ah as O,a1 as de,ai as z,b as a,aJ as Ce,ak as le,P as re,Q as Ie,aK as Te,am as ce,X as V,aL as we,aM as me,a8 as Ae,aw as ie,aN as $e,aO as Fe,an as Re,aj as ve,au as je,aP as Be,aQ as Ne,$ as Ue,aR as De,aS as Le,aT as Me,a7 as x,at as qe,aU as Ge,aV as Oe,d as ze,U as Qe,q as Je,r as $,ax as Ke,M as Xe,c as E,o as v,f as o,ac as Ye,g as L,x as R,F as M,p as q,C as Z,D as y,ad as H,e as f,k as Ze,E as He,af as ue,al as We,ay as ea,Y as aa,Z as la}from"./index-Dl5ek0NS.js";import{c as ta}from"./createUrl-8-Jmup2S.js";import{b as na,V as oa}from"./VCard-rY6Noe6k.js";import{V as W}from"./VCardText--nLa4AsB.js";import{V as sa}from"./VForm-Cajyw0G7.js";import{V as j,a as S}from"./VRow-D1RC1T7e.js";import{u as ia,m as ua}from"./VOverlay-CcbbDn4H.js";import{V as da}from"./VTable-Df_d6DeN.js";import{_ as ra}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-BEoXigGb.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CkCvpngV.js";import"./VDialog-B_yTWE9k.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-DX65Ay37.js";import"./VInput-CmsT0ynG.js";import"./VImg-BPxl9zya.js";import"./VTooltip-CuN9trdF.js";import"./VSelect-CdHuoamg.js";import"./VTextField-DH2VakAb.js";/* empty css                   */import"./VCounter-BZS11_e3.js";import"./VList-DX-PfAWU.js";import"./ssrBoot-CRCz_0bP.js";import"./VAvatar-sof9KUP9.js";import"./VDivider-Cm2uZgFT.js";import"./VMenu-CCAMsYCM.js";import"./VCheckboxBtn-C2s4z4Fa.js";import"./VSelectionControl-ClIc-v4k.js";import"./VChip-CCQ5Itm2.js";import"./filter-BzQG20E3.js";import"./helpers-DtRiZpzE.js";import"./constants-2GBt7OCP.js";import"./index-0F-JFElI.js";/* empty css              */const B=Symbol.for("vuetify:v-expansion-panel"),pe=O({...le(),...ua()},"VExpansionPanelText"),ee=G()({name:"VExpansionPanelText",props:pe(),setup(e,b){let{slots:s}=b;const n=de(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:d,onAfterLeave:r}=ia(e,n.isSelected);return z(()=>a(Ce,{onAfterLeave:r},{default:()=>{var _;return[re(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[s.default&&d.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(_=s.default)==null?void 0:_.call(s)])]),[[Ie,n.isSelected.value]])]}})),{}}}),fe=O({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...le()},"VExpansionPanelTitle"),ae=G()({name:"VExpansionPanelTitle",directives:{Ripple:Te},props:fe(),setup(e,b){let{slots:s}=b;const n=de(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:d,backgroundColorStyles:r}=ce(e,"color"),_=V(()=>({collapseIcon:e.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),m=V(()=>n.isSelected.value?e.collapseIcon:e.expandIcon);return z(()=>{var C;return re(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},d.value,e.class],style:[r.value,e.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:e.readonly?void 0:n.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(C=s.default)==null?void 0:C.call(s,_.value),!e.hideActions&&a(me,{defaults:{VIcon:{icon:m.value}}},{default:()=>{var P;return[a("span",{class:"v-expansion-panel-title__icon"},[((P=s.actions)==null?void 0:P.call(s,_.value))??a(Ae,null,null)])]}})]),[[we("ripple"),e.ripple]])}),{}}}),_e=O({title:String,text:String,bgColor:String,...Ne(),...Be(),...je(),...ve(),...fe(),...pe()},"VExpansionPanel"),ca=G()({name:"VExpansionPanel",props:_e(),emits:{"group:selected":e=>!0},setup(e,b){let{slots:s}=b;const n=$e(e,B),{backgroundColorClasses:d,backgroundColorStyles:r}=ce(e,"bgColor"),{elevationClasses:_}=Fe(e),{roundedClasses:m}=Re(e),C=V(()=>(n==null?void 0:n.disabled.value)||e.disabled),P=V(()=>n.group.items.value.reduce((k,p,F)=>(n.group.selected.value.includes(p.id)&&k.push(F),k),[])),t=V(()=>{const k=n.group.items.value.findIndex(p=>p.id===n.id);return!n.isSelected.value&&P.value.some(p=>p-k===1)}),J=V(()=>{const k=n.group.items.value.findIndex(p=>p.id===n.id);return!n.isSelected.value&&P.value.some(p=>p-k===-1)});return Ue(B,n),z(()=>{const k=!!(s.text||e.text),p=!!(s.title||e.title),F=ae.filterProps(e),N=ee.filterProps(e);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":t.value,"v-expansion-panel--after-active":J.value,"v-expansion-panel--disabled":C.value},m.value,d.value,e.class],style:[r.value,e.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",..._.value]},null),a(me,{defaults:{VExpansionPanelTitle:{...F},VExpansionPanelText:{...N}}},{default:()=>{var T;return[p&&a(ae,{key:"title"},{default:()=>[s.title?s.title():e.title]}),k&&a(ee,{key:"text"},{default:()=>[s.text?s.text():e.text]}),(T=s.default)==null?void 0:T.call(s)]}})]})}),{groupItem:n}}}),ma=["default","accordion","inset","popout"],va=O({flat:Boolean,...Oe(),...Ge(_e(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...qe(),...le(),...ve(),variant:{type:String,default:"default",validator:e=>ma.includes(e)}},"VExpansionPanels"),pa=G()({name:"VExpansionPanels",props:va(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:s}=b;const{next:n,prev:d}=De(e,B),{themeClasses:r}=Le(e),_=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Me({VExpansionPanel:{bgColor:x(e,"bgColor"),collapseIcon:x(e,"collapseIcon"),color:x(e,"color"),eager:x(e,"eager"),elevation:x(e,"elevation"),expandIcon:x(e,"expandIcon"),focusable:x(e,"focusable"),hideActions:x(e,"hideActions"),readonly:x(e,"readonly"),ripple:x(e,"ripple"),rounded:x(e,"rounded"),static:x(e,"static")}}),z(()=>a(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,_.value,e.class],style:e.style},{default:()=>{var m;return[(m=s.default)==null?void 0:m.call(s,{prev:d,next:n})]}})),{next:n,prev:d}}}),Q=e=>(aa("data-v-5f1ae3c5"),e=e(),la(),e),fa=Q(()=>f("span",null," Formulario periodo escolar ",-1)),_a={key:0,class:"error--text"},ga={class:"text-center"},xa={class:"text-center"},ya=Q(()=>f("p",{class:"text-center"}," Reporte de materia pendiente. ",-1)),ba=Q(()=>f("th",null,"No.",-1)),Va=Q(()=>f("th",null,"ALUMNO",-1)),Pa={key:0},ka=["colspan"],ha=ze({__name:"Form",setup(e){const b=Qe(),s=Je(),{toast:n}=ea(),d=$({}),r=$(!1),_=$(),m=Ke({form:!1}),C=$([]),P=$([]),t=$({id:null,term_id:null,type_education_id:null,grade_id:null,code:null,students:[]}),J=()=>{t.value={id:null,term_id:null,type_education_id:null,grade_id:null,students:[]}},k=async()=>{var w;t.value.id=s.params.id;const i=t.value.id?`/pendingRegistration/${t.value.id}/edit`:"/pendingRegistration/create";m.form=!0;const{data:l,response:h}=await ue(ta(`${i}`,{query:{company_id:b.company.id}}));m.form=!1,(w=h.value)!=null&&w.ok&&l.value&&(l.value.form&&(t.value={id:l.value.form.id||null,term_id:l.value.form.term_id||null,code:l.value.form.code||null,type_education_id:l.value.form.type_education_id||null,grade_id:l.value.form.grade_id||null,students:l.value.form.students||[]}),l.value.terms&&(C.value=l.value.terms),l.value.typeEducations&&(P.value=l.value.typeEducations))},p=()=>{t.value.students.push({student_id:null,subjects:[]})},F=i=>{t.value.students.splice(i,1)},N=async()=>{var l,h;const i=await((l=_.value)==null?void 0:l.validate());if(i!=null&&i.valid){const w={...t.value,company_id:b.company.id,students:t.value.students.map(u=>({student_id:u.student_id,subjects:u.subjects}))},X=t.value.id?`/pendingRegistration/update/${t.value.id}`:"/pendingRegistration/store";m.form=!0;const{data:A,response:Y}=await ue(X).post(w);m.form=!1,(h=Y.value)!=null&&h.ok&&A.value&&A.value.code===200&&We.push({name:"PendingRegistration-List"}),A.value.code===422&&(d.value=A.value.errors??{})}else n("Faltan campos por diligenciar","","danger")};s.params.action==="view"&&(r.value=!0),Xe(async()=>{J(),await k()});const T=V(()=>Object.values(m).some(i=>i)),ge=[i=>!!i||"El código es obligatorio"],te=[i=>!!i||"El periodo es obligatorio"],xe=[i=>!!i||"El grado es obligatorio"],ye=[i=>!!i||"El estudiante es obligatorio"],be=[i=>i.length>0||"Debe seleccionar al menos una materia"],K=V(()=>{if(t.value.type_education_id){const i=P.value.find(l=>l.value==t.value.type_education_id);return i?i.grades:[]}return[]}),ne=V(()=>t.value.grade_id?K.value.find(i=>i.value==t.value.grade_id).subjects:[]),U=V(()=>{const i=t.value.students.flatMap(l=>l.subjects);return[...new Set(i)].map(l=>ne.value.find(h=>h.value===l)).filter(l=>l!==void 0)});return(i,l)=>{const h=Se,w=Ee,X=he,A=ke,Y=Pe;return v(),E("div",null,[a(oa,{disabled:m.form,loading:m.form},{default:o(()=>[a(na,{class:"d-flex justify-space-between"},{default:o(()=>[fa]),_:1}),a(W,null,{default:o(()=>[a(sa,{ref_key:"formValidation",ref:_,onSubmit:Ye(N,["prevent"]),disabled:r.value},{default:o(()=>[a(j,null,{default:o(()=>[a(S,{cols:"12",md:"3"},{default:o(()=>[a(h,{requiredField:"true",clearable:"",modelValue:t.value.term_id,"onUpdate:modelValue":l[0]||(l[0]=u=>t.value.term_id=u),items:C.value,label:"Periodo",rules:te,"error-messages":d.value.term_id,onChange:l[1]||(l[1]=u=>d.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(S,{cols:"12",md:"3"},{default:o(()=>[a(w,{requiredField:"true",modelValue:t.value.code,"onUpdate:modelValue":l[2]||(l[2]=u=>t.value.code=u),rules:ge,label:"Código de sección"},null,8,["modelValue"])]),_:1}),a(S,{cols:"12",md:"3"},{default:o(()=>[a(h,{requiredField:"true",clearable:"",modelValue:t.value.type_education_id,"onUpdate:modelValue":l[3]||(l[3]=u=>t.value.type_education_id=u),items:P.value,label:"Tipo de educación",rules:te,"error-messages":d.value.term_id,onChange:l[4]||(l[4]=u=>d.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(S,{cols:"12",md:"3"},{default:o(()=>[a(h,{requiredField:"true",clearable:"",modelValue:t.value.grade_id,"onUpdate:modelValue":l[5]||(l[5]=u=>t.value.grade_id=u),items:K.value,label:"Grados y niveles",rules:xe,"error-messages":d.value.grade_id,onChange:l[6]||(l[6]=u=>d.value.grade_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(S,{cols:"12"},{default:o(()=>[a(pa,{multiple:""},{default:o(()=>[(v(!0),E(M,null,q(t.value.students,(u,g)=>(v(),L(ca,{key:g},{default:o(()=>[a(ae,null,{actions:o(()=>[r.value?R("",!0):(v(),L(H,{key:0,icon:"tabler-x",color:"error",onClick:I=>F(g)},null,8,["onClick"]))]),default:o(()=>[Z(" Estudiante "+y(g+1)+" ",1)]),_:2},1024),a(ee,null,{default:o(()=>[a(j,null,{default:o(()=>[a(S,{cols:"12",md:"6"},{default:o(()=>[a(X,{modelValue:u.student_id,"onUpdate:modelValue":I=>u.student_id=I,url:"selectInfiniteStudent",arrayInfo:"student",rules:ye,label:"Estudiante","error-messages":d.value[`students.${g}.student_id`],onInput:I=>d.value[`students.${g}.student_id`]="",readonly:r.value,params:{type_education_id:t.value.type_education_id}},null,8,["modelValue","onUpdate:modelValue","error-messages","onInput","readonly","params"])]),_:2},1024),a(S,{cols:"12",md:"6"},{default:o(()=>[a(A,{modelValue:u.subjects,"onUpdate:modelValue":I=>u.subjects=I,items:ne.value,label:"Materias",multiple:"",chips:"","closable-chips":"",rules:be,"error-messages":d.value[`students.${g}.subjects`],onInput:I=>d.value[`students.${g}.subjects`]="",readonly:r.value},null,8,["modelValue","onUpdate:modelValue","items","error-messages","onInput","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value?R("",!0):(v(),L(H,{key:0,color:"primary",onClick:p,class:"mt-2"},{default:o(()=>[Z(" Agregar Estudiante ")]),_:1}))]),_:1})]),_:1}),a(j,null,{default:o(()=>[a(S,{cols:"12"},{default:o(()=>[Object.keys(d.value).length>0?(v(),E("div",_a," Por favor, corrige los errores indicados. ")):R("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),a(W,null,{default:o(()=>[a(j,null,{default:o(()=>[a(S,{cols:"12"},{default:o(()=>{var u;return[f("h2",ga,y(Ze(b).company.name),1),f("p",xa," Año Escolar: "+y(((u=C.value.find(g=>g.value===t.value.term_id))==null?void 0:u.title)||"N/A")+" | Fecha: "+y(new Date().toLocaleDateString("es-ES")),1),ya]}),_:1})]),_:1}),a(j,null,{default:o(()=>[a(S,{cols:"12"},{default:o(()=>{var u,g,I;return[f("h3",null," Sección: "+y(((u=C.value.find(c=>c.value===t.value.term_id))==null?void 0:u.title)||"N/A")+" - "+y(((g=P.value.find(c=>c.value===t.value.type_education_id))==null?void 0:g.title)||"N/A")+" - "+y(((I=K.value.find(c=>c.value===t.value.grade_id))==null?void 0:I.title)||"N/A")+" - "+y(t.value.code||"N/A"),1),a(da,{class:"bordered-table"},{default:o(()=>[f("thead",null,[f("tr",null,[ba,Va,(v(!0),E(M,null,q(U.value,c=>(v(),E("th",{key:c.value},y(c.abbreviation||c.title),1))),128))])]),f("tbody",null,[(v(!0),E(M,null,q(t.value.students,(c,Ve)=>{var oe,se;return v(),E("tr",{key:(oe=c.student_id)==null?void 0:oe.value},[f("td",null,y(Ve+1),1),f("td",null,y(((se=c.student_id)==null?void 0:se.title)||"N/A"),1),(v(!0),E(M,null,q(U.value,D=>(v(),E("td",{key:D.value,class:He({"bg-yellow-lighten-3":c.subjects.includes(D.value),"bg-grey-lighten-3":!c.subjects.includes(D.value)&&U.value.length>0})},y(c.subjects.includes(D.value)?"--":""),3))),128))])}),128)),t.value.students.length?R("",!0):(v(),E("tr",Pa,[f("td",{colspan:U.value.length+2,class:"text-center"}," No hay estudiantes seleccionados. ",8,ka)]))])]),_:1})]}),_:1})]),_:1})]),_:1}),a(W,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:o(()=>[a(Y,{disabled:T.value,loading:T.value},null,8,["disabled","loading"]),r.value?R("",!0):(v(),L(H,{key:0,disabled:T.value,loading:T.value,onClick:N,color:"primary"},{default:o(()=>[Z(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}}),rl=ra(ha,[["__scopeId","data-v-5f1ae3c5"]]);export{rl as default};
