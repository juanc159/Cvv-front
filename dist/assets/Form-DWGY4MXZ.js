import{r as V}from"./validators-C5VzIL3y.js";import{s as se}from"./helpers-CYfJIYD9.js";import{d as x,r as c,N as h,w as ee,h as L,o as B,c5 as ne,f as r,q as ue,l as e,e as N,b as t,c as P,y as D,aG as de,a9 as E,a7 as H,B as me,I as ce,n as fe,k as pe,V as ve,t as ye,a$ as Ve,Y as K,ac as ge,D as z,E as _e,cj as be,b2 as W,aR as ke,b0 as qe,aO as A}from"./index-ByDS42or.js";import{_ as Fe}from"./BtnBack.vue_vue_type_script_setup_true_lang-Bk-jEoB0.js";import{_ as Ie}from"./AppTextField.vue_vue_type_script_setup_true_lang-CSUd6utx.js";import{_ as $e}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-D796b4Uc.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-Co4K0IY6.js";import{V as we}from"./VTextField-BSqJvjJB.js";import{V as X}from"./VDivider-D45ckF3f.js";import{V as O,a as f}from"./VRow-BVDvheM5.js";import{u as Ce,V as Se}from"./VFileInput-CDRArdHf.js";import{a as Ue,V as Be}from"./VCard-Dezrb7fV.js";import{V as Z}from"./VCardText-CRFn74Z4.js";import{V as Ne}from"./VForm-Bo2H133k.js";import{V as Te}from"./VCheckbox-DbAhJwGC.js";import{V as je}from"./VImg-DTWKOLRH.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-2fJt202g.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BmiBEwCM.js";import"./VDialog-CMPgUipT.js";import"./dialog-transition-ymB-VPfO.js";import"./VSelect-6mppdgrf.js";import"./VList-DfcpPokg.js";import"./ssrBoot-_3Xo5dRQ.js";import"./VAvatar-Br4-W3BH.js";import"./VMenu-hs6MJuAQ.js";import"./VCheckboxBtn-IxLE1e6I.js";import"./VSelectionControl-_XC2OU_8.js";import"./VChip-DyHRgmO-.js";import"./filter-VEPPva_l.js";/* empty css                   */import"./VCounter-dqrrb-Y0.js";/* empty css              */import"./sweetalert2.esm.all-DV3w3JmD.js";const ze={key:0,class:"text-center"},Ae={key:1,class:"d-flex justify-content-between aling-items-center p-2"},Le=x({__name:"SelectInfinite",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},select:{type:Object,default:()=>({})},multiple:{type:Boolean,default:()=>!1}},emits:["clearVmodel"],setup(p,{emit:I}){const{items:S,loading:d,select:v}=p,g=I,m=c(!1);h(()=>{v.totalLinks.value>1&&(m.value=!0)});const n=()=>{g("clearVmodel",!0),v.next()},_=()=>{g("clearVmodel",!0),v.prev()};return ee(v.dataNueva,()=>{m.value==!1&&v.totalLinks.value>1&&(m.value=!0)}),($,b)=>{const l=ae;return B(),L(l,me($.$attrs,{items:p.select.dataNueva.value,multiple:p.multiple}),ne({_:2},[e(m)?{name:"prepend-item",fn:r(()=>[N("div",null,[t(we,{clearable:"",placeholder:"Buscar...	",class:"mb-2",modelValue:p.select.searchQueryInfinite.value,"onUpdate:modelValue":b[0]||(b[0]=k=>p.select.searchQueryInfinite.value=k)},null,8,["modelValue"]),t(X)])]),key:"0"}:void 0,e(m)?{name:"append-item",fn:r(()=>[N("div",null,[t(X),p.loading?(B(),P("div",ze,[t(de,{size:"24",color:"primary",indeterminate:""})])):D("",!0),p.loading?D("",!0):(B(),P("div",Ae,[t(O,null,{default:r(()=>[t(f,{sm:"6",class:"text-left"},{default:r(()=>[t(E,{class:"mt-2 ml-5",disabled:p.select.page.value<=1,onClick:b[1]||(b[1]=k=>_()),color:"primary",icon:""},{default:r(()=>[t(H,{icon:"tabler-chevron-left"})]),_:1},8,["disabled"])]),_:1}),t(f,{sm:"6",class:"text-right"},{default:r(()=>[t(E,{class:"mt-2 mr-5",disabled:p.select.page.value>=p.select.totalLinks.value,onClick:b[2]||(b[2]=k=>n()),color:"primary",icon:""},{default:r(()=>[t(H,{icon:"tabler-chevron-right"})]),_:1},8,["disabled"])]),_:1})]),_:1})]))])]),key:"1"}:void 0,ue($.$slots,(k,q)=>({name:q,fn:r(F=>[ce($.$slots,q,fe(pe(F||{})))])}))]),1040,["items","multiple"])}}});function Pe(p,I=[],S=0,d={}){const v=c(""),g=c([]),m=c(1),n=c(1),_=c({}),$=async()=>{m.value--,m.value<=1&&(m.value=1),await l()},b=async()=>{m.value++,m.value>n.value&&(m.value=n.value),await l()},l=async()=>{let q={page:m.value,searchQueryInfinite:v.value};for(const F in d)q[F]=d[F];for(const F in _.value)q[F]=_[F];await p(q),g.value=[],g.value.push(...I.value)};let k=null;return ee(v,async(q,F)=>{k&&clearTimeout(k),m.value=1;let w={page:m.value,searchQueryInfinite:q};for(const y in d)w[y]=d[y];for(const y in _.value)w[y]=_[y];k=setTimeout(async()=>{await p(w),g.value=[],I&&I.value!==void 0&&g.value.push(...I.value),S&&S.value!==void 0&&(n.value=S.value)},300)}),{searchQueryInfinite:v,dataNueva:g,page:m,filterInterno:_,next:b,prev:$,search:l,totalLinks:n}}const De=N("span",null," Formulario estudiante ",-1),Ee=N("b",{class:"text-warning"},"*",-1),Oe={style:{"block-size":"200px","inline-size":"200px"}},qa=x({__name:"Form",setup(p){const I=ve(),{toast:S}=qe(),d=c({}),v=c(!1),g=ye(),m=c(),n=Ve({form:!1,countries:!1,states:!1,cities:!1}),_=c([]),$=c([]),b=c([]),l=c({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null,nationalized:null}),k=()=>{for(const i in l.value)l.value[i]=null},q=async()=>{l.value.id=g.params.id||null;const i=l.value.id?`/student/${l.value.id}/edit`:"/student/create";n.form=!0;const{response:a,data:u}=await W(i).get();if(n.form=!1,a.status==200&&u&&(j.dataNueva.value=u.countries_arrayInfo,j.totalLinks.value=u.countries_countLinks,_.value=u.typeEducations,$.value=u.sections,b.value=u.typeDocuments,u.form)){l.value=u.form;const s=JSON.parse(JSON.stringify(u.form));u.form.id&&s.country_id&&s.state_id&&(await J(s.country_id),await Y(s.state_id),l.value.country_id=s.country_id,l.value.state_id=s.state_id,l.value.city_id=s.city_id)}},F=async()=>{var a;const i=await((a=m.value)==null?void 0:a.validate());if(i!=null&&i.valid){l.value.company_id=I.company.id;const u=l.value.id?`/student/update/${l.value.id}`:"/student/store",s=new FormData;for(const U in l.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(U)||s.append(U,l.value[U]);s.append("country_id",l.value.country_id.value),s.append("state_id",l.value.state_id),s.append("city_id",l.value.city_id),s.append("gender",l.value.gender),s.append("birthday",l.value.birthday),n.form=!0;const{data:C,response:T}=await W(u).post(s);n.form=!1,T.status==200&&C&&C.code==200&&ke.push({name:"Student-List"}),C.code===422&&(d.value=C.errors??{})}else S("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(v.value=!0),h(async()=>{k(),await q()});const w=K(()=>Object.values(n).some(i=>i)),y=c(Ce()),le=["jpg","jpeg","png"];y.value.allowedExtensions=le;const te=i=>{n.form=!0,y.value.handleImageSelected(i),setTimeout(()=>{l.value.photo=y.value.imageFile,n.form=!1},1e3)},ie=K(()=>l.value.type_education_id?_.value.find(i=>i.value==l.value.type_education_id).grades:[]),Q=c([]),M=c([]),R=c([]),G=c(1),j=Pe(async i=>{var s;n.countries=!0;const{data:a,response:u}=await A("/selectInfiniteCountries").post(i);n.countries=!1,(s=u.value)!=null&&s.ok&&a.value&&(R.value=a.value.countries_arrayInfo,G.value=a.value.countries_countLinks)},R,G,{}),J=async i=>{var s;l.value.state_id=null,l.value.city_id=null,n.states=!0;const{data:a,response:u}=await A(`/selectStates/${i.value}`).get();n.states=!1,(s=u.value)!=null&&s.ok&&a.value&&(Q.value=a.value.states)},Y=async i=>{var s;l.value.city_id=null,n.cities=!0;const{data:a,response:u}=await A(`/selectCities/${i}`).get();n.cities=!1,(s=u.value)!=null&&s.ok&&a.value&&(M.value=a.value.cities)},oe=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(i,a)=>{const u=ae,s=Le,C=$e,T=Ie,U=be,re=Fe;return B(),P("div",null,[t(Be,{disabled:e(n).form,loading:e(n).form},{default:r(()=>[t(Ue,{class:"d-flex justify-space-between"},{default:r(()=>[De]),_:1}),t(Z,null,{default:r(()=>[t(Ne,{ref_key:"formValidation",ref:m,onSubmit:ge(()=>{},["prevent"]),disabled:e(v)},{default:r(()=>[t(O,null,{default:r(()=>[t(f,{cols:"12",sm:"4"},{default:r(()=>[t(u,{items:e(_),clearable:"",requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).type_education_id,"onUpdate:modelValue":a[0]||(a[0]=o=>e(l).type_education_id=o),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",sm:"4"},{default:r(()=>[t(u,{clearable:"",items:e(ie),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).grade_id,"onUpdate:modelValue":a[1]||(a[1]=o=>e(l).grade_id=o),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",sm:"4"},{default:r(()=>[t(u,{clearable:"",items:e($),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).section_id,"onUpdate:modelValue":a[2]||(a[2]=o=>e(l).section_id=o),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",md:"3"},{default:r(()=>[t(s,{requiredField:!0,label:"País",returnObject:"",modelValue:e(l).country_id,"onUpdate:modelValue":[a[3]||(a[3]=o=>e(l).country_id=o),a[4]||(a[4]=o=>J(o))],select:e(j),"error-messages":e(d).country_id,onInput:a[5]||(a[5]=o=>e(d).country_id=""),clearable:"",loading:e(n).countries,rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),t(f,{cols:"12",md:"3"},{default:r(()=>[t(C,{loading:e(n).states,requiredField:!0,clearable:"",items:e(Q),modelValue:e(l).state_id,"onUpdate:modelValue":[a[6]||(a[6]=o=>e(l).state_id=o),a[7]||(a[7]=o=>Y(o))],label:"Estado","error-messages":e(d).state_id,onInput:a[8]||(a[8]=o=>e(d).state_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),t(f,{cols:"12",md:"4"},{default:r(()=>[t(C,{loading:e(n).cities,requiredField:!0,clearable:"",items:e(M),modelValue:e(l).city_id,"onUpdate:modelValue":a[9]||(a[9]=o=>e(l).city_id=o),label:"Municipio","error-messages":e(d).city_id,onInput:a[10]||(a[10]=o=>e(d).city_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),t(f,{cols:"12",md:"2"},{default:r(()=>[t(Te,{modelValue:e(l).nationalized,"onUpdate:modelValue":a[11]||(a[11]=o=>e(l).nationalized=o),label:"Nacionalizado","true-value":!0,"false-value":!1},{label:r(()=>[z(" Nacionalizado: "+_e(e(l).nationalized?"Sí":"No"),1)]),_:1},8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:r(()=>[t(u,{clearable:"",items:e(b),rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).type_document_id,"onUpdate:modelValue":a[12]||(a[12]=o=>e(l).type_document_id=o),label:"Tipo de documento"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:r(()=>[t(T,{clearable:"",modelValue:e(l).identity_document,"onUpdate:modelValue":a[13]||(a[13]=o=>e(l).identity_document=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).identity_document,label:"Documento",onInput:a[14]||(a[14]=o=>e(d).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:r(()=>[t(T,{clearable:"",modelValue:e(l).full_name,"onUpdate:modelValue":a[15]||(a[15]=o=>e(l).full_name=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).full_name,label:"Nombre completo",onInput:a[16]||(a[16]=o=>e(d).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:r(()=>[t(u,{clearable:"",modelValue:e(l).gender,"onUpdate:modelValue":a[17]||(a[17]=o=>e(l).gender=o),items:oe,rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).gender,label:"Sexo",onInput:a[18]||(a[18]=o=>e(d).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:r(()=>[t(U,{clearable:"",modelValue:e(l).birthday,"onUpdate:modelValue":a[19]||(a[19]=o=>e(l).birthday=o),label:"Fecha de nacimiento",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).birthday,onInput:a[20]||(a[20]=o=>e(d).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:r(()=>[t(U,{clearable:"",modelValue:e(l).real_entry_date,"onUpdate:modelValue":a[21]||(a[21]=o=>e(l).real_entry_date=o),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).real_entry_date,onInput:a[22]||(a[22]=o=>e(d).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:r(()=>[(B(),L(Se,{accept:"image/*",key:e(y).key,onChange:a[23]||(a[23]=o=>te(o)),"onClick:clear":e(y).clearData},{label:r(()=>[z(" Foto "),Ee]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),t(O,null,{default:r(()=>[t(f,{cols:"12",class:"d-flex justify-center"},{default:r(()=>[N("div",Oe,[t(je,{src:e(y).imageUrl??("storageBack"in i?i.storageBack:e(se))(e(l).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),t(Z,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:r(()=>[t(re,{disabled:e(w),loading:e(w)},null,8,["disabled","loading"]),e(v)?D("",!0):(B(),L(E,{key:0,disabled:e(w),loading:e(w),onClick:a[24]||(a[24]=o=>F()),color:"primary"},{default:r(()=>[z(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{qa as default};
