import{_ as Ve}from"./BtnBack.vue_vue_type_script_setup_true_lang-C5vA_tfb.js";import{_ as Pe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-BP5X1af2.js";import{_ as he}from"./AppSelectRemote-BKMzJUwW.js";import{_ as ke}from"./AppTextField.vue_vue_type_script_setup_true_lang-cHkkfYr8.js";import{_ as Ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-pYrGxrl_.js";import{aa as z,ab as O,a2 as ue,al as J,b as a,bG as Se,aL as le,Q as de,R as Ce,bz as Ie,aN as re,Y as V,bn as Te,ax as ce,a6 as Ae,aT as ie,ch as we,b8 as $e,ag as Fe,aK as me,ap as Re,ci as je,bd as Be,a0 as Ne,cc as De,ae as Ue,bc as Le,aE as x,an as Ge,c4 as qe,cf as Me,d as ze,V as Oe,t as Je,r as $,aU as Ke,N as Qe,c as k,o as p,f as s,a9 as Ye,h as G,y as R,F as q,q as M,D as H,E as y,a8 as W,e as f,l as Ze,G as He,aJ as We,aM as Xe,aV as ea,Z as aa,$ as la}from"./index-C7gq-Xb9.js";import{c as ta}from"./createUrl-BRg2gx9C.js";import{u as na}from"./useAxios-D6kVzBGn.js";import{a as sa,V as oa}from"./VCard-DjR3dutK.js";import{V as X}from"./VCardText-DtR8cI_Q.js";import{V as ia}from"./VForm-CxFUQuVz.js";import{V as j,a as E}from"./VRow-DfkkFJQg.js";import{i as ua,j as da}from"./VOverlay-BArw2f8k.js";import{V as ra}from"./VTable-VI3X9lYo.js";import{_ as ca}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-sIRAKf5S.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-D4lGEif_.js";import"./VDialog-DLue3QBw.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Dd-PIA-g.js";import"./VInput-D04z8p--.js";import"./VImg-D87aqgsW.js";import"./VTooltip-D3Gr4Qxj.js";import"./VSelect-BuTSKxZ8.js";import"./VTextField-Dj2nad-E.js";/* empty css                   */import"./VCounter--xPgYE0_.js";import"./VList-B9_by0pS.js";import"./ssrBoot-Cc7Riqe3.js";import"./VAvatar-BKM6izw6.js";import"./VDivider-JBIkLMLZ.js";import"./VMenu-1IvMASI9.js";import"./VCheckboxBtn-CbsKncEP.js";import"./VSelectionControl-CHX8DjRR.js";import"./VChip-H-NQfO6J.js";import"./filter-DlA0a0Hp.js";import"./helpers-D3s11r0A.js";import"./constants-2GBt7OCP.js";import"./index-0F-JFElI.js";/* empty css              */const B=Symbol.for("vuetify:v-expansion-panel"),pe=O({...le(),...da()},"VExpansionPanelText"),ee=z()({name:"VExpansionPanelText",props:pe(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:r}=ua(e,n.isSelected);return J(()=>a(Se,{onAfterLeave:r},{default:()=>{var _;return[de(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&u.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(_=o.default)==null?void 0:_.call(o)])]),[[Ce,n.isSelected.value]])]}})),{}}}),ve=O({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...le()},"VExpansionPanelTitle"),ae=z()({name:"VExpansionPanelTitle",directives:{Ripple:Ie},props:ve(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"color"),_=V(()=>({collapseIcon:e.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),m=V(()=>n.isSelected.value?e.collapseIcon:e.expandIcon);return J(()=>{var S;return de(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[r.value,e.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:e.readonly?void 0:n.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(S=o.default)==null?void 0:S.call(o,_.value),!e.hideActions&&a(ce,{defaults:{VIcon:{icon:m.value}}},{default:()=>{var P;return[a("span",{class:"v-expansion-panel-title__icon"},[((P=o.actions)==null?void 0:P.call(o,_.value))??a(Ae,null,null)])]}})]),[[Te("ripple"),e.ripple]])}),{}}}),fe=O({title:String,text:String,bgColor:String,...Be(),...je(),...Re(),...me(),...ve(),...pe()},"VExpansionPanel"),ma=z()({name:"VExpansionPanel",props:fe(),emits:{"group:selected":e=>!0},setup(e,b){let{slots:o}=b;const n=we(e,B),{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"bgColor"),{elevationClasses:_}=$e(e),{roundedClasses:m}=Fe(e),S=V(()=>(n==null?void 0:n.disabled.value)||e.disabled),P=V(()=>n.group.items.value.reduce((h,v,F)=>(n.group.selected.value.includes(v.id)&&h.push(F),h),[])),t=V(()=>{const h=n.group.items.value.findIndex(v=>v.id===n.id);return!n.isSelected.value&&P.value.some(v=>v-h===1)}),Q=V(()=>{const h=n.group.items.value.findIndex(v=>v.id===n.id);return!n.isSelected.value&&P.value.some(v=>v-h===-1)});return Ne(B,n),J(()=>{const h=!!(o.text||e.text),v=!!(o.title||e.title),F=ae.filterProps(e),N=ee.filterProps(e);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":t.value,"v-expansion-panel--after-active":Q.value,"v-expansion-panel--disabled":S.value},m.value,u.value,e.class],style:[r.value,e.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",..._.value]},null),a(ce,{defaults:{VExpansionPanelTitle:{...F},VExpansionPanelText:{...N}}},{default:()=>{var T;return[v&&a(ae,{key:"title"},{default:()=>[o.title?o.title():e.title]}),h&&a(ee,{key:"text"},{default:()=>[o.text?o.text():e.text]}),(T=o.default)==null?void 0:T.call(o)]}})]})}),{groupItem:n}}}),pa=["default","accordion","inset","popout"],va=O({flat:Boolean,...Me(),...qe(fe(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...Ge(),...le(),...me(),variant:{type:String,default:"default",validator:e=>pa.includes(e)}},"VExpansionPanels"),fa=z()({name:"VExpansionPanels",props:va(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:o}=b;const{next:n,prev:u}=De(e,B),{themeClasses:r}=Ue(e),_=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Le({VExpansionPanel:{bgColor:x(e,"bgColor"),collapseIcon:x(e,"collapseIcon"),color:x(e,"color"),eager:x(e,"eager"),elevation:x(e,"elevation"),expandIcon:x(e,"expandIcon"),focusable:x(e,"focusable"),hideActions:x(e,"hideActions"),readonly:x(e,"readonly"),ripple:x(e,"ripple"),rounded:x(e,"rounded"),static:x(e,"static")}}),J(()=>a(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,_.value,e.class],style:e.style},{default:()=>{var m;return[(m=o.default)==null?void 0:m.call(o,{prev:u,next:n})]}})),{next:n,prev:u}}}),K=e=>(aa("data-v-3260d25e"),e=e(),la(),e),_a=K(()=>f("span",null," Formulario periodo escolar ",-1)),ga={key:0,class:"error--text"},xa={class:"text-center"},ya={class:"text-center"},ba=K(()=>f("p",{class:"text-center"}," Reporte de materia pendiente. ",-1)),Va=K(()=>f("th",null,"No.",-1)),Pa=K(()=>f("th",null,"ALUMNO",-1)),ha={key:0},ka=["colspan"],Ea=ze({__name:"Form",setup(e){const b=Oe(),o=Je(),{toast:n}=ea(),u=$({}),r=$(!1),_=$(),m=Ke({form:!1}),S=$([]),P=$([]),t=$({id:null,term_id:null,type_education_id:null,grade_id:null,code:null,students:[]}),Q=()=>{t.value={id:null,term_id:null,type_education_id:null,grade_id:null,students:[]}},h=async()=>{var A;t.value.id=o.params.id;const i=t.value.id?`/pendingRegistration/${t.value.id}/edit`:"/pendingRegistration/create";m.form=!0;const{data:l,response:C}=await We(ta(`${i}`,{query:{company_id:b.company.id}}));m.form=!1,(A=C.value)!=null&&A.ok&&l.value&&(l.value.form&&(t.value={id:l.value.form.id||null,term_id:l.value.form.term_id||null,code:l.value.form.code||null,type_education_id:l.value.form.type_education_id||null,grade_id:l.value.form.grade_id||null,students:l.value.form.students||[]}),l.value.terms&&(S.value=l.value.terms),l.value.typeEducations&&(P.value=l.value.typeEducations))},v=()=>{t.value.students.push({student_id:null,subjects:[]})},F=i=>{t.value.students.splice(i,1)},N=async()=>{var l;const i=await((l=_.value)==null?void 0:l.validate());if(i!=null&&i.valid){const C={...t.value,company_id:b.company.id,students:t.value.students.map(U=>({student_id:U.student_id,subjects:U.subjects}))},A=t.value.id?`/pendingRegistration/update/${t.value.id}`:"/pendingRegistration/store";m.form=!0;const{data:w,response:Z}=await na(A).post(C);m.form=!1,Z.status==200&&w&&w.code===200&&Xe.push({name:"PendingRegistration-List"}),w.code===422&&(u.value=w.errors??{})}else n("Faltan campos por diligenciar","","danger")};o.params.action==="view"&&(r.value=!0),Qe(async()=>{Q(),await h()});const T=V(()=>Object.values(m).some(i=>i)),_e=[i=>!!i||"El código es obligatorio"],te=[i=>!!i||"El periodo es obligatorio"],ge=[i=>!!i||"El grado es obligatorio"],xe=[i=>!!i||"El estudiante es obligatorio"],ye=[i=>i.length>0||"Debe seleccionar al menos una materia"],Y=V(()=>{if(t.value.type_education_id){const i=P.value.find(l=>l.value==t.value.type_education_id);return i?i.grades:[]}return[]}),ne=V(()=>t.value.grade_id?Y.value.find(i=>i.value==t.value.grade_id).subjects:[]),D=V(()=>{const i=t.value.students.flatMap(l=>l.subjects);return[...new Set(i)].map(l=>ne.value.find(C=>C.value===l)).filter(l=>l!==void 0)});return(i,l)=>{const C=Ee,A=ke,w=he,Z=Pe,U=Ve;return p(),k("div",null,[a(oa,{disabled:m.form,loading:m.form},{default:s(()=>[a(sa,{class:"d-flex justify-space-between"},{default:s(()=>[_a]),_:1}),a(X,null,{default:s(()=>[a(ia,{ref_key:"formValidation",ref:_,onSubmit:Ye(N,["prevent"]),disabled:r.value},{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.term_id,"onUpdate:modelValue":l[0]||(l[0]=d=>t.value.term_id=d),items:S.value,label:"Periodo",rules:te,"error-messages":u.value.term_id,onChange:l[1]||(l[1]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(A,{requiredField:"true",modelValue:t.value.code,"onUpdate:modelValue":l[2]||(l[2]=d=>t.value.code=d),rules:_e,label:"Código de sección"},null,8,["modelValue"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.type_education_id,"onUpdate:modelValue":l[3]||(l[3]=d=>t.value.type_education_id=d),items:P.value,label:"Tipo de educación",rules:te,"error-messages":u.value.term_id,onChange:l[4]||(l[4]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.grade_id,"onUpdate:modelValue":l[5]||(l[5]=d=>t.value.grade_id=d),items:Y.value,label:"Grados y niveles",rules:ge,"error-messages":u.value.grade_id,onChange:l[6]||(l[6]=d=>u.value.grade_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12"},{default:s(()=>[a(fa,{multiple:""},{default:s(()=>[(p(!0),k(q,null,M(t.value.students,(d,g)=>(p(),G(ma,{key:g},{default:s(()=>[a(ae,null,{actions:s(()=>[r.value?R("",!0):(p(),G(W,{key:0,icon:"tabler-x",color:"error",onClick:I=>F(g)},null,8,["onClick"]))]),default:s(()=>[H(" Estudiante "+y(g+1)+" ",1)]),_:2},1024),a(ee,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"6"},{default:s(()=>[a(w,{modelValue:d.student_id,"onUpdate:modelValue":I=>d.student_id=I,url:"selectInfiniteStudent",arrayInfo:"student",rules:xe,label:"Estudiante","error-messages":u.value[`students.${g}.student_id`],onInput:I=>u.value[`students.${g}.student_id`]="",readonly:r.value,params:{type_education_id:t.value.type_education_id}},null,8,["modelValue","onUpdate:modelValue","error-messages","onInput","readonly","params"])]),_:2},1024),a(E,{cols:"12",md:"6"},{default:s(()=>[a(Z,{modelValue:d.subjects,"onUpdate:modelValue":I=>d.subjects=I,items:ne.value,label:"Materias",multiple:"",chips:"","closable-chips":"",rules:ye,"error-messages":u.value[`students.${g}.subjects`],onInput:I=>u.value[`students.${g}.subjects`]="",readonly:r.value},null,8,["modelValue","onUpdate:modelValue","items","error-messages","onInput","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value?R("",!0):(p(),G(W,{key:0,color:"primary",onClick:v,class:"mt-2"},{default:s(()=>[H(" Agregar Estudiante ")]),_:1}))]),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>[Object.keys(u.value).length>0?(p(),k("div",ga," Por favor, corrige los errores indicados. ")):R("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),a(X,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d;return[f("h2",xa,y(Ze(b).company.name),1),f("p",ya," Año Escolar: "+y(((d=S.value.find(g=>g.value===t.value.term_id))==null?void 0:d.title)||"N/A")+" | Fecha: "+y(new Date().toLocaleDateString("es-ES")),1),ba]}),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d,g,I;return[f("h3",null," Sección: "+y(((d=S.value.find(c=>c.value===t.value.term_id))==null?void 0:d.title)||"N/A")+" - "+y(((g=P.value.find(c=>c.value===t.value.type_education_id))==null?void 0:g.title)||"N/A")+" - "+y(((I=Y.value.find(c=>c.value===t.value.grade_id))==null?void 0:I.title)||"N/A")+" - "+y(t.value.code||"N/A"),1),a(ra,{class:"bordered-table"},{default:s(()=>[f("thead",null,[f("tr",null,[Va,Pa,(p(!0),k(q,null,M(D.value,c=>(p(),k("th",{key:c.value},y(c.abbreviation||c.title),1))),128))])]),f("tbody",null,[(p(!0),k(q,null,M(t.value.students,(c,be)=>{var se,oe;return p(),k("tr",{key:(se=c.student_id)==null?void 0:se.value},[f("td",null,y(be+1),1),f("td",null,y(((oe=c.student_id)==null?void 0:oe.title)||"N/A"),1),(p(!0),k(q,null,M(D.value,L=>(p(),k("td",{key:L.value,class:He({"bg-yellow-lighten-3":c.subjects.includes(L.value),"bg-grey-lighten-3":!c.subjects.includes(L.value)&&D.value.length>0})},y(c.subjects.includes(L.value)?"--":""),3))),128))])}),128)),t.value.students.length?R("",!0):(p(),k("tr",ha,[f("td",{colspan:D.value.length+2,class:"text-center"}," No hay estudiantes seleccionados. ",8,ka)]))])]),_:1})]}),_:1})]),_:1})]),_:1}),a(X,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[a(U,{disabled:T.value,loading:T.value},null,8,["disabled","loading"]),r.value?R("",!0):(p(),G(W,{key:0,disabled:T.value,loading:T.value,onClick:N,color:"primary"},{default:s(()=>[H(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}}),ml=ca(Ea,[["__scopeId","data-v-3260d25e"]]);export{ml as default};
