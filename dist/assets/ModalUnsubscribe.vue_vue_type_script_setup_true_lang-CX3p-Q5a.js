import{r as le}from"./validators-DQNwaKQj.js";import{_ as xe}from"./ModalQuestion.vue_vue_type_script_setup_true_lang-B9CXAvdJ.js";import{ae as Ve,af as _e,ag as he,ca as be,Y as P,r as v,am as we,aC as ye,N as Ce,w as D,aF as ke,aq as Fe,cb as Ie,cc as oe,cd as Pe,b as a,B as j,ar as Se,ce as Te,cf as Me,aA as J,aL as $e,bf as Re,F as K,cg as Ae,Q as ne,bA as Be,cR as De,ci as Ne,d as fe,c5 as E,c as X,o as B,G as qe,h as W,y as Q,l as t,f as i,D as N,E as S,e as f,ad as ze,a7 as Ge,b6 as Ue,n as se,k as ie,c6 as He,q as Ee,I as Qe,aa as je,aT as re,cs as Le,a9 as ue}from"./index-CtOr4Wu7.js";/* empty css                   */import{V as Oe}from"./VCounter-DANGpuYg.js";import{I as Ye}from"./VImg-Ctxsnw81.js";import{_ as Je}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-6vZWU1pl.js";import{V as Ke}from"./VDialog-CybUf8DC.js";import{V as We}from"./VCard-COZucsTL.js";import{V as Xe,a as Ze}from"./VToolbar-5bAjszzX.js";import{V as de}from"./VCardText-v8gCKQRH.js";import{V as et}from"./VAlert-RNrtyRu5.js";import{V as tt}from"./VForm-BhvUgRDX.js";import{V as at}from"./VContainer-B-_GlBEv.js";import{V as lt,a as ce}from"./VRow-C1C7EzPn.js";const ot=_e({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Me(),...Te()},"VTextarea"),nt=Ve()({name:"VTextarea",directives:{Intersect:Ye},inheritAttrs:!1,props:ot(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,T){let{attrs:y,emit:M,slots:s}=T;const n=he(e,"modelValue"),{isFocused:g,focus:x,blur:d}=be(e),c=P(()=>typeof e.counterValue=="function"?e.counterValue(n.value):(n.value||"").toString().length),q=P(()=>{if(y.maxlength)return y.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function $(o,p){var m,w;!e.autofocus||!o||(w=(m=p[0].target)==null?void 0:m.focus)==null||w.call(m)}const z=v(),R=v(),G=we(""),_=v(),L=P(()=>e.persistentPlaceholder||g.value||e.active);function h(){var o;_.value!==document.activeElement&&((o=_.value)==null||o.focus()),g.value||x()}function r(o){h(),M("click:control",o)}function l(o){M("mousedown:control",o)}function C(o){o.stopPropagation(),h(),J(()=>{n.value="",Ne(e["onClick:clear"],o)})}function b(o){var m;const p=o.target;if(n.value=p.value,(m=e.modelModifiers)!=null&&m.trim){const w=[p.selectionStart,p.selectionEnd];J(()=>{p.selectionStart=w[0],p.selectionEnd=w[1]})}}const V=v(),k=v(+e.rows),u=P(()=>["plain","underlined"].includes(e.variant));ye(()=>{e.autoGrow||(k.value=+e.rows)});function A(){e.autoGrow&&J(()=>{if(!V.value||!R.value)return;const o=getComputedStyle(V.value),p=getComputedStyle(R.value.$el),m=parseFloat(o.getPropertyValue("--v-field-padding-top"))+parseFloat(o.getPropertyValue("--v-input-padding-top"))+parseFloat(o.getPropertyValue("--v-field-padding-bottom")),w=V.value.scrollHeight,U=parseFloat(o.lineHeight),O=Math.max(parseFloat(e.rows)*U+m,parseFloat(p.getPropertyValue("--v-input-control-height"))),Y=parseFloat(e.maxRows)*U+m||1/0,I=Re(w??0,O,Y);k.value=Math.floor((I-m)/U),G.value=$e(I)})}Ce(A),D(n,A),D(()=>e.rows,A),D(()=>e.maxRows,A),D(()=>e.density,A);let F;return D(V,o=>{o?(F=new ResizeObserver(A),F.observe(V.value)):F==null||F.disconnect()}),ke(()=>{F==null||F.disconnect()}),Fe(()=>{const o=!!(s.counter||e.counter||e.counterValue),p=!!(o||s.details),[m,w]=Ie(y),{modelValue:U,...O}=oe.filterProps(e),Y=Pe(e);return a(oe,j({ref:z,modelValue:n.value,"onUpdate:modelValue":I=>n.value=I,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":u.value},e.class],style:e.style},m,O,{centerAffix:k.value===1&&!u.value,focused:g.value}),{...s,default:I=>{let{id:H,isDisabled:Z,isDirty:ee,isReadonly:me,isValid:ve}=I;return a(Ae,j({ref:R,style:{"--v-textarea-control-height":G.value},onClick:r,onMousedown:l,"onClick:clear":C,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Y,{id:H.value,active:L.value||ee.value,centerAffix:k.value===1&&!u.value,dirty:ee.value||e.dirty,disabled:Z.value,focused:g.value,error:ve.value===!1}),{...s,default:ge=>{let{props:{class:te,...ae}}=ge;return a(K,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),ne(a("textarea",j({ref:_,class:te,value:n.value,onInput:b,autofocus:e.autofocus,readonly:me.value,disabled:Z.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:h,onBlur:d},ae,w),null),[[Be("intersect"),{handler:$},null,{once:!0}]]),e.autoGrow&&ne(a("textarea",{class:[te,"v-textarea__sizer"],id:`${ae.id}-sizer`,"onUpdate:modelValue":pe=>n.value=pe,ref:V,readonly:!0,"aria-hidden":"true"},null),[[De,n.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:p?I=>{var H;return a(K,null,[(H=s.details)==null?void 0:H.call(s,I),o&&a(K,null,[a("span",null,null),a(Oe,{active:e.persistentCounter||g.value,value:c.value,max:q.value,disabled:e.disabled},s.counter)])])}:void 0})}),Se({},z,R,_)}}),st={key:0},it=f("b",{class:"text-warning"},"*",-1),rt=fe({name:"AppTextarea",inheritAttrs:!1,__name:"AppTextarea",setup(e){const T=P(()=>{const n=E(),g=n.id||n.label;return g?`app-textarea-${g}-${Math.random().toString(36).slice(2,7)}`:void 0}),y=P(()=>E().label),M=P(()=>E().requiredField),s=P(()=>E().tooltip);return(n,g)=>(B(),X("div",{class:qe(["app-textarea flex-grow-1",n.$attrs.class])},[t(y)?(B(),W(Ue,{key:0,for:t(T),class:"mb-1 text-body-2 text-high-emphasis"},{default:i(()=>[N(S(t(y))+" ",1),t(M)?(B(),X("span",st,[N("  "),it])):Q("",!0),t(s)?(B(),W(ze,{key:1,location:t(s).location??"top"},{activator:i(({props:x})=>[t(s).icon?(B(),W(Ge,j({key:0},x,{icon:t(s).icon}),null,16,["icon"])):Q("",!0)]),default:i(()=>[f("span",null,S(t(s).text),1)]),_:1},8,["location"])):Q("",!0)]),_:1},8,["for"])):Q("",!0),a(nt,se(ie({...n.$attrs,class:null,label:void 0,variant:"outlined",id:t(T)})),He({_:2},[Ee(n.$slots,(x,d)=>({name:d,fn:i(c=>[Qe(n.$slots,d,se(ie(c||{})))])}))]),1040)],2))}}),ut={class:"student-info"},dt={class:"text-h6 mb-2"},ct={class:"d-flex gap-4"},ft=f("span",{class:"text-caption"},"Identificación:",-1),mt={class:"font-weight-medium"},vt=f("span",{class:"text-caption"},"Grado:",-1),gt={class:"font-weight-medium"},pt=f("span",{class:"text-caption"},"Sección:",-1),xt={class:"font-weight-medium"},Rt=fe({__name:"ModalUnsubscribe",emits:["execute"],setup(e,{expose:T,emit:y}){const M=y,s=v({}),n=v(),g=v("Dar de baja"),x=v(!1),d=v(!1),c=v({id:null,date:null,reason:null}),q=()=>{for(const r in c.value)c.value[r]=null},$=()=>{x.value=!x.value},z=async r=>{q(),$(),c.value.id=r,await R()},R=async()=>{var b;const r=`/student/show/${c.value.id}`;d.value=!0;const{data:l,response:C}=await re(r).get();d.value=!1,(b=C.value)!=null&&b.ok&&l.value&&(h.value={fullName:l.value.student.full_name,document:l.value.student.identity_document,grade:l.value.student.grade_name,section:l.value.student.section_name})},G=async r=>{var C,b;const l=await((C=n.value)==null?void 0:C.validate());if(l!=null&&l.valid){const V="/student/withdraw";d.value=!0;const{response:k,data:u}=await re(V).post({student_id:c.value.id,date:c.value.date,reason:c.value.reason});d.value=!1,(b=k.value)!=null&&b.ok&&u.value&&(q(),$(),M("execute")),u.value.code==422&&(s.value=u.value.errors??{})}},_=v(),L=async()=>{var l;const r=await((l=n.value)==null?void 0:l.validate());r!=null&&r.valid&&(_.value.openModal(),_.value.componentData.title="¿Seguro desea dar de baja al estudiante?",_.value.componentData.subTitle="Verifique la información")},h=v({fullName:"",document:"",grade:"",section:""});return T({openModal:z}),(r,l)=>{const C=Je,b=Le,V=rt,k=xe;return B(),X("div",null,[a(Ke,{modelValue:t(x),"onUpdate:modelValue":l[6]||(l[6]=u=>je(x)?x.value=u:null),overlay:!1,"max-width":"50rem",transition:"dialog-transition",persistent:""},{default:i(()=>[a(C,{onClick:$}),a(We,{loading:t(d),disabled:t(d),class:"w-100"},{default:i(()=>[f("div",null,[a(Xe,{color:"primary"},{default:i(()=>[a(Ze,null,{default:i(()=>[N(S(t(g)),1)]),_:1})]),_:1})]),a(de,{class:"pt-4 pb-0"},{default:i(()=>[a(et,{color:"info",variant:"tonal",border:"start",class:"mb-4"},{default:i(()=>[f("div",ut,[f("div",dt,S(t(h).fullName),1),f("div",ct,[f("div",null,[ft,f("span",mt,S(t(h).document),1)]),f("div",null,[vt,f("span",gt,S(t(h).grade),1)]),f("div",null,[pt,f("span",xt,S(t(h).section),1)])])])]),_:1}),a(tt,{ref_key:"refForm",ref:n},{default:i(()=>[a(at,null,{default:i(()=>[a(lt,null,{default:i(()=>[a(ce,{cols:"6"},{default:i(()=>[a(b,{clearable:"",modelValue:t(c).date,"onUpdate:modelValue":l[0]||(l[0]=u=>t(c).date=u),label:"Fecha",rules:["requiredValidator"in r?r.requiredValidator:t(le)],requiredField:!0,"error-messages":t(s).date,onInput:l[1]||(l[1]=u=>t(s).date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),a(ce,{cols:"12"},{default:i(()=>[a(V,{requiredField:!0,rules:["requiredValidator"in r?r.requiredValidator:t(le)],label:"Motivo",modelValue:t(c).reason,"onUpdate:modelValue":l[2]||(l[2]=u=>t(c).reason=u),clearable:"",counter:"",maxlength:"255","error-messages":t(s).reason,onInput:l[3]||(l[3]=u=>t(s).reason="")},null,8,["rules","modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),a(de,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:i(()=>[a(ue,{disabled:t(d),loading:t(d),onClick:l[4]||(l[4]=u=>$()),color:"secondary"},{default:i(()=>[N(" Cancelar ")]),_:1},8,["disabled","loading"]),a(ue,{disabled:t(d),loading:t(d),onClick:l[5]||(l[5]=u=>L())},{default:i(()=>[N(" Guardar ")]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"]),a(k,{ref_key:"refModalQuestion",ref:_,onSuccess:G},null,512)])}}});export{Rt as _};
