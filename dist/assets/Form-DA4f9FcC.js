import{V as X,r as c}from"./VForm-C_VY5s65.js";import{s as Y}from"./helpers-CnH0NzrM.js";import{d as x,U as h,r as f,ax as ee,M as ae,Z as L,o as w,c as te,b as o,f as s,ac as le,k as e,C as V,D as I,g as M,e as $,ad as re,G as oe,q as ie,af as g,al as se,ay as ne}from"./index-CcfxEA9J.js";import{_ as de}from"./BtnBack.vue_vue_type_script_setup_true_lang-DhZ6XDmC.js";import{_ as ue}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-BqlGBWdW.js";import{_ as me}from"./AppTextField.vue_vue_type_script_setup_true_lang-DMX7TPyW.js";import{_ as pe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-v0zvpqJ9.js";import{u as ce,_ as fe}from"./useSelect-CD5mmM_r.js";import{_ as ve}from"./AppSelect.vue_vue_type_script_setup_true_lang-DSyOWEz4.js";import{u as _e,V as ye}from"./VFileInput-BCcDBNfm.js";import{b as Ve,V as ge}from"./VCard-Bb7fU1OW.js";import{V as O}from"./VCardText-CrpFKe7H.js";import{V as P,a as p}from"./VRow-BB-Tc9CP.js";import{V as be}from"./VImg-CHL4UATN.js";import"./VInput-DpNqDOMP.js";import"./VOverlay-tVnM_4i-.js";import"./forwardRefs-C-GTDzx5.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-BBqlJdmz.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BKvizcS6.js";import"./VDialog-LtlldOVe.js";import"./dialog-transition-Dz_33E-b.js";import"./VTooltip-Co-ifymK.js";import"./VTextField-k62YHRXZ.js";/* empty css                   */import"./VCounter-CLfbNniX.js";import"./VSelect-BsTOo0f7.js";import"./VList-Dp2ylIJw.js";import"./ssrBoot-D2MbKfV7.js";import"./VAvatar-CN6m6zdu.js";import"./VDivider-CmEecuQO.js";import"./VMenu-sZBHjbSF.js";import"./VCheckboxBtn-KUH_B3Ck.js";import"./VSelectionControl-Ebi_j9EQ.js";import"./VChip-Bxsel7rB.js";import"./filter-Oxhq_Xc_.js";import"./sweetalert2.esm.all-DOYwHpwi.js";/* empty css              */const qe=$("span",null," Formulario estudiante ",-1),ke=$("b",{class:"text-warning"},"*",-1),Fe={style:{"block-size":"200px","inline-size":"200px"}},ua=x({__name:"Form",setup(Ce){const G=h(),{toast:z}=ne(),u=f({}),k=f(!1),S=ie(),U=f(),n=ee({form:!1,countries:!1,states:!1,cities:!1}),F=f([]),B=f([]),t=f({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null}),J=()=>{for(const l in t.value)t.value[l]=null},R=async()=>{var m;t.value.id=S.params.id||null;const l=t.value.id?`/student/${t.value.id}/edit`:"/student/create";n.form=!0;const{response:a,data:i}=await g(l).get();if(n.form=!1,(m=a.value)!=null&&m.ok&&i.value&&(C.dataNueva.value=i.value.countries_arrayInfo,C.totalLinks.value=i.value.countries_countLinks,F.value=i.value.typeEducations,B.value=i.value.sections,i.value.form)){t.value=i.value.form;const d=JSON.parse(JSON.stringify(i.value.form));i.value.form.id&&d.country_id&&d.state_id&&(await A(d.country_id),await E(d.state_id),t.value.country_id=d.country_id,t.value.state_id=d.state_id,t.value.city_id=d.city_id)}},Z=async()=>{var a,i;const l=await((a=U.value)==null?void 0:a.validate());if(l!=null&&l.valid){t.value.company_id=G.company.id;const m=t.value.id?`/student/update/${t.value.id}`:"/student/store",d=new FormData;for(const y in t.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(y)||d.append(y,t.value[y]);d.append("country_id",t.value.country_id.value),d.append("state_id",t.value.state_id),d.append("city_id",t.value.city_id),d.append("gender",t.value.gender),d.append("birthday",t.value.birthday),n.form=!0;const{data:v,response:q}=await g(m).post(d);n.form=!1,(i=q.value)!=null&&i.ok&&v.value&&v.value.code==200&&se.push({name:"Student-List"}),v.value.code===422&&(u.value=v.value.errors??{})}else z("Faltan Campos Por Diligenciar","","danger")};S.params.action=="view"&&(k.value=!0),ae(async()=>{J(),await R()});const b=L(()=>Object.values(n).some(l=>l)),_=f(_e()),H=["jpg","jpeg","png"];_.value.allowedExtensions=H;const K=l=>{n.form=!0,_.value.handleImageSelected(l),setTimeout(()=>{t.value.photo=_.value.imageFile,n.form=!1},1e3)},Q=L(()=>t.value.type_education_id?F.value.find(l=>l.value==t.value.type_education_id).grades:[]),D=f([]),N=f([]),T=f([]),j=f(1),C=ce(async l=>{var m;n.countries=!0;const{data:a,response:i}=await g("/selectInfiniteCountries").post(l);n.countries=!1,(m=i.value)!=null&&m.ok&&a.value&&(T.value=a.value.countries_arrayInfo,j.value=a.value.countries_countLinks)},T,j,{}),A=async l=>{var m;t.value.state_id=null,t.value.city_id=null,n.states=!0;const{data:a,response:i}=await g(`/selectStates/${l.value}`).get();n.states=!1,(m=i.value)!=null&&m.ok&&a.value&&(D.value=a.value.states)},E=async l=>{var m;t.value.city_id=null,n.cities=!0;const{data:a,response:i}=await g(`/selectCities/${l}`).get();n.cities=!1,(m=i.value)!=null&&m.ok&&a.value&&(N.value=a.value.cities)},W=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(l,a)=>{const i=ve,m=fe,d=pe,v=me,q=ue,y=de;return w(),te("div",null,[o(ge,{disabled:e(n).form,loading:e(n).form},{default:s(()=>[o(Ve,{class:"d-flex justify-space-between"},{default:s(()=>[qe]),_:1}),o(O,null,{default:s(()=>[o(X,{ref_key:"formValidation",ref:U,onSubmit:le(()=>{},["prevent"]),disabled:e(k)},{default:s(()=>[o(P,null,{default:s(()=>[o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{items:e(F),clearable:"",rules:["requiredValidator"in l?l.requiredValidator:e(c)],modelValue:e(t).type_education_id,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).type_education_id=r),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{clearable:"",items:e(Q),rules:["requiredValidator"in l?l.requiredValidator:e(c)],modelValue:e(t).grade_id,"onUpdate:modelValue":a[1]||(a[1]=r=>e(t).grade_id=r),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{clearable:"",items:e(B),rules:["requiredValidator"in l?l.requiredValidator:e(c)],modelValue:e(t).section_id,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).section_id=r),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),o(p,{cols:"12",md:"4"},{default:s(()=>[V(I(e(t).country_id)+" ",1),o(m,{requiredField:!0,label:"País",returnObject:"",modelValue:e(t).country_id,"onUpdate:modelValue":[a[3]||(a[3]=r=>e(t).country_id=r),a[4]||(a[4]=r=>A(r))],select:e(C),"error-messages":e(u).country_id,onInput:a[5]||(a[5]=r=>e(u).country_id=""),clearable:"",loading:e(n).countries,rules:["requiredValidator"in l?l.requiredValidator:e(c)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),o(p,{cols:"12",md:"4"},{default:s(()=>[V(I(e(t).state_id)+" ",1),o(d,{loading:e(n).states,requiredField:!0,clearable:"",items:e(D),modelValue:e(t).state_id,"onUpdate:modelValue":[a[6]||(a[6]=r=>e(t).state_id=r),a[7]||(a[7]=r=>E(r))],label:"Estado","error-messages":e(u).state_id,onInput:a[8]||(a[8]=r=>e(u).state_id=""),rules:["requiredValidator"in l?l.requiredValidator:e(c)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),o(p,{cols:"12",md:"4"},{default:s(()=>[V(I(e(t).city_id)+" ",1),o(d,{loading:e(n).cities,requiredField:!0,clearable:"",items:e(N),modelValue:e(t).city_id,"onUpdate:modelValue":a[9]||(a[9]=r=>e(t).city_id=r),label:"Municipio","error-messages":e(u).city_id,onInput:a[10]||(a[10]=r=>e(u).city_id=""),rules:["requiredValidator"in l?l.requiredValidator:e(c)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),o(p,{cols:"12",sm:"3"},{default:s(()=>[o(v,{clearable:"",modelValue:e(t).identity_document,"onUpdate:modelValue":a[11]||(a[11]=r=>e(t).identity_document=r),rules:["requiredValidator"in l?l.requiredValidator:e(c)],"error-messages":e(u).identity_document,label:"Cédula de identidad",onInput:a[12]||(a[12]=r=>e(u).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"9"},{default:s(()=>[o(v,{clearable:"",modelValue:e(t).full_name,"onUpdate:modelValue":a[13]||(a[13]=r=>e(t).full_name=r),rules:["requiredValidator"in l?l.requiredValidator:e(c)],"error-messages":e(u).full_name,label:"Nombre completo",onInput:a[14]||(a[14]=r=>e(u).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{clearable:"",modelValue:e(t).gender,"onUpdate:modelValue":a[15]||(a[15]=r=>e(t).gender=r),items:W,rules:["requiredValidator"in l?l.requiredValidator:e(c)],"error-messages":e(u).gender,label:"Sexo",onInput:a[16]||(a[16]=r=>e(u).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(q,{clearable:"",modelValue:e(t).birthday,"onUpdate:modelValue":a[17]||(a[17]=r=>e(t).birthday=r),label:"Fecha de nacimiento",rules:["requiredValidator"in l?l.requiredValidator:e(c)],requiredField:!0,"error-messages":e(u).birthday,onInput:a[18]||(a[18]=r=>e(u).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(q,{clearable:"",modelValue:e(t).real_entry_date,"onUpdate:modelValue":a[19]||(a[19]=r=>e(t).real_entry_date=r),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in l?l.requiredValidator:e(c)],requiredField:!0,"error-messages":e(u).real_entry_date,onInput:a[20]||(a[20]=r=>e(u).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[(w(),M(ye,{accept:"image/*",key:e(_).key,onChange:a[21]||(a[21]=r=>K(r)),"onClick:clear":e(_).clearData},{label:s(()=>[V(" Foto "),ke]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),o(P,null,{default:s(()=>[o(p,{cols:"12",class:"d-flex justify-center"},{default:s(()=>[$("div",Fe,[o(be,{src:e(_).imageUrl??("storageBack"in l?l.storageBack:e(Y))(e(t).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),o(O,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[o(y,{disabled:e(b),loading:e(b)},null,8,["disabled","loading"]),e(k)?oe("",!0):(w(),M(re,{key:0,disabled:e(b),loading:e(b),onClick:a[22]||(a[22]=r=>Z()),color:"primary"},{default:s(()=>[V(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{ua as default};
