import{V as L,r as T}from"./VForm-c18e5bae.js";import{d as U,r as V,aF as A,o as f,c as N,b as s,f as r,k as o,g,E as c,e as w,B as v,C as P,ad as M,a6 as C,ae as y,af as S}from"./index-70f4e7a4.js";import{_ as z}from"./AppTextField.vue_vue_type_script_setup_true_lang-7527c8a1.js";import{_ as E}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-0e6abfbf.js";import{V as I,a as R}from"./VToolbar-5e49f54b.js";import{V as j}from"./VCard-67e1580c.js";import{V as k}from"./VCardText-f2be9b0f.js";import{V as K}from"./VRow-b73ff23b.js";import{V as b}from"./VCol-839017b6.js";import{V as Z}from"./VDialog-7e1671f7.js";const oe=U({__name:"ModalChangePassword",emits:["execute"],setup(G,{expose:D,emit:x}){const n=V({}),B=x,a=A({titleDialog:"Cambiar contraseña",isDialogVisible:!1,isLoading:!1,first_time:!1,module:"Student",statuses:[],form:{id:null,new_password:""}}),q=()=>{a.form={id:null,new_password:""},n.value={},t.value=!1},d=()=>{a.isDialogVisible=!a.isDialogVisible},F=async(i,e=!1)=>{q(),d(),a.form.id=i,a.first_time=e},$=async()=>{var e,m,u;const i=await((e=_.value)==null?void 0:e.validate());if(i!=null&&i.valid){a.isLoading=!0;const{response:l,data:p}=await S("changePassword").post({id:a.form.id,new_password:a.form.new_password,module:a.module});a.isLoading=!1,(m=l.value)!=null&&m.ok&&((u=p.value)==null?void 0:u.code)==200&&(d(),B("execute",!0)),p.value.code==422&&(n.value=p.value.errors??{})}},_=V();D({openDialog:F,componentData:a});const t=V(!1);return(i,e)=>{const m=E,u=z;return f(),N("div",null,[s(Z,{modelValue:o(a).isDialogVisible,"onUpdate:modelValue":e[6]||(e[6]=l=>o(a).isDialogVisible=l),persistent:"","max-width":"40rem",transition:"dialog-transition"},{default:r(()=>[o(a).first_time?c("",!0):(f(),g(m,{key:0,onClick:e[0]||(e[0]=l=>d())})),w("div",null,[s(I,{color:"primary"},{default:r(()=>[s(R,null,{default:r(()=>[v(P(o(a).titleDialog),1)]),_:1})]),_:1})]),s(j,null,{default:r(()=>[s(k,null,{default:r(()=>[s(L,{ref_key:"refForm",ref:_,onSubmit:M(()=>{},["prevent"])},{default:r(()=>[s(K,null,{default:r(()=>[o(a).first_time?(f(),g(b,{key:0,cols:"12"},{default:r(()=>e[7]||(e[7]=[w("h4",null,"¡Bienvenido! Como es tu primera vez ingresando al sistema, es necesario que cambies tu contraseña. Por favor, elige una nueva contraseña que sea segura y fácil de recordar.",-1)])),_:1})):c("",!0),s(b,{cols:"12"},{default:r(()=>[s(u,{clearable:"",modelValue:o(a).form.new_password,"onUpdate:modelValue":e[1]||(e[1]=l=>o(a).form.new_password=l),label:"Contraseña",placeholder:"············",type:o(t)?"text":"password","append-inner-icon":o(t)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=l=>t.value=!o(t)),rules:["requiredValidator"in i?i.requiredValidator:o(T)],"error-messages":o(n).new_password,onKeypress:e[3]||(e[3]=l=>o(n).new_password="")},null,8,["modelValue","type","append-inner-icon","rules","error-messages"])]),_:1}),s(b,{cols:"12"},{default:r(()=>e[8]||(e[8]=[w("span",null," Requisitos de la Contraseña: Mínimo de 8 caracteres. Debe incluir al menos: Una letra mayúscula (A-Z) Una letra minúscula (a-z) Un número (0-9) Asegúrate de que la nueva contraseña no sea igual a la contraseña actual. ",-1)])),_:1})]),_:1})]),_:1},512)]),_:1}),s(k,{class:"d-flex justify-end gap-3 flex-wrap"},{default:r(()=>[o(a).first_time?c("",!0):(f(),g(y,{key:0,loading:o(a).isLoading,color:"secondary",variant:"tonal",onClick:e[4]||(e[4]=l=>d())},{default:r(()=>[s(C,{start:"",icon:"tabler-x"}),e[9]||(e[9]=v(" Cancelar "))]),_:1},8,["loading"])),s(y,{disabled:o(a).isLoading,loading:o(a).isLoading,onClick:e[5]||(e[5]=l=>$()),color:"primary"},{default:r(()=>[s(C,{start:"",icon:"tabler-device-floppy"}),e[10]||(e[10]=v(" Cambiar contraseña "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{oe as _};
