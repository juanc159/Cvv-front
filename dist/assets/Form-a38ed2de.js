import{V as B,r as g,e as U}from"./VForm-09f36129.js";import{_}from"./AppTextField.vue_vue_type_script_setup_true_lang-668364af.js";import{d as S,p as N,r as d,R as T,Q as A,L as I,o as y,c as K,b as o,f as l,k as e,B as F,g as R,ag as D,e as P,aB as z,aC as E}from"./index-a73ef7a4.js";import{u as L}from"./useImageUpload-1a3a20dc.js";import{u as j}from"./useCrudUserStore-dcf132ad.js";import{V as x}from"./VCardText-f167dd9c.js";import{V as v}from"./VRow-be98792f.js";import{V as m}from"./VCol-38ed283b.js";import{V as G}from"./VField-c03f9512.js";import{V as H}from"./VFileInput-2f0c9cb7.js";import{V as M}from"./VImg-92b32f5d.js";import{V as Q}from"./VCard-3c846ebb.js";import"./helpers-3edea678.js";import"./VTextField-cd57f2d2.js";import"./sweetalert2.all-e795d634.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VChip-eb33449f.js";import"./VAvatar-c8033367.js";const J=P("b",{class:"text-warning"},"*",-1),Ve=S({__name:"Form",setup(O){const b=N(),{toast:C}=E(),c=d();T();const p=j(),{form:i,loading:k}=A(p),n=d({}),u=d(L()),f=d(!1),w=d([]),q=r=>{u.value.handleImageSelected(r)},$=async()=>{var a,V;const r=await((a=c.value)==null?void 0:a.validate());if(r!=null&&r.valid){u.value.imageFile&&(i.value.photo=u.value.imageFile);const t=await p.fetchSave();(t==null?void 0:t.code)===200&&(w.value=[],n.value={},u.value.clearData(),await((V=c.value)==null?void 0:V.resetValidation())),(t==null?void 0:t.code)===422&&(n.value=t.errors??{})}else C("Faltan Campos Por Diligenciar","","danger")};return I(async()=>{p.clearForm(),await p.fetchDataForm(Number(b.params.id),b.params.action)}),(r,a)=>{const V=z,t=_;return y(),K("div",null,[o(Q,null,{default:l(()=>[o(x,null,{default:l(()=>[o(v,null,{default:l(()=>[o(m,null,{default:l(()=>[o(V,{"sub-title":"form de usuario",action:String(r.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:r.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),o(e(B),{ref_key:"formValidation",ref:c,"lazy-validation":""},{default:l(()=>[o(v,null,{default:l(()=>[o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).email,"onUpdate:modelValue":a[0]||(a[0]=s=>e(i).email=s),rules:["requiredValidator"in r?r.requiredValidator:e(g),"emailValidator"in r?r.emailValidator:e(U)],autocomplete:"off","error-messages":e(n).email,label:"Email",onKeypress:a[1]||(a[1]=s=>e(n).email=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).password,"onUpdate:modelValue":a[2]||(a[2]=s=>e(i).password=s),rules:e(w).password,autocomplete:"off",type:e(f)?"text":"password","append-icon":e(f)?"mdi-eye":"mdi-eye-off","error-messages":e(n).password,label:"Contraseña","onClick:append":a[3]||(a[3]=s=>f.value=!e(f)),onKeypress:a[4]||(a[4]=s=>e(n).password=""),requiredField:!0},null,8,["modelValue","rules","type","append-icon","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).name,"onUpdate:modelValue":a[5]||(a[5]=s=>e(i).name=s),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(n).name,label:"Nombre",onKeypress:a[6]||(a[6]=s=>e(n).name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).last_name,"onUpdate:modelValue":a[7]||(a[7]=s=>e(i).last_name=s),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(n).last_name,label:"Apellido",onKeypress:a[8]||(a[8]=s=>e(n).last_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(G,null,{default:l(()=>[F("Foto  "),J]),_:1}),(y(),R(H,{key:e(u).key,"show-size":"",counter:"",accept:"image/*",onChange:a[9]||(a[9]=s=>q(s))}))]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(M,{contain:"",src:e(u).imageUrl??e(i).photo,alt:"foto Personal","max-width":200,class:"mx-auto img-fluid"},null,8,["src"])]),_:1})]),_:1}),o(v,null,{default:l(()=>[o(m,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[o(D,{loading:e(k).form,color:"primary",onClick:a[10]||(a[10]=s=>$())},{default:l(()=>[F(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{Ve as default};
