import{r as V}from"./validators-DQNwaKQj.js";import{s as re}from"./helpers-BPprKBaR.js";import{d as x,r as c,N as h,w as ee,h as L,o as B,c6 as ne,f as s,q as ue,l as e,e as N,b as t,c as P,y as D,aG as de,a9 as E,a7 as H,B as me,I as ce,n as fe,k as pe,V as ve,t as ye,b5 as Ve,Y as K,ac as ge,D as A,E as _e,cs as be,b7 as W,aY as ke,aS as qe,aT as j}from"./index-CtOr4Wu7.js";import{_ as Fe}from"./BtnBack.vue_vue_type_script_setup_true_lang-LvM9IGc6.js";import{_ as Ie}from"./AppTextField.vue_vue_type_script_setup_true_lang-tPb9GRlz.js";import{_ as we}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-Bw7Anc8o.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-K6gbidqT.js";import{V as $e}from"./VTextField-B5WBRC1t.js";import{V as X}from"./VDivider-Du-RozYy.js";import{V as Q,a as f}from"./VRow-C1C7EzPn.js";import{u as Ce,V as Se}from"./VFileInput-kuWJjQCq.js";import{a as Ue,V as Be}from"./VCard-COZucsTL.js";import{V as Z}from"./VCardText-v8gCKQRH.js";import{V as Ne}from"./VForm-BhvUgRDX.js";import{V as Te}from"./VCheckbox-DFBZTOdR.js";import{V as ze}from"./VImg-Ctxsnw81.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-B9CXAvdJ.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-6vZWU1pl.js";import"./VDialog-CybUf8DC.js";import"./dialog-transition-dwJwLnHT.js";import"./VSelect-BZZhkYMh.js";import"./VList-BoAmY9IJ.js";import"./ssrBoot-CB8iZIPO.js";import"./VAvatar-e7AxYF9T.js";import"./VMenu-D4hRRJEr.js";import"./VCheckboxBtn-Cah7cXyy.js";import"./VSelectionControl-Uad4iysT.js";import"./VChip-X8cnhpwt.js";import"./filter-RDRewW1g.js";/* empty css                   */import"./VCounter-DANGpuYg.js";/* empty css              */import"./sweetalert2.esm.all-DV3w3JmD.js";const Ae={key:0,class:"text-center"},je={key:1,class:"d-flex justify-content-between aling-items-center p-2"},Le=x({__name:"SelectInfinite",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},select:{type:Object,default:()=>({})},multiple:{type:Boolean,default:()=>!1}},emits:["clearVmodel"],setup(p,{emit:I}){const{items:S,loading:d,select:v}=p,g=I,m=c(!1);h(()=>{v.totalLinks.value>1&&(m.value=!0)});const n=()=>{g("clearVmodel",!0),v.next()},_=()=>{g("clearVmodel",!0),v.prev()};return ee(v.dataNueva,()=>{m.value==!1&&v.totalLinks.value>1&&(m.value=!0)}),(w,b)=>{const l=ae;return B(),L(l,me(w.$attrs,{items:p.select.dataNueva.value,multiple:p.multiple}),ne({_:2},[e(m)?{name:"prepend-item",fn:s(()=>[N("div",null,[t($e,{clearable:"",placeholder:"Buscar...	",class:"mb-2",modelValue:p.select.searchQueryInfinite.value,"onUpdate:modelValue":b[0]||(b[0]=k=>p.select.searchQueryInfinite.value=k)},null,8,["modelValue"]),t(X)])]),key:"0"}:void 0,e(m)?{name:"append-item",fn:s(()=>[N("div",null,[t(X),p.loading?(B(),P("div",Ae,[t(de,{size:"24",color:"primary",indeterminate:""})])):D("",!0),p.loading?D("",!0):(B(),P("div",je,[t(Q,null,{default:s(()=>[t(f,{sm:"6",class:"text-left"},{default:s(()=>[t(E,{class:"mt-2 ml-5",disabled:p.select.page.value<=1,onClick:b[1]||(b[1]=k=>_()),color:"primary",icon:""},{default:s(()=>[t(H,{icon:"tabler-chevron-left"})]),_:1},8,["disabled"])]),_:1}),t(f,{sm:"6",class:"text-right"},{default:s(()=>[t(E,{class:"mt-2 mr-5",disabled:p.select.page.value>=p.select.totalLinks.value,onClick:b[2]||(b[2]=k=>n()),color:"primary",icon:""},{default:s(()=>[t(H,{icon:"tabler-chevron-right"})]),_:1},8,["disabled"])]),_:1})]),_:1})]))])]),key:"1"}:void 0,ue(w.$slots,(k,q)=>({name:q,fn:s(F=>[ce(w.$slots,q,fe(pe(F||{})))])}))]),1040,["items","multiple"])}}});function Pe(p,I=[],S=0,d={}){const v=c(""),g=c([]),m=c(1),n=c(1),_=c({}),w=async()=>{m.value--,m.value<=1&&(m.value=1),await l()},b=async()=>{m.value++,m.value>n.value&&(m.value=n.value),await l()},l=async()=>{let q={page:m.value,searchQueryInfinite:v.value};for(const F in d)q[F]=d[F];for(const F in _.value)q[F]=_[F];await p(q),g.value=[],g.value.push(...I.value)};let k=null;return ee(v,async(q,F)=>{k&&clearTimeout(k),m.value=1;let $={page:m.value,searchQueryInfinite:q};for(const y in d)$[y]=d[y];for(const y in _.value)$[y]=_[y];k=setTimeout(async()=>{await p($),g.value=[],I&&I.value!==void 0&&g.value.push(...I.value),S&&S.value!==void 0&&(n.value=S.value)},300)}),{searchQueryInfinite:v,dataNueva:g,page:m,filterInterno:_,next:b,prev:w,search:l,totalLinks:n}}const De=N("span",null," Formulario estudiante ",-1),Ee=N("b",{class:"text-warning"},"*",-1),Qe={style:{"block-size":"200px","inline-size":"200px"}},qa=x({__name:"Form",setup(p){const I=ve(),{toast:S}=qe(),d=c({}),v=c(!1),g=ye(),m=c(),n=Ve({form:!1,countries:!1,states:!1,cities:!1}),_=c([]),w=c([]),b=c([]),l=c({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null,nationalized:null}),k=()=>{for(const i in l.value)l.value[i]=null},q=async()=>{l.value.id=g.params.id||null;const i=l.value.id?`/student/${l.value.id}/edit`:"/student/create";n.form=!0;const{response:a,data:u}=await W(i).get({params:{company_id:I.company.id}});if(n.form=!1,a.status==200&&u&&(z.dataNueva.value=u.countries_arrayInfo,z.totalLinks.value=u.countries_countLinks,_.value=u.typeEducations,w.value=u.sections,b.value=u.typeDocuments,u.form)){l.value=u.form;const r=JSON.parse(JSON.stringify(u.form));u.form.id&&r.country_id&&r.state_id&&(await J(r.country_id),await Y(r.state_id),l.value.country_id=r.country_id,l.value.state_id=r.state_id,l.value.city_id=r.city_id)}},F=async()=>{var a;const i=await((a=m.value)==null?void 0:a.validate());if(i!=null&&i.valid){l.value.company_id=I.company.id;const u=l.value.id?`/student/update/${l.value.id}`:"/student/store",r=new FormData;for(const U in l.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(U)||r.append(U,l.value[U]);r.append("country_id",l.value.country_id.value),r.append("state_id",l.value.state_id),r.append("city_id",l.value.city_id),r.append("gender",l.value.gender),r.append("birthday",l.value.birthday),n.form=!0;const{data:C,response:T}=await W(u).post(r);n.form=!1,T.status==200&&C&&C.code==200&&ke.push({name:"Student-List"}),C.code===422&&(d.value=C.errors??{})}else S("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(v.value=!0),h(async()=>{k(),await q()});const $=K(()=>Object.values(n).some(i=>i)),y=c(Ce()),le=["jpg","jpeg","png"];y.value.allowedExtensions=le;const te=i=>{n.form=!0,y.value.handleImageSelected(i),setTimeout(()=>{l.value.photo=y.value.imageFile,n.form=!1},1e3)},ie=K(()=>l.value.type_education_id?_.value.find(i=>i.value==l.value.type_education_id).grades:[]),M=c([]),O=c([]),G=c([]),R=c(1),z=Pe(async i=>{var r;n.countries=!0;const{data:a,response:u}=await j("/selectInfiniteCountries").post(i);n.countries=!1,(r=u.value)!=null&&r.ok&&a.value&&(G.value=a.value.countries_arrayInfo,R.value=a.value.countries_countLinks)},G,R,{}),J=async i=>{var r;l.value.state_id=null,l.value.city_id=null,n.states=!0;const{data:a,response:u}=await j(`/selectStates/${i.value}`).get();n.states=!1,(r=u.value)!=null&&r.ok&&a.value&&(M.value=a.value.states)},Y=async i=>{var r;l.value.city_id=null,n.cities=!0;const{data:a,response:u}=await j(`/selectCities/${i}`).get();n.cities=!1,(r=u.value)!=null&&r.ok&&a.value&&(O.value=a.value.cities)},oe=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(i,a)=>{const u=ae,r=Le,C=we,T=Ie,U=be,se=Fe;return B(),P("div",null,[t(Be,{disabled:e(n).form,loading:e(n).form},{default:s(()=>[t(Ue,{class:"d-flex justify-space-between"},{default:s(()=>[De]),_:1}),t(Z,null,{default:s(()=>[t(Ne,{ref_key:"formValidation",ref:m,onSubmit:ge(()=>{},["prevent"]),disabled:e(v)},{default:s(()=>[t(Q,null,{default:s(()=>[t(f,{cols:"12",sm:"4"},{default:s(()=>[t(u,{items:e(_),clearable:"",requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).type_education_id,"onUpdate:modelValue":a[0]||(a[0]=o=>e(l).type_education_id=o),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",sm:"4"},{default:s(()=>[t(u,{clearable:"",items:e(ie),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).grade_id,"onUpdate:modelValue":a[1]||(a[1]=o=>e(l).grade_id=o),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",sm:"4"},{default:s(()=>[t(u,{clearable:"",items:e(w),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).section_id,"onUpdate:modelValue":a[2]||(a[2]=o=>e(l).section_id=o),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",md:"3"},{default:s(()=>[t(r,{requiredField:!0,label:"País",returnObject:"",modelValue:e(l).country_id,"onUpdate:modelValue":[a[3]||(a[3]=o=>e(l).country_id=o),a[4]||(a[4]=o=>J(o))],select:e(z),"error-messages":e(d).country_id,onInput:a[5]||(a[5]=o=>e(d).country_id=""),clearable:"",loading:e(n).countries,rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),t(f,{cols:"12",md:"3"},{default:s(()=>[t(C,{loading:e(n).states,requiredField:!0,clearable:"",items:e(M),modelValue:e(l).state_id,"onUpdate:modelValue":[a[6]||(a[6]=o=>e(l).state_id=o),a[7]||(a[7]=o=>Y(o))],label:"Estado","error-messages":e(d).state_id,onInput:a[8]||(a[8]=o=>e(d).state_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),t(f,{cols:"12",md:"4"},{default:s(()=>[t(C,{loading:e(n).cities,requiredField:!0,clearable:"",items:e(O),modelValue:e(l).city_id,"onUpdate:modelValue":a[9]||(a[9]=o=>e(l).city_id=o),label:"Municipio","error-messages":e(d).city_id,onInput:a[10]||(a[10]=o=>e(d).city_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[t(Te,{modelValue:e(l).nationalized,"onUpdate:modelValue":a[11]||(a[11]=o=>e(l).nationalized=o),label:"Nacionalizado","true-value":!0,"false-value":!1},{label:s(()=>[A(" Nacionalizado: "+_e(e(l).nationalized?"Sí":"No"),1)]),_:1},8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:s(()=>[t(u,{clearable:"",items:e(b),rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(l).type_document_id,"onUpdate:modelValue":a[12]||(a[12]=o=>e(l).type_document_id=o),label:"Tipo de documento"},null,8,["items","rules","modelValue"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:s(()=>[t(T,{clearable:"",modelValue:e(l).identity_document,"onUpdate:modelValue":a[13]||(a[13]=o=>e(l).identity_document=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).identity_document,label:"Documento",onInput:a[14]||(a[14]=o=>e(d).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(T,{clearable:"",modelValue:e(l).full_name,"onUpdate:modelValue":a[15]||(a[15]=o=>e(l).full_name=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).full_name,label:"Nombre completo",onInput:a[16]||(a[16]=o=>e(d).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:s(()=>[t(u,{clearable:"",modelValue:e(l).gender,"onUpdate:modelValue":a[17]||(a[17]=o=>e(l).gender=o),items:oe,rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).gender,label:"Sexo",onInput:a[18]||(a[18]=o=>e(d).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:s(()=>[t(U,{clearable:"",modelValue:e(l).birthday,"onUpdate:modelValue":a[19]||(a[19]=o=>e(l).birthday=o),label:"Fecha de nacimiento",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).birthday,onInput:a[20]||(a[20]=o=>e(d).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:s(()=>[t(U,{clearable:"",modelValue:e(l).real_entry_date,"onUpdate:modelValue":a[21]||(a[21]=o=>e(l).real_entry_date=o),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).real_entry_date,onInput:a[22]||(a[22]=o=>e(d).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12",sm:"3"},{default:s(()=>[(B(),L(Se,{accept:"image/*",key:e(y).key,onChange:a[23]||(a[23]=o=>te(o)),"onClick:clear":e(y).clearData},{label:s(()=>[A(" Foto "),Ee]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),t(Q,null,{default:s(()=>[t(f,{cols:"12",class:"d-flex justify-center"},{default:s(()=>[N("div",Qe,[t(ze,{src:e(y).imageUrl??("storageBack"in i?i.storageBack:e(re))(e(l).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),t(Z,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[t(se,{disabled:e($),loading:e($)},null,8,["disabled","loading"]),e(v)?D("",!0):(B(),L(E,{key:0,disabled:e($),loading:e($),onClick:a[24]||(a[24]=o=>F()),color:"primary"},{default:s(()=>[A(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{qa as default};
