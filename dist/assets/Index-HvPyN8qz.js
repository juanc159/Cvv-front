import{V as B,r as g}from"./VForm-CGHgcW13.js";import{_ as j}from"./AppSelect.vue_vue_type_script_setup_true_lang-ZJ_iVhiP.js";import{d as z,U as L,ax as M,r as d,M as R,af as v,Z as h,o as S,c as Z,b as a,f as l,C as u,k as e,g as G,ad as N,e as U,ae as H,ay as J}from"./index-D-Okau8E.js";import{u as K,V as O}from"./VFileInput-SXNR_Xid.js";import{c as Q}from"./createUrl-CJMc8IhA.js";import{a as W}from"./helpers-DMPihPy4.js";import{b,V as C}from"./VCard-DUbS-F6F.js";import{V as k}from"./VCardText-CMo7zIzY.js";import{V as p,a as m}from"./VRow-ChDAPd3n.js";import{V as X}from"./VInput-C00OEwkJ.js";import{V as Y}from"./VSwitch-ziMPJ9CF.js";import"./forwardRefs-C-GTDzx5.js";import"./VTooltip-CELZQyB8.js";import"./VOverlay-B7_pYCaR.js";import"./VImg-JyJzWtyr.js";import"./VSelect-wr5mIxRL.js";import"./VTextField-D4gJ-WQb.js";import"./VList-B_Qt1gw7.js";import"./ssrBoot-BconoBJ9.js";import"./VAvatar-rB1dohGQ.js";import"./VDivider-DTdlpGO9.js";import"./dialog-transition-BUd9b0jQ.js";import"./VMenu-B0E4mAKA.js";import"./VCheckboxBtn-DISsFFzl.js";import"./VSelectionControl-cXEC_Tfc.js";import"./VChip-CHHALdfQ.js";import"./sweetalert2.esm.all-DOYwHpwi.js";import"./index-0F-JFElI.js";import"./constants-2GBt7OCP.js";/* empty css              */const ee=U("b",{class:"text-warning"},"*",-1),ae={class:"demo-space-x"},Ae=z({__name:"Index",setup(oe){const w=L(),{toast:x}=J(),i=M({form:!1,excel:!1}),n=d({company_id:null,type_education_id:null,archive:null}),_=d({}),q=d(),D=d(),y=d([]),c=d(K());c.value.allowedExtensions=["xls","xlsx"];const f=d(!1);R(async()=>{var s;i.form=!0;const{data:r,response:o}=await v("note-dataForm").get();i.form=!1,(s=o.value)!=null&&s.ok&&r.value&&(y.value=r.value.typeEducations,f.value=r.value.blockData)});const T=async()=>{var o;n.value.archive=c.value.imageFile,n.value.company_id=w.company.id;const r=await((o=q.value)==null?void 0:o.validate());if(r!=null&&r.valid){const s=new FormData;for(const t in n.value)s.append(t,n.value[t]);i.form=!0,await v("note-store").post(s),i.form=!1}else x("Faltan Campos Por Diligenciar","","danger")},V=d({type_education_id:null}),A=async()=>{var o,s;const r=await((o=D.value)==null?void 0:o.validate());if(r!=null&&r.valid){i.excel=!0;const t=y.value.find(P=>P.value==V.value.type_education_id),{data:F,response:I}=await v(Q("/note-downloadAllConsolidated",{query:{type_education_id:V.value.type_education_id,company_id:w.company.id}}));i.excel=!1,(s=I.value)!=null&&s.ok&&F.value&&W(F.value.excel,"Consolidado "+(t==null?void 0:t.title))}else x("Faltan Campos Por Diligenciar","","danger")},E=async r=>{var t;const{data:o,response:s}=await v("/note-blockPayrollUpload").post({value:r});(t=s.value)!=null&&t.ok&&o.value},$=h(()=>f.value?"Sí":"No");return(r,o)=>{const s=j;return S(),Z("div",null,[a(C,{disabled:e(i).form,loading:e(i).form},{default:l(()=>[a(b,{"primary-title":""},{default:l(()=>[u("Cargar Notas")]),_:1}),a(k,null,{default:l(()=>[a(e(B),{ref_key:"formValidation",ref:q,"lazy-validation":""},{default:l(()=>[a(p,null,{default:l(()=>[a(m,{cols:"12",sm:"4"},{default:l(()=>[a(s,{clearable:"",modelValue:e(n).type_education_id,"onUpdate:modelValue":o[0]||(o[0]=t=>e(n).type_education_id=t),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(_).type_education_id,label:"Tipo",onChange:o[1]||(o[1]=t=>e(_).type_education_id=""),requiredField:!0,items:e(y)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),a(m,{cols:"12",sm:"4"},{default:l(()=>[a(X,null,{default:l(()=>[u("Archivo "),ee]),_:1}),(S(),G(O,{key:e(c).key,onChange:e(c).handleImageSelected,"onClick:clear":e(c).clearData,rules:["requiredValidator"in r?r.requiredValidator:e(g)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),a(p,null,{default:l(()=>[a(m,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[a(N,{loading:e(i).form,disabled:e(i).form,color:"primary",onClick:o[2]||(o[2]=t=>T())},{default:l(()=>[u(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),a(C,{disabled:e(i).form,loading:e(i).form,class:"mt-3"},{default:l(()=>[a(b,{"primary-title":""},{default:l(()=>[u("Descargar Notas")]),_:1}),a(k,null,{default:l(()=>[a(e(B),{ref_key:"formValidationDownload",ref:D,"lazy-validation":""},{default:l(()=>[a(p,null,{default:l(()=>[a(m,{cols:"12",sm:"4"},{default:l(()=>[a(s,{clearable:"",modelValue:e(V).type_education_id,"onUpdate:modelValue":o[3]||(o[3]=t=>e(V).type_education_id=t),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(_).type_education_id,label:"Tipo",onChange:o[4]||(o[4]=t=>e(_).type_education_id=""),requiredField:!0,items:e(y)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),a(p,null,{default:l(()=>[a(m,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[a(N,{loading:e(i).excel,disabled:e(i).excel,color:"primary",onClick:o[5]||(o[5]=t=>A())},{default:l(()=>[u(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),a(C,{disabled:e(i).form,loading:e(i).form,class:"mt-3"},{default:l(()=>[a(b,{"primary-title":""},{default:l(()=>[u("Bloquear carga de notas a los profesores")]),_:1}),a(k,null,{default:l(()=>[a(p,null,{default:l(()=>[a(m,{cols:"12",sm:"4"},{default:l(()=>[U("div",ae,[a(Y,{modelValue:e(f),"onUpdate:modelValue":[o[6]||(o[6]=t=>H(f)?f.value=t:null),o[7]||(o[7]=t=>E(t))],label:e($),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Ae as default};
