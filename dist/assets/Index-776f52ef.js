import{a as L}from"./formatters-1588bd0d.js";import{_ as P,a as R}from"./TableFullNew.vue_vue_type_script_setup_true_lang-b63af8c8.js";import{u as j}from"./useCrudTeacherStore-8fdbe7ca.js";import{d as G,R as O,r as k,aF as q,o as c,c as f,b as t,f as n,e as C,ae as r,k as v,B as x,D as H,g as V,C as _,F as T,m as J,a6 as p,ac as m,af as F,q as K,E as M}from"./index-51cb69df.js";import{S as Q}from"./sweetalert2.esm.all-562d67d8.js";import{a as N}from"./helpers-53221d8d.js";import{b as U,V as W}from"./VCard-301024e1.js";import{V as X}from"./VCardText-273f35dc.js";import{V as Y}from"./VAvatar-791a724a.js";import{V as Z}from"./VImg-81a5222f.js";import{V as ee,a as te,b as ae}from"./VList-ab702103.js";import{V as oe}from"./VChip-b71df4c0.js";import{V as ne}from"./VDivider-558f6a01.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-e709e21d.js";import"./VDialog-606b9d78.js";import"./dialog-transition-a84ac78c.js";import"./VField-05ac4c62.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-c56bd7ad.js";import"./VSelect-2e5b5921.js";import"./VTextField-47862ef2.js";import"./VMenu-cc4ca673.js";import"./VRow-2b03ebeb.js";/* empty css              */import"./VCol-fdd6fac1.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-eeaad7ad.js";import"./_commonjsHelpers-725317a4.js";import"./index-9c720871.js";import"./VContainer-cefd8640.js";import"./VPagination-2c8884a3.js";import"./VDataTable-cc8d03ea.js";import"./ssrBoot-92823662.js";const ie={class:"app-teacher-search-filter d-flex align-center flex-wrap gap-4"},le={key:1},Re=G({__name:"Index",setup(re){const g=j(),D=O(),y=K(),u=async(o="create",e)=>{if(o=="order")return y.push({name:"Teacher-Order"}),!1;if(o=="planning")return y.push({name:"Teacher-Planning",params:{id:e}}),!1;y.push({name:"Teacher-Form",params:{action:o,id:e}})},S=async(o,e)=>{const i=!o[e];(await g.changeState({id:o.id,value:i,field:e})).code==200&&(o.state=i)},B=async o=>{Q.fire({title:"¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async e=>{e.isConfirmed?(await g.fetchDelete(o),await w(b.value)):e.isDenied})},h=k(),z={url:"/teacher-list",headers:[{title:"Acciones",key:"actions"},{title:"Estado",key:"state"},{title:"Foto",key:"photo"},{title:"Tipo de educación",key:"type_education_name"},{title:"Cargo",key:"job_position_name"},{title:"Nombre(s)",key:"name"},{title:"Apellido(s)",key:"last_name"},{title:"Correo",key:"email"},{title:"Telefono",key:"phone"}],params:{company_id:D.company.id}},b=k({}),w=(o={})=>{b.value=o,h.value.changeFilter(o)},E=k({inputGeneral:{relationsGeneral:{all:["name","last_name","email","phone"],typeEducation:["name"],jobPosition:["name"]}},dialog:{width:500,inputs:[{input_type:"booleanActive",title:"Estado",key:"state"}]}}),s=q({excel:!1}),$=async o=>{var d;s.excel=!0;const{data:e,response:i}=await F("/teacher-downloadConsolidated/"+o.id).get();if(s.excel=!1,(d=i.value)!=null&&d.ok&&e.value){const a="Nómina "+o.name+" "+o.last_name;N(e.value.excel,a)}},A=async()=>{var i;s.excel=!0;const{data:o,response:e}=await F("/teacher-downloadAllConsolidated").get();s.excel=!1,(i=e.value)!=null&&i.ok&&o.value&&N(o.value.excel,"Consolidado")};return(o,e)=>{const i=P,d=R;return c(),f("div",null,[t(W,null,{default:n(()=>[t(U,{class:"d-flex justify-space-between"},{default:n(()=>[e[6]||(e[6]=C("div",null," Listado de docentes ",-1)),C("div",ie,[t(r,{color:"primary",loading:v(s).excel,disabled:v(s).excel,onClick:e[0]||(e[0]=a=>A())},{default:n(()=>e[3]||(e[3]=[x(" descargar nomina general ")])),_:1},8,["loading","disabled"]),t(r,{color:"primary",onClick:e[1]||(e[1]=a=>u("order"))},{default:n(()=>e[4]||(e[4]=[x(" Ordenar Docentes ")])),_:1}),t(r,{color:"primary",onClick:e[2]||(e[2]=a=>u())},{default:n(()=>e[5]||(e[5]=[x(" Crear Docente ")])),_:1})])]),_:1}),t(X,null,{default:n(()=>[t(i,{ref:"filterDialogNewRef",optionsFilter:v(E),onSendFilter:w},null,8,["optionsFilter"])]),_:1}),t(d,{ref_key:"tableFullNew",ref:h,optionsTable:z},{"item.photo":n(({item:a})=>[t(Y,{color:a.photo?"":"primary",class:H(a.photo?null:"v-avatar-light-bg primary--text"),variant:a.photo?void 0:"tonal"},{default:n(()=>[a.photo?(c(),V(Z,{key:0,src:a.photo},null,8,["src"])):(c(),f("span",le,_(("avatarText"in o?o.avatarText:v(L))(a.name+" "+a.last_name)),1))]),_:2},1032,["color","class","variant"])]),"item.subjects":n(({item:a})=>[t(ee,{border:""},{default:n(()=>[(c(!0),f(T,null,J(a.subjects,(l,I)=>(c(),f(T,{key:l.name},[t(te,null,{default:n(()=>[t(ae,null,{default:n(()=>[x(_(l),1)]),_:2},1024)]),_:2},1024),I!==a.subjects.length-1?(c(),V(ne,{key:0})):M("",!0)],64))),128))]),_:2},1024)]),"item.state":n(({item:a})=>[t(oe,{color:a.state==1?"success":"error",onClick:l=>S(a,"state")},{default:n(()=>[t(p,{start:"",size:"16",icon:a.state==1?"tabler-bell":"tabler-alert-circle"},null,8,["icon"]),C("span",null,_(a.state==1?"Activo":"Inactivo"),1),t(m,{location:"top",transition:"scale-transition",activator:"parent",text:"Cambiar Estado"})]),_:2},1032,["color","onClick"])]),"item.actions":n(({item:a})=>[t(r,{icon:"",size:"x-small",color:"error",variant:"text",onClick:l=>B(a.id)},{default:n(()=>[t(p,{size:"22",icon:"tabler-trash"}),t(m,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]),t(r,{icon:"",size:"x-small",color:"default",variant:"text",onClick:l=>u("edit",a.id)},{default:n(()=>[t(p,{size:"22",icon:"tabler-edit"}),t(m,{location:"top",transition:"scale-transition",activator:"parent",text:"Editar"})]),_:2},1032,["onClick"]),t(r,{icon:"",size:"x-small",color:"default",variant:"text",onClick:l=>u("planning",a.id)},{default:n(()=>[t(p,{size:"22",icon:"tabler-file"}),t(m,{location:"top",transition:"scale-transition",activator:"parent",text:"Planificación"})]),_:2},1032,["onClick"]),t(r,{icon:"",size:"x-small",variant:"text",onClick:l=>$(a)},{default:n(()=>[t(p,{size:"22",icon:"tabler-file-download"}),t(m,{location:"top",transition:"scale-transition",activator:"parent",text:"Descargar Nómina"})]),_:2},1032,["onClick"])]),_:1},512)]),_:1})])}}});export{Re as default};
