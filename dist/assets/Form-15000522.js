import{r as y,V as x}from"./VForm-70a51769.js";import{_ as z}from"./AppTextField.vue_vue_type_script_setup_true_lang-ea26936e.js";import{d as j,r as d,R as K,Q as N,L as P,ab as h,a as U,o as c,c as k,b as e,f as o,k as t,B as _,E as L,g as C,F as O,m as Y,ae as H,p as G,ay as M,az as Q,aA as J,cd as W,C as X}from"./index-551c6ec5.js";import{u as F}from"./useImageUpload-6d0014af.js";import{u as Z}from"./useCrudServiceStore-600e779c.js";import{V as ee}from"./VCardText-1b43aec1.js";import{V as g}from"./VRow-51805640.js";import{V as m}from"./VCol-12daf29e.js";import{V as ae}from"./VField-b9d726d8.js";import{V as te}from"./VFileInput-0ac12804.js";import{V as oe}from"./VImg-5e8a126f.js";import{V as re}from"./VCard-d87e2dd9.js";import"./helpers-53221d8d.js";import"./VTextField-61c92ad5.js";import"./sweetalert2.esm.all-562d67d8.js";/* empty css              */import"./VChip-fcf1a935.js";import"./VAvatar-8b3dcd6d.js";const le="9ckqih5g25k3jtb9l2c6iv9ewziedlu79zh7k3amkq9qt9vn",ie={key:0,class:"text-warning"},Se=j({__name:"Form",setup(ne){const V=G(),{toast:I}=J(),v=d(),p=Z(),S=K(),{form:n,loading:E}=N(p),w=d(F()),s=d({}),T=d([]),u=d(F()),A=["jpg","jpeg","png"];u.value.allowedExtensions=A;const B=async()=>{var a,f;n.value.company_id=S.company.id;const r=await((a=v.value)==null?void 0:a.validate());if(r!=null&&r.valid){const l=await p.fetchSave();(l==null?void 0:l.code)===200&&(T.value=[],s.value={},w.value.clearData(),await((f=v.value)==null?void 0:f.resetValidation()),M.push({name:"Service-Index"})),(l==null?void 0:l.code)===422&&(s.value=l.errors??{})}else I("Faltan Campos Por Diligenciar","","danger")},D=r=>{u.value.handleImageSelected(r),setTimeout(()=>{n.value.image=u.value.imageFile},1e3)};P(async()=>{p.clearForm(),V.params.id&&await p.fetchDataForm(Number(V.params.id),V.params.action)});const q=h(()=>{if(s.value.html)return s.value.html}),b=h(()=>n.value.id?[]:[y]);return(r,a)=>{const f=Q,l=z,R=U("Editor");return c(),k("div",null,[e(re,null,{default:o(()=>[e(ee,null,{default:o(()=>[e(g,null,{default:o(()=>[e(m,null,{default:o(()=>[e(f,{"sub-title":"Formulario Servicio",action:String(r.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:r.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),e(t(x),{ref_key:"formValidation",ref:v,"lazy-validation":""},{default:o(()=>[e(g,null,{default:o(()=>[e(m,{cols:"12",sm:"3"},{default:o(()=>[e(l,{clearable:"",modelValue:t(n).title,"onUpdate:modelValue":a[0]||(a[0]=i=>t(n).title=i),rules:["requiredValidator"in r?r.requiredValidator:t(y)],"error-messages":t(s).title,label:"Título",onKeypress:a[1]||(a[1]=i=>t(s).title=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),e(m,{cols:"12",sm:"3"},{default:o(()=>[e(ae,null,{default:o(()=>[a[5]||(a[5]=_(" Imagen ")),t(b).length>0?(c(),k("b",ie,"*")):L("",!0)]),_:1}),(c(),C(te,{accept:"image/*",rules:t(b),key:t(u).key,onChange:a[2]||(a[2]=i=>D(i)),"onClick:clear":t(u).clearData},null,8,["rules","onClick:clear"]))]),_:1}),e(m,{cols:"12",sm:"3"},{default:o(()=>[e(oe,{src:t(u).imageUrl??t(n).image},null,8,["src"])]),_:1}),e(m,{cols:"12"},{default:o(()=>[e(R,{"api-key":"API_KEY_EDITOR"in r?r.API_KEY_EDITOR:t(le),init:{toolbar_mode:"sliding",plugins:"anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount linkchecker",toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat"},"initial-value":"",modelValue:t(n).html,"onUpdate:modelValue":a[3]||(a[3]=i=>t(n).html=i)},null,8,["api-key","modelValue"]),(c(!0),k(O,null,Y(t(q),(i,$)=>(c(),C(W,{key:$,class:"my-2",variant:"tonal",color:"error"},{default:o(()=>[_(X(i),1)]),_:2},1024))),128))]),_:1})]),_:1}),e(g),e(g,null,{default:o(()=>[e(m,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[e(H,{loading:t(E).form,color:"primary",onClick:a[4]||(a[4]=i=>B())},{default:o(()=>a[6]||(a[6]=[_(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{Se as default};
