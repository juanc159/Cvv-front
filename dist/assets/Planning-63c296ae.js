import{V as R,r as b}from"./VForm-5573d812.js";import{_ as H}from"./AppTextField.vue_vue_type_script_setup_true_lang-cfc48e9f.js";import{d as J,j as M,r as f,aB as w,E as O,ab as B,o as s,c as V,b as a,f as l,n as i,g as y,e as h,v,F as T,i as S,y as K,a9 as C,t as F,aw as Q,a1 as q,a7 as W}from"./index-9d7b2ae2.js";import{u as D}from"./useImageUpload-79738341.js";import{V as $}from"./VCardText-750086f9.js";import{V as g}from"./VRow-b2ea4d07.js";import{V as u}from"./VCol-ab44c4c7.js";import{V as X}from"./VCard-76b23484.js";import{V as Y}from"./VField-69296a2c.js";import{V as Z}from"./VFileInput-3a642961.js";import{V as j}from"./VDataTable-d10b6402.js";import"./helpers-3edea678.js";import"./VTextField-43cf00db.js";import"./VImg-191ee63c.js";import"./sweetalert2.all-ae952bba.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VAvatar-2ebb0d40.js";import"./VChip-4c9bcae3.js";import"./VSelect-bb23a69e.js";import"./VList-a7b918ba.js";import"./ssrBoot-a6d1e4cf.js";import"./VDivider-0d650db9.js";import"./dialog-transition-e2940ac0.js";import"./VMenu-a32e58ee.js";const ee=h("b",{class:"text-warning"},"*",-1),ae={key:0},le=["onClick"],Te=J({__name:"Planning",setup(te){const A=M();f(),f(),f([]);const I=f(D()),N=["jpg","jpeg","png","pdf","ppsx","pptx"];I.value.allowedExtensions=N;const z=async()=>{const e=new FormData;e.append("teacher_id",JSON.stringify(d.value.id));let t=0;d.value.complementaries.forEach(c=>{c.subjects.forEach(m=>{m.files.forEach((o,p)=>{e.append("file_id_"+t,o.id),e.append("file_grade_id_"+t,c.grade_id),e.append("file_section_id_"+t,c.section_id),e.append("file_subject_id_"+t,m.value),e.append("file_file_"+t,o.file),e.append("file_name_"+t,o.name),e.append("file_delete_"+t,o.delete),t++})}),e.append("files_cant",t)}),_.form=!0,await B("/teacher-planningStore").post(e),_.form=!1},_=w({form:!1}),d=f(),n=w({});O(async()=>{var o;_.form=!0;const{data:e,response:t,error:c,isFetching:m}=await B("/teacher-planning/"+A.params.id).get();_.form=m.value,(o=t.value)!=null&&o.ok&&e.value&&(d.value=e.value.data,d.value.complementaries.forEach(p=>{p.subjects.forEach(r=>{n["file-"+r.value]=f(D()),n["file-"+r.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))});const U=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],G=async e=>{e.files.push({name:n["file-"+e.value].name,file:n["file-"+e.value].imageFile,id:null,delete:0}),n["file-"+e.value].clearData()},x=(e,t,c)=>{e[t].delete=c};return(e,t)=>{const c=Q,m=H;return s(),V("div",null,[a(X,null,{default:l(()=>[a($,null,{default:l(()=>[a(g,null,{default:l(()=>[a(u,null,{default:l(()=>[a(c,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:e.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),i(d)?(s(),y($,{key:0},{default:l(()=>[a(g,null,{default:l(()=>[a(u,{cols:"12",sm:"6"},{default:l(()=>{var o,p;return[h("h2",null,v((o=i(d))==null?void 0:o.name)+" "+v((p=i(d))==null?void 0:p.last_name),1)]}),_:1})]),_:1}),a(g,null,{default:l(()=>[(s(!0),V(T,null,S(i(d).complementaries,(o,p)=>(s(),y(u,{cols:"12",key:p},{default:l(()=>[h("h2",null,"Grado: "+v(o.grade_name)+" "+v(o.section_name),1),(s(!0),V(T,null,S(o.subjects,(r,L)=>(s(),V("div",{key:L},[h("h3",null,"Planificacion: "+v(r.title),1),a(i(R),{"lazy-validation":""},{default:l(()=>[a(g,null,{default:l(()=>[a(u,{cols:"12",sm:"6"},{default:l(()=>[a(m,{clearable:"",modelValue:i(n)["file-"+r.value].name,"onUpdate:modelValue":k=>i(n)["file-"+r.value].name=k,rules:["requiredValidator"in e?e.requiredValidator:i(b)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(u,{cols:"12",sm:"3"},{default:l(()=>[a(Y,null,{default:l(()=>[F("Archivo "),ee]),_:1}),(s(),y(Z,{rules:["requiredValidator"in e?e.requiredValidator:i(b)],onChange:i(n)["file-"+r.value].handleImageSelected,key:i(n)["file-"+r.value].key,"onClick:clear":i(n)["file-"+r.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),a(u,{cols:"12",sm:"3"},{default:l(()=>[a(C,{size:"30",class:"mt-6",icon:"",color:"success",onClick:k=>G(r)},{default:l(()=>[a(q,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),a(u,{cols:"12"},{default:l(()=>[a(i(j),{headers:U,items:r.files,"items-per-page":999},{"item.actions":l(({item:k,index:E})=>[k.delete?(s(),V("span",ae,[F(" Sera eliminado al guardar, "),h("b",{style:{cursor:"pointer"},onClick:P=>x(r.files,E,0)},"restaurar",8,le)])):(s(),y(C,{key:1,icon:"",size:"x-small",color:"error",variant:"text",onClick:P=>x(r.files,E,1)},{default:l(()=>[a(q,{size:"22",icon:"tabler-trash"}),a(W,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]))]),bottom:l(()=>[]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024))),128))]),_:1})]),_:1})):K("",!0),a(g,null,{default:l(()=>[a(u,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[a(C,{loading:i(_).form,color:"primary",onClick:z},{default:l(()=>[F(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}});export{Te as default};
