import{r as S}from"./validators-AgaUOvKn.js";import{d as Y,s as Z}from"./helpers-BgzyUaXp.js";import{_ as J}from"./AppTextField.vue_vue_type_script_setup_true_lang-BZ26Uv9X.js";import{_ as K}from"./HeaderAlertView.vue_vue_type_script_setup_true_lang-DKquCoAc.js";import{d as O,q as Q,r as u,ax as T,M as W,af as A,c as y,o as m,b as e,f as l,k as o,e as h,D as g,F as I,p as q,g as F,C as z,ad as x,a8 as E,x as X,Y as ee,Z as ae}from"./index-DCpDUNVh.js";import{u as b,V as le}from"./VFileInput-CY5Vre_U.js";import{V as w}from"./VCardText-CBPuEyTc.js";import{V,a as p}from"./VRow-DD6Cq-Em.js";import{V as te}from"./VSkeletonLoader-Ci8RctAQ.js";import{V as D,b as oe}from"./VCard-CL8b460x.js";import{V as ie}from"./VInput-heHSgRYX.js";import{V as re}from"./VDataTable-BliUm9Xv.js";import{V as $}from"./VTooltip-B8Jux0jb.js";import{V as ne}from"./VForm-Dgpg-sjg.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-2GBt7OCP.js";import"./VTextField-CE4rgY8M.js";/* empty css                   */import"./VCounter-ofO5eDsa.js";import"./VImg-naWn7xvp.js";import"./forwardRefs-C-GTDzx5.js";import"./VAlert-VLPtW0LX.js";import"./VAvatar-D7AQGxKw.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./VChip-CUrNScCv.js";/* empty css              */import"./VOverlay-AbOeHg-J.js";import"./VSelect-Cg8Iet_A.js";import"./VList-LR0ntQza.js";import"./ssrBoot-DAy5ywqg.js";import"./VDivider-C-LzPx7s.js";import"./dialog-transition-c8_2NLHn.js";import"./VMenu-CgZ6tdII.js";import"./VCheckboxBtn-DaTZXKmb.js";import"./VSelectionControl-QCqjuza7.js";import"./VTable-EoZJtnXz.js";import"./filter-CRBA2jvB.js";const de=k=>(ee("data-v-cd7e280d"),k=k(),ae(),k),ce=de(()=>h("b",{class:"text-warning"},"*",-1)),pe=O({__name:"Planning",setup(k){const N=Q();u(),u(),u([]);const L=u(b()),P=["jpg","jpeg","png","pdf","ppsx","pptx"];L.value.allowedExtensions=P;const U=async()=>{var s;const a=new FormData;a.append("teacher_id",c.value.id);let t=0;c.value.complementaries.forEach(i=>{i.subjects.forEach(d=>{d.files.forEach((r,B)=>{a.append("file_id_"+t,r.id),a.append("file_grade_id_"+t,i.grade_id),a.append("file_section_id_"+t,i.section_id),a.append("file_subject_id_"+t,d.value),a.append("file_file_"+t,r.file),a.append("file_name_"+t,r.name),t++})}),a.append("files_cant",t)}),f.form=!0;const{data:_,response:C}=await A("/teacher-planningStore").post(a);f.form=!1,(s=C.value)!=null&&s.ok&&_.value&&(c.value=_.value.data,c.value.complementaries.forEach(i=>{i.subjects.forEach(d=>{n["file-"+d.value]=u(b()),n["file-"+d.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))},f=T({form:!1}),c=u(),n=T({});W(async()=>{var s;f.form=!0;const{data:a,response:t,error:_,isFetching:C}=await A("/teacher-planning/"+N.params.id).get();(s=t.value)!=null&&s.ok&&a.value&&(c.value=a.value.data,c.value.complementaries.forEach(i=>{i.subjects.forEach(d=>{n["file-"+d.value]=u(b()),n["file-"+d.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})})),f.form=!1});const G=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],M=async a=>{a.files.push({name:n["file-"+a.value].name,file:n["file-"+a.value].imageFile,id:null}),n["file-"+a.value].clearData()},R=(a,t,_)=>{a.splice(t,1)};return(a,t)=>{const _=K,C=J;return m(),y("div",null,[e(D,null,{default:l(()=>[e(w,null,{default:l(()=>[e(V,null,{default:l(()=>[e(p,null,{default:l(()=>[e(_,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:a.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(te,{type:"image, list-item-two-line",loading:o(f).form,class:"mt-5"},{default:l(()=>[e(V,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>{var s,i;return[h("h2",null,g((s=o(c))==null?void 0:s.name)+" "+g((i=o(c))==null?void 0:i.last_name),1)]}),_:1})]),_:1}),e(V,null,{default:l(()=>{var s;return[(m(!0),y(I,null,q((s=o(c))==null?void 0:s.complementaries,(i,d)=>(m(),F(p,{cols:"12",key:d},{default:l(()=>[e(D,null,{default:l(()=>[e(oe,{"primary-title":""},{default:l(()=>[h("h2",null,"Grado: "+g(i.grade_name)+" "+g(i.section_name),1)]),_:2},1024),e(w,null,{default:l(()=>[(m(!0),y(I,null,q(i.subjects,(r,B)=>(m(),y("div",{key:B},[h("h3",null,"Planificacion: "+g(r.title),1),e(o(ne),{"lazy-validation":""},{default:l(()=>[e(V,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(C,{clearable:"",modelValue:o(n)["file-"+r.value].name,"onUpdate:modelValue":v=>o(n)["file-"+r.value].name=v,rules:["requiredValidator"in a?a.requiredValidator:o(S)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(p,{cols:"12",sm:"5"},{default:l(()=>[e(ie,null,{default:l(()=>[z("Archivo "),ce]),_:1}),(m(),F(le,{rules:["requiredValidator"in a?a.requiredValidator:o(S)],onChange:o(n)["file-"+r.value].handleImageSelected,key:o(n)["file-"+r.value].key,"onClick:clear":o(n)["file-"+r.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),e(p,{cols:"12",sm:"1"},{default:l(()=>[e(x,{size:"30",class:"mt-6",icon:"",color:"success",onClick:v=>M(r)},{default:l(()=>[e(E,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),e(p,{cols:"12"},{default:l(()=>[e(re,{headers:G,items:r.files,"items-per-page":999},{"item.actions":l(({item:v,index:j})=>[h("div",null,[v.id?(m(),F(x,{key:0,icon:"",size:"x-small",color:"primary",variant:"text",onClick:H=>("descargarArchivo"in a?a.descargarArchivo:o(Y))(("storageBack"in a?a.storageBack:o(Z))(v.file),v.name)},{default:l(()=>[e(E,{size:"22",icon:"tabler-eye"}),e($,{location:"top",transition:"scale-transition",activator:"parent",text:"Visualizar"})]),_:2},1032,["onClick"])):X("",!0),e(x,{icon:"",size:"x-small",color:"error",variant:"text",onClick:H=>R(r.files,j,1)},{default:l(()=>[e(E,{size:"22",icon:"tabler-trash"}),e($,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"])])]),bottom:l(()=>[]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1},8,["loading"])]),_:1}),e(V,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(x,{loading:o(f).form,color:"primary",onClick:t[0]||(t[0]=s=>U())},{default:l(()=>[z(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Ke=se(pe,[["__scopeId","data-v-cd7e280d"]]);export{Ke as default};
