import{V as J,r as S}from"./VForm-d1f14f9f.js";import{_ as M}from"./AppTextField.vue_vue_type_script_setup_true_lang-c24db756.js";import{d as O,p as Z,r as f,aF as I,L as K,ah as T,o as d,c as g,b as e,f as l,k as i,g as C,e as h,C as v,F as B,m as $,E as Q,ag as b,B as F,aA as W,D as X,a8 as D,ae as Y,Z as j,$ as ee,V as ae}from"./index-5f64080f.js";import{u as q}from"./useImageUpload-449a8f0c.js";import{V as x}from"./VCardText-a3602111.js";import{V}from"./VRow-2667029d.js";import{V as p}from"./VCol-7542f4b4.js";import{V as A,b as le}from"./VCard-51c7a21e.js";import{V as te}from"./VField-cb70fae4.js";import{V as oe}from"./VFileInput-f276fd18.js";import{V as ie}from"./VDataTable-149a5213.js";import"./helpers-3edea678.js";import"./VTextField-8828dcf4.js";import"./VImg-5286d57c.js";import"./sweetalert2.all-e795d634.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VAvatar-ffe6488a.js";import"./VChip-6ff3ff7a.js";import"./VSelect-63cc1915.js";import"./VList-6cc34887.js";import"./ssrBoot-4ac93284.js";import"./VDivider-ff0605eb.js";import"./dialog-transition-5543f58a.js";import"./VMenu-9fac0700.js";const re=k=>(j("data-v-fcd12a2b"),k=k(),ee(),k),ne=re(()=>h("b",{class:"text-warning"},"*",-1)),se={key:0},de=["onClick"],ce=O({__name:"Planning",setup(k){const z=Z();f(),f(),f([]);const N=f(q()),P=["jpg","jpeg","png","pdf","ppsx","pptx"];N.value.allowedExtensions=P;const L=async()=>{const a=new FormData;a.append("teacher_id",JSON.stringify(c.value.id));let t=0;c.value.complementaries.forEach(u=>{u.subjects.forEach(m=>{m.files.forEach((o,s)=>{a.append("file_id_"+t,o.id),a.append("file_grade_id_"+t,u.grade_id),a.append("file_section_id_"+t,u.section_id),a.append("file_subject_id_"+t,m.value),a.append("file_file_"+t,o.file),a.append("file_name_"+t,o.name),a.append("file_delete_"+t,o.delete),t++})}),a.append("files_cant",t)}),_.form=!0,await T("/teacher-planningStore").post(a),_.form=!1},_=I({form:!1}),c=f(),n=I({});K(async()=>{var o;_.form=!0;const{data:a,response:t,error:u,isFetching:m}=await T("/teacher-planning/"+z.params.id).get();_.form=m.value,(o=t.value)!=null&&o.ok&&a.value&&(c.value=a.value.data,c.value.complementaries.forEach(s=>{s.subjects.forEach(r=>{n["file-"+r.value]=f(q()),n["file-"+r.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))});const U=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],G=async a=>{a.files.push({name:n["file-"+a.value].name,file:n["file-"+a.value].imageFile,id:null,delete:0}),n["file-"+a.value].clearData()},E=(a,t,u)=>{a[t].delete=u};return(a,t)=>{const u=W,m=M;return d(),g("div",null,[e(A,null,{default:l(()=>[e(x,null,{default:l(()=>[e(V,null,{default:l(()=>[e(p,null,{default:l(()=>[e(u,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:a.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),i(c)?(d(),C(x,{key:0},{default:l(()=>[e(V,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>{var o,s;return[h("h2",null,v((o=i(c))==null?void 0:o.name)+" "+v((s=i(c))==null?void 0:s.last_name),1)]}),_:1})]),_:1}),e(V,null,{default:l(()=>[(d(!0),g(B,null,$(i(c).complementaries,(o,s)=>(d(),C(p,{cols:"12",key:s},{default:l(()=>[e(A,{class:X({"green-background":s%2===0,"red-background":s%2!==0})},{default:l(()=>[e(le,{"primary-title":""},{default:l(()=>[h("h2",null,"Grado: "+v(o.grade_name)+" "+v(o.section_name),1)]),_:2},1024),e(x,null,{default:l(()=>[(d(!0),g(B,null,$(o.subjects,(r,R)=>(d(),g("div",{key:R},[h("h3",null,"Planificacion: "+v(r.title),1),e(i(J),{"lazy-validation":""},{default:l(()=>[e(V,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(m,{clearable:"",modelValue:i(n)["file-"+r.value].name,"onUpdate:modelValue":y=>i(n)["file-"+r.value].name=y,rules:["requiredValidator"in a?a.requiredValidator:i(S)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(te,null,{default:l(()=>[F("Archivo "),ne]),_:1}),(d(),C(oe,{rules:["requiredValidator"in a?a.requiredValidator:i(S)],onChange:i(n)["file-"+r.value].handleImageSelected,key:i(n)["file-"+r.value].key,"onClick:clear":i(n)["file-"+r.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(b,{size:"30",class:"mt-6",icon:"",color:"success",onClick:y=>G(r)},{default:l(()=>[e(D,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),e(p,{cols:"12"},{default:l(()=>[e(i(ie),{headers:U,items:r.files,"items-per-page":999},{"item.actions":l(({item:y,index:w})=>[y.delete?(d(),g("span",se,[F(" Sera eliminado al guardar, "),h("b",{style:{cursor:"pointer"},onClick:H=>E(r.files,w,0)},"restaurar",8,de)])):(d(),C(b,{key:1,icon:"",size:"x-small",color:"error",variant:"text",onClick:H=>E(r.files,w,1)},{default:l(()=>[e(D,{size:"22",icon:"tabler-trash"}),e(Y,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]))]),bottom:l(()=>[]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),_:1})):Q("",!0),e(V,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(b,{loading:i(_).form,color:"primary",onClick:t[0]||(t[0]=o=>L())},{default:l(()=>[F(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}});const ze=ae(ce,[["__scopeId","data-v-fcd12a2b"]]);export{ze as default};
