import{a as z}from"./formatters-1588bd0d.js";import{_ as D,a as E}from"./TableFullNew.vue_vue_type_script_setup_true_lang-ef38e87c.js";import{u as $}from"./useCrudStudentStore-4ec117dd.js";import{d as I,R as A,r as u,aF as R,o as m,c as G,b as e,f as o,e as f,ae as n,k as s,a6 as c,ac as p,B as h,g as w,C as L,ay as P,af as Q}from"./index-637629ed.js";import{S as C}from"./sweetalert2.esm.all-562d67d8.js";import{a as j}from"./helpers-53221d8d.js";import{b as q,V as H}from"./VCard-934e654b.js";import{V as J}from"./VCardText-45e51a5a.js";import{V as K}from"./VImg-d8b48e6b.js";import{V as g}from"./VAvatar-a4c167fb.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-db1cb66a.js";import"./VDialog-a1cc5e7f.js";import"./dialog-transition-50f617be.js";import"./VField-d9d754c0.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-9f8c8095.js";import"./VSelect-ac35f58e.js";import"./VTextField-3bf1c892.js";import"./VList-16301470.js";import"./ssrBoot-a08ea34b.js";import"./VDivider-b6156efd.js";import"./VMenu-6006b8c8.js";import"./VChip-efe50c83.js";import"./VRow-6e530c1e.js";/* empty css              */import"./VCol-6740a4e0.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-25440106.js";import"./_commonjsHelpers-725317a4.js";import"./createUrl-ed292c04.js";import"./index-9c720871.js";import"./VContainer-d2c7f379.js";import"./VPagination-d17cb170.js";import"./VDataTable-59f4f454.js";const M={class:"app-teacher-search-filter d-flex align-center flex-wrap gap-4"},Be=I({__name:"Index",setup(O){const y=$(),S=A(),b=async a=>{C.fire({title:"¿Seguro desea reiniciar la contraseña al registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async t=>{t.isConfirmed?await y.fetchResetPassword(a):t.isDenied})},d=u(),T={url:"/student-list",headers:[{title:"Acciones",key:"actions"},{title:"Foto ",key:"photo"},{title:"Grado ",key:"grade_name"},{title:"Sección ",key:"section_name"},{title:"Cédula ",key:"identity_document"},{title:"Nombre",key:"full_name"},{title:"Tipo de educación",key:"type_education_name"}],params:{company_id:S.company.id}},_=u({}),x=(a={})=>{_.value=a,d.value.changeFilter(a)},B=u({inputGeneral:{relationsGeneral:{all:["identity_document","full_name"],typeEducation:["name"],grade:["name"],section:["name"]}},dialog:{width:500,inputs:[{input_type:"select",title:"Foto",search_key:"photoPerzonalized",type:"null",custom_search:!0,arrayList:[{value:"1",title:"Con foto"},{value:"0",title:"Sin foto"}]},{input_type:"selectInfinite",title:"Sección",key:"section",api:"selectInfiniteSection",search_key:"section_id"}]}}),v=async(a="create",t)=>{P.push({name:"Student-Form",params:{action:a,id:t}})},F=async a=>{C.fire({title:"¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async t=>{t.isConfirmed?(await y.fetchDelete(a),await x(_.value)):t.isDenied})},r=R({excel:!1}),V=async()=>{var l;r.excel=!0;const{data:a,response:t}=await Q("/student-excelExport").post({searchQuery:d.value.optionsTable.searchQuery});r.excel=!1,(l=t.value)!=null&&l.ok&&a.value&&j(a.value.excel,"Lista de estudiantes")};return(a,t)=>{const l=D,N=E;return m(),G("div",null,[e(H,null,{default:o(()=>[e(q,{class:"d-flex justify-space-between"},{default:o(()=>[t[3]||(t[3]=f("div",null," Listado de estudiantes ",-1)),f("div",M,[e(n,{loading:s(r).excel,disabled:s(r).excel,size:"38",color:"primary",icon:"",onClick:t[0]||(t[0]=i=>V())},{default:o(()=>[e(c,{icon:"tabler-file-spreadsheet"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Descargar Excel"})]),_:1},8,["loading","disabled"]),e(n,{color:"primary",onClick:t[1]||(t[1]=i=>v())},{default:o(()=>t[2]||(t[2]=[h(" Crear Estudiante ")])),_:1})])]),_:1}),e(J,null,{default:o(()=>[e(l,{ref:"filterDialogNewRef",optionsFilter:s(B),onSendFilter:x},null,8,["optionsFilter"])]),_:1}),e(N,{ref_key:"tableFullNew",ref:d,optionsTable:T},{"item.photo":o(({item:i})=>[f("div",null,[i.photo?(m(),w(g,{key:0,color:"primary",variant:"tonal",size:"50"},{default:o(()=>[e(K,{src:i.photo},null,8,["src"])]),_:2},1024)):(m(),w(g,{key:1,color:"primary",variant:"tonal",size:"50"},{default:o(()=>[h(L(("avatarText"in a?a.avatarText:s(z))(i.full_name)),1)]),_:2},1024))])]),"item.actions":o(({item:i})=>[e(n,{icon:"",size:"x-small",color:"error",variant:"text",onClick:k=>F(i.id)},{default:o(()=>[e(c,{size:"22",icon:"tabler-trash"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]),e(n,{icon:"",size:"x-small",color:"default",variant:"text",onClick:k=>v("edit",i.id)},{default:o(()=>[e(c,{size:"22",icon:"tabler-edit"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Editar"})]),_:2},1032,["onClick"]),e(n,{icon:"",size:"x-small",variant:"text",onClick:k=>b(i.id)},{default:o(()=>[e(c,{size:"22",icon:"tabler-lock-open"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Resetear contraseña"})]),_:2},1032,["onClick"])]),_:1},512)]),_:1})])}}});export{Be as default};
