import{f as x}from"./formatters-BfsO99cJ.js";import{_ as H}from"./AppCardActions.vue_vue_type_style_index_0_lang-BcHALsoU.js";import{_ as L}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-DZiNFCtT.js";import{d as j,R as P,U as Z,r as S,Z as k,M as z,ax as C,o as a,c as s,b as d,f as m,k as r,ad as A,a8 as R,C as B,e,F as h,p as _,G as F,af as G,D as l,$ as J,a0 as K}from"./index-d--exNae.js";import{c as Q}from"./createUrl-DNaA-Dph.js";import{b as W}from"./helpers-Bx7coLRZ.js";import{V as U}from"./VCardText-Csh7jUF6.js";import{V as X,a as I}from"./VRow-DWtH4oj-.js";import{V as M}from"./VTable-C51t7yvP.js";import{V as $}from"./VContainer-DBu-xnaU.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VCard-CRcIyXSu.js";import"./VAvatar-BF3wOyv9.js";import"./VImg-BbHm1gH0.js";import"./VOverlay-C-sRhPRL.js";import"./VInput-C3Rirru3.js";import"./VTooltip-lFZ4t2eE.js";import"./forwardRefs-C-GTDzx5.js";import"./index-0F-JFElI.js";import"./constants-2GBt7OCP.js";/* empty css              */const w=g=>(J("data-v-6222127e"),g=g(),K(),g),ee=w(()=>e("thead",null,[e("tr",{class:"header-row"},[e("th",{class:"header-cell",rowspan:"2"},"Tipo de Educación"),e("th",{class:"header-cell",rowspan:"2"},"Grado y Sección"),e("th",{class:"header-cell initial-header",colspan:"3"},"Matrícula Inicial"),e("th",{class:"header-cell entries-header",colspan:"3"},"Ingresos"),e("th",{class:"header-cell withdrawals-header",colspan:"3"},"Egresos"),e("th",{class:"header-cell current-header",colspan:"3"},"Matrícula Actual"),e("th",{class:"header-cell foreign-header",colspan:"3"},"Extranjeros")]),e("tr",{class:"header-row"},[e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T")])],-1)),te=["rowspan"],le={class:"grade-cell"},ae={class:"initial-cell"},se={class:"initial-cell"},ne={class:"initial-cell"},oe={class:"entries-cell"},re={class:"entries-cell"},ce={class:"entries-cell"},ie={class:"withdrawals-cell"},de={class:"withdrawals-cell"},ue={class:"withdrawals-cell"},me={class:"current-cell"},he={class:"current-cell"},_e={class:"current-cell"},fe={class:"foreign-cell"},pe={class:"foreign-cell"},we={class:"foreign-cell"},be={class:"subtotal-row"},ge=w(()=>e("td",{class:"subtotal-cell"},"Subtotal",-1)),ye={class:"initial-cell"},Ee={class:"entries-cell"},Ne={class:"withdrawals-cell"},xe={class:"current-cell"},De={class:"current-cell"},ve={class:"total-row"},Ve=w(()=>e("td",{colspan:"2",class:"total-cell"},"Total General",-1)),Se={class:"initial-cell"},Fe={class:"entries-cell"},Ie={class:"withdrawals-cell"},Me={class:"current-cell"},Te={class:"current-cell"},ke=w(()=>e("h2",{class:"text-h4 font-weight-bold mb-4"},"Estudiantes Retirados",-1)),Ce=w(()=>e("thead",null,[e("tr",null,[e("th",null,"Documento"),e("th",null,"Apellidos y Nombres"),e("th",null,"Fecha Nacimiento"),e("th",null,"Grado"),e("th",null,"Sección"),e("th",null,"Sexo"),e("th",null,"Fecha Retiro"),e("th",null,"Motivo")])],-1)),Ae={key:0},Re=w(()=>e("td",{colspan:"8",class:"text-center"},"No hay estudiantes retirados registrados",-1)),Be=[Re],Ge=w(()=>e("h2",{class:"text-h4 font-weight-bold mb-4"},"Estudiantes Ingresados",-1)),Ue=w(()=>e("thead",null,[e("tr",null,[e("th",null,"Documento"),e("th",null,"Apellidos y Nombres"),e("th",null,"Fecha Nacimiento"),e("th",null,"Grado"),e("th",null,"Sección"),e("th",null,"Sexo"),e("th",null,"Fecha Ingreso")])],-1)),$e={key:0},je=w(()=>e("td",{colspan:"8",class:"text-center"},"No hay estudiantes retirados registrados",-1)),Oe=[je],qe=j({__name:"StudentStatistics",setup(g){const{company:D}=P(Z()),N=S([]),y=S([]),v=S([]),E=k(()=>{const n={male:0,female:0,total:0},c={male:0,female:0,total:0},u={male:0,female:0,total:0},f={male:0,female:0,total:0},t={male:0,female:0,total:0};return N.value.forEach(i=>{n.male+=Number(i.initial.male),n.female+=Number(i.initial.female),n.total+=Number(i.initial.total),c.male+=Number(i.new_entries.male),c.female+=Number(i.new_entries.female),c.total+=Number(i.new_entries.total),u.male+=Number(i.withdrawals.male),u.female+=Number(i.withdrawals.female),u.total+=Number(i.withdrawals.total),f.male+=Number(i.current.male),f.female+=Number(i.current.female),f.total+=Number(i.current.total),t.male+=Number(i.foreign.male),t.female+=Number(i.foreign.female),t.total+=Number(i.foreign.total)}),{initial:n,new_entries:c,withdrawals:u,current:f,foreign:t}}),V=async()=>{p.fetchData=!0;try{const{data:n,response:c}=await G(Q("/students/statistics",{query:{dateInitial:b.dateInitial,dateEnd:b.dateEnd,company_id:D.value.id}}));if(!c.value.ok)throw new Error("Error al obtener datos");N.value=Object.values(n.value.statistics),y.value=n.value.withdrawnStudents,v.value=n.value.entriesStudents}catch(n){console.error("Error al obtener datos:",n)}finally{p.fetchData=!1}};z(async()=>{V()});const O=k(()=>{const n={};return N.value.forEach(c=>{const u=c.type_education_name;n[u]||(n[u]={type:u,items:[],subtotal:{initial:{male:0,female:0,total:0},new_entries:{male:0,female:0,total:0},withdrawals:{male:0,female:0,total:0},current:{male:0,female:0,total:0},foreign:{male:0,female:0,total:0}}}),n[u].items.push(c),["initial","new_entries","withdrawals","current","foreign"].forEach(f=>{n[u].subtotal[f].male+=Number(c[f].male),n[u].subtotal[f].female+=Number(c[f].female),n[u].subtotal[f].total+=Number(c[f].total)})}),Object.values(n)}),b=C({dateInitial:null,dateEnd:null}),p=C({excel:!1,fetchData:!1}),q=async()=>{var u;p.excel=!0;const{data:n,response:c}=await G("/students/statisticsExcelExport").post({dateInitial:b.dateInitial,dateEnd:b.dateEnd,company_id:D.value.id});p.excel=!1,(u=c.value)!=null&&u.ok&&n.value&&W(n.value.excel,"Estadisticas de Estudiantes")};return(n,c)=>{const u=L,f=H;return a(),s("div",null,[d(f,{title:"Estadísticas de Estudiantes",actionRefresh:"",onRefresh:V,loading:r(p).fetchData,"onUpdate:loading":c[2]||(c[2]=t=>r(p).fetchData=t)},{default:m(()=>[d(U,null,{default:m(()=>[d(X,null,{default:m(()=>[d(I,{cols:"12",md:"3"},{default:m(()=>[d(u,{clearable:"",modelValue:r(b).dateInitial,"onUpdate:modelValue":c[0]||(c[0]=t=>r(b).dateInitial=t),label:"Fecha inicio",placeholder:"Desde"},null,8,["modelValue"])]),_:1}),d(I,{cols:"12",md:"3"},{default:m(()=>[d(u,{clearable:"",modelValue:r(b).dateEnd,"onUpdate:modelValue":c[1]||(c[1]=t=>r(b).dateEnd=t),label:"Fecha fin",placeholder:"Hasta"},null,8,["modelValue"])]),_:1}),d(I,{cols:"12",md:"3",class:"d-flex gap-3 flex-wrap"},{default:m(()=>[d(A,{class:"mt-6",onClick:V,loading:r(p).fetchData,disabled:r(p).fetchData},{prepend:m(()=>[d(R,{icon:"tabler-search"})]),default:m(()=>[B(" Buscar ")]),_:1},8,["loading","disabled"]),d(A,{class:"mt-6",onClick:q,loading:r(p).excel,disabled:r(p).excel},{prepend:m(()=>[d(R,{icon:"tabler-file-type-xls"})]),default:m(()=>[B(" Exportar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),d(U,null,{default:m(()=>[d(M,{class:"stats-table"},{default:m(()=>[ee,e("tbody",null,[(a(!0),s(h,null,_(r(O),(t,i)=>(a(),s(h,{key:i},[(a(!0),s(h,null,_(t.items,(o,T)=>(a(),s("tr",{key:T,class:"data-row"},[T===0?(a(),s("td",{key:0,rowspan:t.items.length+1,class:"type-cell"},l(t.type),9,te)):F("",!0),e("td",le,l(o.grade_name)+" - "+l(o.section_name),1),e("td",ae,l(o.initial.male),1),e("td",se,l(o.initial.female),1),e("td",ne,l(o.initial.total),1),e("td",oe,l(o.new_entries.male),1),e("td",re,l(o.new_entries.female),1),e("td",ce,l(o.new_entries.total),1),e("td",ie,l(o.withdrawals.male),1),e("td",de,l(o.withdrawals.female),1),e("td",ue,l(o.withdrawals.total),1),e("td",me,l(o.current.male),1),e("td",he,l(o.current.female),1),e("td",_e,l(o.current.total),1),e("td",fe,l(o.foreign.male),1),e("td",pe,l(o.foreign.female),1),e("td",we,l(o.foreign.total),1)]))),128)),e("tr",be,[ge,(a(!0),s(h,null,_(t.subtotal.initial,o=>(a(),s("td",ye,l(o),1))),256)),(a(!0),s(h,null,_(t.subtotal.new_entries,o=>(a(),s("td",Ee,l(o),1))),256)),(a(!0),s(h,null,_(t.subtotal.withdrawals,o=>(a(),s("td",Ne,l(o),1))),256)),(a(!0),s(h,null,_(t.subtotal.current,o=>(a(),s("td",xe,l(o),1))),256)),(a(!0),s(h,null,_(t.subtotal.foreign,o=>(a(),s("td",De,l(o),1))),256))])],64))),128)),e("tr",ve,[Ve,(a(!0),s(h,null,_(r(E).initial,t=>(a(),s("td",Se,l(t),1))),256)),(a(!0),s(h,null,_(r(E).new_entries,t=>(a(),s("td",Fe,l(t),1))),256)),(a(!0),s(h,null,_(r(E).withdrawals,t=>(a(),s("td",Ie,l(t),1))),256)),(a(!0),s(h,null,_(r(E).current,t=>(a(),s("td",Me,l(t),1))),256)),(a(!0),s(h,null,_(r(E).foreign,t=>(a(),s("td",Te,l(t),1))),256))])])]),_:1}),d($,{style:{"margin-top":"40px"}},{default:m(()=>[ke,d(M,{"fixed-header":""},{default:m(()=>[Ce,e("tbody",null,[(a(!0),s(h,null,_(r(y),(t,i)=>(a(),s("tr",{key:i},[e("td",null,l(t.identity_document),1),e("td",null,l(t.full_name),1),e("td",null,l(("formatDate"in n?n.formatDate:r(x))(t.birthday)),1),e("td",null,l(t.grade_name),1),e("td",null,l(t.section_name),1),e("td",null,l(t.gender==="M"?"Masculino":"Femenino"),1),e("td",null,l(("formatDate"in n?n.formatDate:r(x))(t.withdrawal_date)),1),e("td",null,l(t.reason),1)]))),128)),r(y).length===0?(a(),s("tr",Ae,Be)):F("",!0)])]),_:1})]),_:1}),d($,{style:{"margin-top":"40px"}},{default:m(()=>[Ge,d(M,{"fixed-header":""},{default:m(()=>[Ue,e("tbody",null,[(a(!0),s(h,null,_(r(v),(t,i)=>(a(),s("tr",{key:i},[e("td",null,l(t.identity_document),1),e("td",null,l(t.full_name),1),e("td",null,l(("formatDate"in n?n.formatDate:r(x))(t.birthday)),1),e("td",null,l(t.grade_name),1),e("td",null,l(t.section_name),1),e("td",null,l(t.gender==="M"?"Masculino":"Femenino"),1),e("td",null,l(("formatDate"in n?n.formatDate:r(x))(t.real_entry_date)),1)]))),128)),r(v).length===0?(a(),s("tr",$e,Oe)):F("",!0)])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])])}}}),He=Y(qe,[["__scopeId","data-v-6222127e"]]),ut=j({__name:"Enrollments&Exits",setup(g){return(D,N)=>{const y=He;return a(),s("div",null,[d(y)])}}});export{ut as default};
