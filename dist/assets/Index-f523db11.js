import{V as w,r as _}from"./VForm-93a57085.js";import{_ as I}from"./AppSelect.vue_vue_type_script_setup_true_lang-56c369f6.js";import{d as S,R as U,aF as j,r as n,L as z,af as v,o as x,c as L,b as o,f as l,B as m,k as a,e as P,g as R,ae as F,aA as M}from"./index-ba2685b5.js";import{u as G}from"./useImageUpload-548d0096.js";import{c as H}from"./createUrl-4a1dbebf.js";import{a as J}from"./helpers-53221d8d.js";import{b as q,V as D}from"./VCard-1dca3b92.js";import{V as B}from"./VCardText-27ca00f5.js";import{V as y}from"./VRow-3431edda.js";import{V as f}from"./VCol-b72a8398.js";import{V as K}from"./VField-e5cc8e8a.js";import{V as O}from"./VFileInput-ee25622e.js";import"./VSelect-8440ed8f.js";import"./VTextField-0453d93a.js";import"./VImg-2b1475bc.js";import"./VList-dc57db0b.js";import"./ssrBoot-5fdfebdb.js";import"./VAvatar-ade85f75.js";import"./VDivider-c2c0a35b.js";import"./dialog-transition-c42e04e3.js";import"./VMenu-0d10e868.js";import"./VChip-c897905c.js";import"./sweetalert2.esm.all-562d67d8.js";import"./index-9c720871.js";/* empty css              */const Ce=S({__name:"Index",setup(Q){const A=U(),{toast:g}=M(),r=j({form:!1,excel:!1}),s=n({company_id:null,type_education_id:null,archive:null}),p=n({}),C=n(),b=n(),c=n([]),u=n(G());u.value.allowedExtensions=["xls","xlsx"],z(async()=>{var d;r.form=!0;const{data:t,response:e}=await v("note-dataForm").get();r.form=!1,(d=e.value)!=null&&d.ok&&t.value&&(c.value=t.value.typeEducations)});const N=async()=>{var e;s.value.archive=u.value.imageFile,s.value.company_id=A.company.id;const t=await((e=C.value)==null?void 0:e.validate());if(t!=null&&t.valid){const d=new FormData;for(const i in s.value)d.append(i,s.value[i]);r.form=!0,await v("note-store").post(d),r.form=!1}else g("Faltan Campos Por Diligenciar","","danger")},V=n({type_education_id:null}),T=async()=>{var e,d;const t=await((e=b.value)==null?void 0:e.validate());if(t!=null&&t.valid){r.excel=!0;const i=c.value.find($=>$.value==V.value.type_education_id),{data:k,response:E}=await v(H("/teacher-downloadAllConsolidated",{query:{type_education_id:V.value.type_education_id}}));r.excel=!1,(d=E.value)!=null&&d.ok&&k.value&&J(k.value.excel,"Consolidado "+(i==null?void 0:i.title))}else g("Faltan Campos Por Diligenciar","","danger")};return(t,e)=>{const d=I;return x(),L("div",null,[o(D,{disabled:a(r).form,loading:a(r).form},{default:l(()=>[o(q,{"primary-title":""},{default:l(()=>e[6]||(e[6]=[m("Cargar Notas")])),_:1}),o(B,null,{default:l(()=>[o(a(w),{ref_key:"formValidation",ref:C,"lazy-validation":""},{default:l(()=>[o(y,null,{default:l(()=>[o(f,{cols:"12",sm:"4"},{default:l(()=>[o(d,{clearable:"",modelValue:a(s).type_education_id,"onUpdate:modelValue":e[0]||(e[0]=i=>a(s).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:a(_)],"error-messages":a(p).type_education_id,label:"Tipo",onChange:e[1]||(e[1]=i=>a(p).type_education_id=""),requiredField:!0,items:a(c)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),o(f,{cols:"12",sm:"4"},{default:l(()=>[o(K,null,{default:l(()=>e[7]||(e[7]=[m("ArchivoÂ "),P("b",{class:"text-warning"},"*",-1)])),_:1}),(x(),R(O,{key:a(u).key,onChange:a(u).handleImageSelected,"onClick:clear":a(u).clearData,rules:["requiredValidator"in t?t.requiredValidator:a(_)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),o(y,null,{default:l(()=>[o(f,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[o(F,{loading:a(r).form,disabled:a(r).form,color:"primary",onClick:e[2]||(e[2]=i=>N())},{default:l(()=>e[8]||(e[8]=[m(" Cargar ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),o(D,{disabled:a(r).form,loading:a(r).form,class:"mt-3"},{default:l(()=>[o(q,{"primary-title":""},{default:l(()=>e[9]||(e[9]=[m("Descargar Notas")])),_:1}),o(B,null,{default:l(()=>[o(a(w),{ref_key:"formValidationDownload",ref:b,"lazy-validation":""},{default:l(()=>[o(y,null,{default:l(()=>[o(f,{cols:"12",sm:"4"},{default:l(()=>[o(d,{clearable:"",modelValue:a(V).type_education_id,"onUpdate:modelValue":e[3]||(e[3]=i=>a(V).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:a(_)],"error-messages":a(p).type_education_id,label:"Tipo",onChange:e[4]||(e[4]=i=>a(p).type_education_id=""),requiredField:!0,items:a(c)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),o(y,null,{default:l(()=>[o(f,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[o(F,{loading:a(r).excel,disabled:a(r).excel,color:"primary",onClick:e[5]||(e[5]=i=>T())},{default:l(()=>e[10]||(e[10]=[m(" Descargar ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Ce as default};
