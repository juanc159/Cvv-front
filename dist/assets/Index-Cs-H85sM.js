import{V as j,r as N}from"./VForm-DY0CurlX.js";import{_ as H}from"./AppSelect.vue_vue_type_script_setup_true_lang-BC0bIYwY.js";import{d as J,U as K,ax as O,r as d,M as Q,af as p,Z as W,o as _,c as q,b as e,f as l,C as m,k as a,g as S,ad as U,e as x,ae as X,F as I,p as L,ay as Y,D as ee}from"./index-C4PIXJO-.js";import{u as ae,V as le}from"./VFileInput-Bc7VXVU9.js";import{c as oe}from"./createUrl-Chm6mUuX.js";import{a as te}from"./helpers-DMPihPy4.js";import{b as z,V as C}from"./VCard-DtG8Z-wZ.js";import{V as g}from"./VCardText-LV5Z11Wn.js";import{V as u,a as n}from"./VRow-CdckmSvP.js";import{V as se}from"./VInput-41tD8npT.js";import{V as P}from"./VSwitch-aQlV9Scr.js";import{V as ie}from"./VDivider-B2WZx8nd.js";import"./forwardRefs-C-GTDzx5.js";import"./VTooltip-DfO-Y3j1.js";import"./VOverlay-DfLrglt5.js";import"./VImg-QEk0HI8i.js";import"./VSelect-CH6p-gdB.js";import"./VTextField-75zs_qRt.js";import"./VList-n92eOVUS.js";import"./ssrBoot-CzMjs1st.js";import"./VAvatar-BpTFyLRV.js";import"./dialog-transition-DoLjAcQz.js";import"./VMenu-mbMlZZlH.js";import"./VCheckboxBtn-mwC8yvvC.js";import"./VSelectionControl-C-l3svY7.js";import"./VChip-DR0jqpGN.js";import"./sweetalert2.esm.all-DOYwHpwi.js";import"./index-0F-JFElI.js";import"./constants-2GBt7OCP.js";/* empty css              */const re=x("b",{class:"text-warning"},"*",-1),de={class:"demo-space-x"},ne={class:"demo-space-x"},Re=J({__name:"Index",setup(ue){const B=K(),{toast:T}=Y(),i=O({form:!1,excel:!1}),f=d({company_id:null,type_education_id:null,archive:null}),b=d({}),$=d(),A=d(),v=d([]),V=d(ae());V.value.allowedExtensions=["xls","xlsx"];const y=d(!1),k=d({});Q(async()=>{var r;await M(),i.form=!0;const{data:s,response:o}=await p("note-dataForm").get();(r=o.value)!=null&&r.ok&&s.value&&(v.value=s.value.typeEducations,y.value=s.value.blockData),i.form=!1});const M=async()=>{var r;const{data:s,response:o}=await p("/type_educations/visualization/show").get();(r=o.value)!=null&&r.ok&&s.value&&(k.value=s.value.selectedNotes)},R=async()=>{var o;f.value.archive=V.value.imageFile,f.value.company_id=B.company.id;const s=await((o=$.value)==null?void 0:o.validate());if(s!=null&&s.valid){const r=new FormData;for(const t in f.value)r.append(t,f.value[t]);i.form=!0,await p("note-store").post(r),i.form=!1}else T("Faltan Campos Por Diligenciar","","danger")},w=d({type_education_id:null}),h=async()=>{var o,r;const s=await((o=A.value)==null?void 0:o.validate());if(s!=null&&s.valid){i.excel=!0;const t=v.value.find(F=>F.value==w.value.type_education_id),{data:c,response:D}=await p(oe("/note-downloadAllConsolidated",{query:{type_education_id:w.value.type_education_id,company_id:B.company.id}}));i.excel=!1,(r=D.value)!=null&&r.ok&&c.value&&te(c.value.excel,"Consolidado "+(t==null?void 0:t.title))}else T("Faltan Campos Por Diligenciar","","danger")},E=async s=>{var t;const{data:o,response:r}=await p("/note-blockPayrollUpload").post({value:s});(t=r.value)!=null&&t.ok&&o.value},G=W(()=>y.value?"Sí":"No"),Z=async()=>{i.form=!0,await p("/type_educations/visualization/store").post({selectedNotes:k.value}),i.form=!1};return(s,o)=>{const r=H;return _(),q("div",null,[e(C,{disabled:a(i).form,loading:a(i).form},{default:l(()=>[e(z,{"primary-title":""},{default:l(()=>[m("Cargar Notas")]),_:1}),e(g,null,{default:l(()=>[e(a(j),{ref_key:"formValidation",ref:$,"lazy-validation":""},{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[e(r,{clearable:"",modelValue:a(f).type_education_id,"onUpdate:modelValue":o[0]||(o[0]=t=>a(f).type_education_id=t),rules:["requiredValidator"in s?s.requiredValidator:a(N)],"error-messages":a(b).type_education_id,label:"Tipo",onChange:o[1]||(o[1]=t=>a(b).type_education_id=""),requiredField:!0,items:a(v)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:l(()=>[e(se,null,{default:l(()=>[m("Archivo "),re]),_:1}),(_(),S(le,{key:a(V).key,onChange:a(V).handleImageSelected,"onClick:clear":a(V).clearData,rules:["requiredValidator"in s?s.requiredValidator:a(N)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(U,{loading:a(i).form,disabled:a(i).form,color:"primary",onClick:o[2]||(o[2]=t=>R())},{default:l(()=>[m(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),e(C,{disabled:a(i).form,loading:a(i).form,class:"mt-3"},{default:l(()=>[e(z,{"primary-title":""},{default:l(()=>[m("Descargar Notas")]),_:1}),e(g,null,{default:l(()=>[e(a(j),{ref_key:"formValidationDownload",ref:A,"lazy-validation":""},{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[e(r,{clearable:"",modelValue:a(w).type_education_id,"onUpdate:modelValue":o[3]||(o[3]=t=>a(w).type_education_id=t),rules:["requiredValidator"in s?s.requiredValidator:a(N)],"error-messages":a(b).type_education_id,label:"Tipo",onChange:o[4]||(o[4]=t=>a(b).type_education_id=""),requiredField:!0,items:a(v)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(n,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(U,{loading:a(i).excel,disabled:a(i).excel,color:"primary",onClick:o[5]||(o[5]=t=>h())},{default:l(()=>[m(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),e(C,{disabled:a(i).form,loading:a(i).form,class:"mt-3"},{default:l(()=>[e(z,{"primary-title":""},{default:l(()=>[m("Bloquear carga de notas a los profesores")]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12",sm:"4"},{default:l(()=>[x("div",de,[e(P,{modelValue:a(y),"onUpdate:modelValue":[o[6]||(o[6]=t=>X(y)?y.value=t:null),o[7]||(o[7]=t=>E(t))],label:a(G),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"]),e(C,{disabled:a(i).form,loading:a(i).form,class:"mt-3",title:"Visualización de las notas"},{default:l(()=>[(_(!0),q(I,null,L(a(v),t=>(_(),S(g,{key:t.value},{default:l(()=>[e(ie),e(u,null,{default:l(()=>[e(n,null,{default:l(()=>[x("span",null,ee(t.title),1)]),_:2},1024)]),_:2},1024),e(u,null,{default:l(()=>[(_(!0),q(I,null,L(t.cantNotes,(c,D)=>(_(),S(n,{cols:"12",sm:"4",key:D},{default:l(()=>[x("div",ne,[e(P,{modelValue:a(k)[t.value]["note_"+c],"onUpdate:modelValue":F=>a(k)[t.value]["note_"+c]=F,label:"Nota "+c,color:"success"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128)),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[e(n,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(U,{loading:a(i).form,disabled:a(i).form,color:"primary",onClick:o[8]||(o[8]=t=>Z())},{default:l(()=>[m(" Guardar Visualización ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Re as default};
