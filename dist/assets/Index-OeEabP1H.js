import{h as y,b as Y}from"./helpers-erdtQGyB.js";import{V as R,r as $}from"./VForm-D8npvq3E.js";import{_ as ee}from"./ModalQuestion.vue_vue_type_script_setup_true_lang-Bo16dNWo.js";import{_ as ae}from"./DragAndDrop.vue_vue_type_script_setup_true_lang-CIwnDWoA.js";import{_ as oe}from"./AppSelect.vue_vue_type_script_setup_true_lang-pAPyJKd_.js";import{d as le,U as te,ax as se,r as m,M as ie,af as p,Z as ne,o as r,c as M,k as a,g as c,f as e,G as V,b as o,C as f,ad as S,e as D,ae as de,F as j,p as I,D as re,ay as ue}from"./index-SfW_hqf6.js";import{u as me,V as _e}from"./VFileInput-BCpGUgTZ.js";import{c as ce}from"./createUrl-CNxQGrOo.js";import{V as b,b as U}from"./VCard-BrQXPxCH.js";import{V as _,a as u}from"./VRow-Dd2nOtw5.js";import{V as fe}from"./VInput-C02QbKh5.js";import{V as g}from"./VGrid-DfTeA3wd.js";import{V as L}from"./VSwitch-tvx9UYBc.js";import{V as pe}from"./VDivider-CtMZu1i4.js";import"./constants-2GBt7OCP.js";import"./forwardRefs-C-GTDzx5.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-Baa8mQKq.js";import"./VDialog-3KKakAi7.js";import"./VOverlay-eppBgRwk.js";import"./VImg-CajOL9sn.js";import"./dialog-transition-6S4CzNsS.js";import"./VSpacer-CBiHogUe.js";import"./VAvatar-Cvk1WxbL.js";import"./VTooltip-CW1A7yk5.js";import"./VSelect-C-wapNZP.js";import"./VTextField-ysk54ulU.js";import"./VList-BApg5e-5.js";import"./ssrBoot-2Bow7jPt.js";import"./VMenu-ClWOyaxD.js";import"./VCheckboxBtn-En8MsP0g.js";import"./VSelectionControl-8oBIIGF9.js";import"./VChip-v8J03T6R.js";import"./sweetalert2.esm.all-DOYwHpwi.js";import"./index-0F-JFElI.js";const ge=D("b",{class:"text-warning"},"*",-1),ve={class:"demo-space-x"},ye={class:"demo-space-x"},Ve={class:"demo-space-x"},aa=le({__name:"Index",setup(be){const z=te(),{toast:A}=ue(),s=se({form:!1,download_notes:!1,block_uploading_of_grades_to_teachers:!1,viewing_notes:!1}),v=m({company_id:null,type_education_id:null,archive:null}),P=m({}),T=m(),Q=m(),k=m([]),w=m(me());w.value.allowedExtensions=["xls","xlsx"];const h=m(!1),F=m({});ie(async()=>{var n;await x(),s.form=!0;const{data:l,response:t}=await p("note-dataForm").get();(n=t.value)!=null&&n.ok&&l.value&&(k.value=l.value.typeEducations,h.value=l.value.blockData),s.form=!1});const x=async()=>{var n;const{data:l,response:t}=await p("/type_educations/visualization/show").get();(n=t.value)!=null&&n.ok&&l.value&&(F.value=l.value.selectedNotes)},E=async()=>{var t;v.value.archive=w.value.imageFile,v.value.company_id=z.company.id;const l=await((t=T.value)==null?void 0:t.validate());if(l!=null&&l.valid){const n=new FormData;for(const d in v.value)n.append(d,v.value[d]);s.form=!0,await p("note-store").post(n),s.form=!1}else A("Faltan Campos Por Diligenciar","","danger")},N=m({type_education_id:null}),G=async()=>{var t,n;const l=await((t=Q.value)==null?void 0:t.validate());if(l!=null&&l.valid){s.download_notes=!0;const d=k.value.find(C=>C.value==N.value.type_education_id),{data:q,response:i}=await p(ce("/note-downloadAllConsolidated",{query:{type_education_id:N.value.type_education_id,company_id:z.company.id}}));s.download_notes=!1,(n=i.value)!=null&&n.ok&&q.value&&Y(q.value.excel,"Consolidado "+(d==null?void 0:d.title))}else A("Faltan Campos Por Diligenciar","","danger")},O=async l=>{var d;s.block_uploading_of_grades_to_teachers=!0;const{data:t,response:n}=await p("/note-blockPayrollUpload").post({value:l});(d=n.value)!=null&&d.ok&&t.value,s.block_uploading_of_grades_to_teachers=!1},Z=async l=>{var d;s.block_uploading_of_grades_to_teachers=!0;const{data:t,response:n}=await p("/note-resetOptionDownloadPdf").post({company_id:z.company.id});(d=n.value)!=null&&d.ok&&t.value,s.block_uploading_of_grades_to_teachers=!1},H=ne(()=>h.value?"Sí":"No"),J=async()=>{s.viewing_notes=!0,await p("/type_educations/visualization/store").post({selectedNotes:F.value}),s.viewing_notes=!1},B=m(),K=()=>{B.value.openModal(),B.value.componentData.title="Esta seguro que desea activar a todos los estudiantes en un estado insolventes"};return(l,t)=>{const n=oe,d=ae,q=ee;return r(),M("div",null,[("hasPermission"in l?l.hasPermission:a(y))("note.upload_notes")?(r(),c(b,{key:0,disabled:a(s).form,loading:a(s).form},{default:e(()=>[o(U,{"primary-title":""},{default:e(()=>[f("Cargar Notas")]),_:1}),o(g,null,{default:e(()=>[o(a(R),{ref_key:"formValidation",ref:T,"lazy-validation":""},{default:e(()=>[o(_,null,{default:e(()=>[o(u,{cols:"12",sm:"4"},{default:e(()=>[o(n,{clearable:"",modelValue:a(v).type_education_id,"onUpdate:modelValue":t[0]||(t[0]=i=>a(v).type_education_id=i),rules:["requiredValidator"in l?l.requiredValidator:a($)],"error-messages":a(P).type_education_id,label:"Tipo",onChange:t[1]||(t[1]=i=>a(P).type_education_id=""),requiredField:!0,items:a(k)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),o(u,{cols:"12",sm:"4"},{default:e(()=>[o(fe,null,{default:e(()=>[f("Archivo "),ge]),_:1}),(r(),c(_e,{key:a(w).key,onChange:a(w).handleImageSelected,"onClick:clear":a(w).clearData,rules:["requiredValidator"in l?l.requiredValidator:a($)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),o(_,null,{default:e(()=>[o(u,{cols:"12",class:"d-flex justify-center"},{default:e(()=>[o(S,{loading:a(s).form,disabled:a(s).form,color:"primary",onClick:t[2]||(t[2]=i=>E())},{default:e(()=>[f(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])):V("",!0),("hasPermission"in l?l.hasPermission:a(y))("note.download_notes")?(r(),c(b,{key:1,disabled:a(s).download_notes,loading:a(s).download_notes,class:"mt-3"},{default:e(()=>[o(U,{"primary-title":""},{default:e(()=>[f("Descargar Notas")]),_:1}),o(g,null,{default:e(()=>[o(a(R),{ref_key:"formValidationDownload",ref:Q,"lazy-validation":""},{default:e(()=>[o(_,null,{default:e(()=>[o(u,{cols:"12",sm:"4"},{default:e(()=>[o(n,{clearable:"",modelValue:a(N).type_education_id,"onUpdate:modelValue":t[3]||(t[3]=i=>a(N).type_education_id=i),rules:["requiredValidator"in l?l.requiredValidator:a($)],"error-messages":a(P).type_education_id,label:"Tipo",onChange:t[4]||(t[4]=i=>a(P).type_education_id=""),requiredField:!0,items:a(k)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),o(_,null,{default:e(()=>[o(u,{cols:"12",class:"d-flex justify-center"},{default:e(()=>[o(S,{loading:a(s).download_notes,disabled:a(s).download_notes,color:"primary",onClick:t[5]||(t[5]=i=>G())},{default:e(()=>[f(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])):V("",!0),o(_,null,{default:e(()=>[o(u,{cols:"4"},{default:e(()=>[("hasPermission"in l?l.hasPermission:a(y))("note.block_uploading_of_grades_to_teachers")?(r(),c(b,{key:0,disabled:a(s).block_uploading_of_grades_to_teachers,loading:a(s).block_uploading_of_grades_to_teachers,class:"mt-3"},{default:e(()=>[o(U,{"primary-title":""},{default:e(()=>[f("Bloquear carga de notas a los profesores")]),_:1}),o(g,null,{default:e(()=>[o(_,null,{default:e(()=>[o(u,{cols:"12",sm:"4"},{default:e(()=>[D("div",ve,[o(L,{modelValue:a(h),"onUpdate:modelValue":[t[6]||(t[6]=i=>de(h)?h.value=i:null),t[7]||(t[7]=i=>O(i))],label:a(H),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):V("",!0)]),_:1}),o(u,{cols:"4"},{default:e(()=>[("hasPermission"in l?l.hasPermission:a(y))("note.reset_option_download_pdf")?(r(),c(b,{key:0,disabled:a(s).block_uploading_of_grades_to_teachers,loading:a(s).block_uploading_of_grades_to_teachers,class:"mt-3"},{default:e(()=>[o(U,{"primary-title":""},{default:e(()=>[f("Reiniciar opción descarga pdf y boletin")]),_:1}),o(g,null,{default:e(()=>[o(_,null,{default:e(()=>[o(u,{cols:"12",sm:"4"},{default:e(()=>[D("div",ye,[o(S,{color:"primary",onClick:K},{default:e(()=>[f("Reiniciar")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):V("",!0)]),_:1})]),_:1}),("hasPermission"in l?l.hasPermission:a(y))("note.viewing_notes")?(r(),c(b,{key:2,disabled:a(s).viewing_notes,loading:a(s).viewing_notes,class:"mt-3",title:"Visualización de las notas"},{default:e(()=>[(r(!0),M(j,null,I(a(k),i=>(r(),c(g,{key:i.value},{default:e(()=>[o(pe),o(_,null,{default:e(()=>[o(u,null,{default:e(()=>[D("span",null,re(i.title),1)]),_:2},1024)]),_:2},1024),o(_,null,{default:e(()=>[(r(!0),M(j,null,I(i.cantNotes,(C,W)=>(r(),c(u,{cols:"12",sm:"4",key:W},{default:e(()=>[D("div",Ve,[o(L,{modelValue:a(F)[i.value]["note_"+C],"onUpdate:modelValue":X=>a(F)[i.value]["note_"+C]=X,label:"Nota "+C,color:"success"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128)),o(g,null,{default:e(()=>[o(_,null,{default:e(()=>[o(u,{cols:"12",class:"d-flex justify-center"},{default:e(()=>[o(S,{loading:a(s).form,disabled:a(s).form,color:"primary",onClick:t[8]||(t[8]=i=>J())},{default:e(()=>[f(" Guardar Visualización ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):V("",!0),("hasPermission"in l?l.hasPermission:a(y))("note.bulk_file_upload")?(r(),c(b,{key:3,title:"Carga de archivos masivos",class:"mt-3"},{default:e(()=>[o(g,null,{default:e(()=>[o(d)]),_:1})]),_:1})):V("",!0),o(q,{ref_key:"refModalQuestion",ref:B,onSuccess:Z},null,512)])}}});export{aa as default};
