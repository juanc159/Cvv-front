import{V as $,r as g,e as U}from"./VForm-5573d812.js";import{_ as B}from"./AppTextField.vue_vue_type_script_setup_true_lang-cfc48e9f.js";import{d as S,j as N,r as m,a0 as T,$ as A,w as I,E as K,o as y,c as D,b as o,f as l,n as e,t as F,g as E,a9 as P,e as R,aw as j,ax as x}from"./index-9d7b2ae2.js";import{u as z}from"./useImageUpload-79738341.js";import{u as G}from"./useCrudUserStore-ef04c3fc.js";import{V as H}from"./VCardText-750086f9.js";import{V as w}from"./VRow-b2ea4d07.js";import{V as d}from"./VCol-ab44c4c7.js";import{V as L}from"./VField-69296a2c.js";import{V as M}from"./VFileInput-3a642961.js";import{V as J}from"./VImg-191ee63c.js";import{V as O}from"./VCard-76b23484.js";import"./helpers-3edea678.js";import"./VTextField-43cf00db.js";import"./sweetalert2.all-ae952bba.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VChip-4c9bcae3.js";import"./VAvatar-2ebb0d40.js";const Q=R("b",{class:"text-warning"},"*",-1),ce=S({__name:"Form",setup(W){const b=N(),{toast:C}=x(),v=m();T();const p=G(),{form:i,loading:k}=A(p),n=m({}),u=m(z()),f=m(!1),V=m([]),q=r=>{u.value.handleImageSelected(r)},_=async()=>{var a,c;const r=await((a=v.value)==null?void 0:a.validate());if(r!=null&&r.valid){u.value.imageFile&&(i.value.photo=u.value.imageFile);const t=await p.fetchSave();(t==null?void 0:t.code)===200&&(V.value=[],n.value={},u.value.clearData(),await((c=v.value)==null?void 0:c.resetValidation())),(t==null?void 0:t.code)===422&&(n.value=t.errors??{})}else C("Faltan Campos Por Diligenciar","","danger")};return I(i,(r,a)=>{r.id?V.value.password=[]:V.value.password=[g(r.password)]},{deep:!0}),K(async()=>{p.clearForm(),await p.fetchDataForm(Number(b.params.id),b.params.action)}),(r,a)=>{const c=j,t=B;return y(),D("div",null,[o(O,null,{default:l(()=>[o(H,null,{default:l(()=>[o(w,null,{default:l(()=>[o(d,null,{default:l(()=>[o(c,{"sub-title":"form de usuario",action:String(r.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:r.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),o(e($),{ref_key:"formValidation",ref:v,"lazy-validation":""},{default:l(()=>[o(w,null,{default:l(()=>[o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).email,"onUpdate:modelValue":a[0]||(a[0]=s=>e(i).email=s),rules:["requiredValidator"in r?r.requiredValidator:e(g),"emailValidator"in r?r.emailValidator:e(U)],autocomplete:"off","error-messages":e(n).email,label:"Email",onKeypress:a[1]||(a[1]=s=>e(n).email=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).password,"onUpdate:modelValue":a[2]||(a[2]=s=>e(i).password=s),rules:e(V).password,autocomplete:"off",type:e(f)?"text":"password","append-icon":e(f)?"mdi-eye":"mdi-eye-off","error-messages":e(n).password,label:"Contraseña","onClick:append":a[3]||(a[3]=s=>f.value=!e(f)),onKeypress:a[4]||(a[4]=s=>e(n).password=""),requiredField:!0},null,8,["modelValue","rules","type","append-icon","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).name,"onUpdate:modelValue":a[5]||(a[5]=s=>e(i).name=s),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(n).name,label:"Nombre",onKeypress:a[6]||(a[6]=s=>e(n).name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).last_name,"onUpdate:modelValue":a[7]||(a[7]=s=>e(i).last_name=s),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(n).last_name,label:"Apellido",onKeypress:a[8]||(a[8]=s=>e(n).last_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(L,null,{default:l(()=>[F("Foto  "),Q]),_:1}),(y(),E(M,{key:e(u).key,"show-size":"",counter:"",accept:"image/*",onChange:a[9]||(a[9]=s=>q(s))}))]),_:1}),o(d,{cols:"12"},{default:l(()=>[o(J,{contain:"",src:e(u).imageUrl??e(i).photo,alt:"foto Personal","max-width":200,class:"mx-auto img-fluid"},null,8,["src"])]),_:1})]),_:1}),o(w,null,{default:l(()=>[o(d,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[o(P,{loading:e(k).form,color:"primary",onClick:_},{default:l(()=>[F(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{ce as default};
