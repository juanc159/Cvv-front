import{r as V}from"./validators-BTNGeBcZ.js";import{s as se}from"./helpers-DpoOu2Gd.js";import{d as Z,r as c,M as h,w as ee,g as L,o as B,bY as ne,f as r,p as ue,k as e,e as N,b as l,c as P,x as D,cn as de,ad as E,a8 as X,z as me,H as ce,n as pe,j as fe,U as ve,q as ye,ax as Ve,X as Y,ac as ge,C as j,D as _e,al as be,ay as ke,af as A}from"./index-v62QzUgb.js";import{_ as qe}from"./BtnBack.vue_vue_type_script_setup_true_lang-CMpSseyh.js";import{_ as Fe}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-COmH2cOC.js";import{_ as Ie}from"./AppTextField.vue_vue_type_script_setup_true_lang-DRTqQ6nI.js";import{_ as we}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-iqST8u9E.js";import{_ as te}from"./AppSelect.vue_vue_type_script_setup_true_lang-s_uNeCP7.js";import{V as $e}from"./VTextField-CUXRldaw.js";import{V as x}from"./VDivider-Bp9v2kOl.js";import{V as M,a as p}from"./VRow-DCZrpGKb.js";import{u as K}from"./useAxios-Dv_cXzGe.js";import{u as Ce,V as Se}from"./VFileInput-F5wTjha6.js";import{b as Ue,V as Be}from"./VCard-EX7YkvuV.js";import{V as W}from"./VCardText-BzwaDpth.js";import{V as Ne}from"./VForm-Bug1t0fD.js";import{V as Te}from"./VCheckbox-CcWkNeP-.js";import{V as ze}from"./VImg-urEA1vUl.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-D5gImS8-.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-Ds0pD_mZ.js";import"./VDialog-dfjmgiZz.js";import"./VOverlay-CNAFiuqO.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-CE-yxmch.js";import"./VInput-vaB9dEM4.js";import"./VTooltip-BI0famzk.js";import"./VSelect-BA34Ef73.js";import"./VList-D3EVGFbt.js";import"./ssrBoot-D9UInlug.js";import"./VAvatar-BbJ_odT7.js";import"./VMenu-C8h0fx02.js";import"./VCheckboxBtn-MQw1sH32.js";import"./VSelectionControl-Dq43D-f5.js";import"./VChip-D1O8EWip.js";import"./filter-BUYh4k1X.js";/* empty css                   */import"./VCounter-CFO2jdF3.js";/* empty css              */import"./sweetalert2.esm.all-DV3w3JmD.js";const je={key:0,class:"text-center"},Ae={key:1,class:"d-flex justify-content-between aling-items-center p-2"},Le=Z({__name:"SelectInfinite",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},select:{type:Object,default:()=>({})},multiple:{type:Boolean,default:()=>!1}},emits:["clearVmodel"],setup(f,{emit:I}){const{items:S,loading:d,select:v}=f,g=I,m=c(!1);h(()=>{v.totalLinks.value>1&&(m.value=!0)});const n=()=>{g("clearVmodel",!0),v.next()},_=()=>{g("clearVmodel",!0),v.prev()};return ee(v.dataNueva,()=>{m.value==!1&&v.totalLinks.value>1&&(m.value=!0)}),(w,b)=>{const a=te;return B(),L(a,me(w.$attrs,{items:f.select.dataNueva.value,multiple:f.multiple}),ne({_:2},[e(m)?{name:"prepend-item",fn:r(()=>[N("div",null,[l($e,{clearable:"",placeholder:"Buscar...	",class:"mb-2",modelValue:f.select.searchQueryInfinite.value,"onUpdate:modelValue":b[0]||(b[0]=k=>f.select.searchQueryInfinite.value=k)},null,8,["modelValue"]),l(x)])]),key:"0"}:void 0,e(m)?{name:"append-item",fn:r(()=>[N("div",null,[l(x),f.loading?(B(),P("div",je,[l(de,{size:"24",color:"primary",indeterminate:""})])):D("",!0),f.loading?D("",!0):(B(),P("div",Ae,[l(M,null,{default:r(()=>[l(p,{sm:"6",class:"text-left"},{default:r(()=>[l(E,{class:"mt-2 ml-5",disabled:f.select.page.value<=1,onClick:b[1]||(b[1]=k=>_()),color:"primary",icon:""},{default:r(()=>[l(X,{icon:"tabler-chevron-left"})]),_:1},8,["disabled"])]),_:1}),l(p,{sm:"6",class:"text-right"},{default:r(()=>[l(E,{class:"mt-2 mr-5",disabled:f.select.page.value>=f.select.totalLinks.value,onClick:b[2]||(b[2]=k=>n()),color:"primary",icon:""},{default:r(()=>[l(X,{icon:"tabler-chevron-right"})]),_:1},8,["disabled"])]),_:1})]),_:1})]))])]),key:"1"}:void 0,ue(w.$slots,(k,q)=>({name:q,fn:r(F=>[ce(w.$slots,q,pe(fe(F||{})))])}))]),1040,["items","multiple"])}}});function Pe(f,I=[],S=0,d={}){const v=c(""),g=c([]),m=c(1),n=c(1),_=c({}),w=async()=>{m.value--,m.value<=1&&(m.value=1),await a()},b=async()=>{m.value++,m.value>n.value&&(m.value=n.value),await a()},a=async()=>{let q={page:m.value,searchQueryInfinite:v.value};for(const F in d)q[F]=d[F];for(const F in _.value)q[F]=_[F];await f(q),g.value=[],g.value.push(...I.value)};let k=null;return ee(v,async(q,F)=>{k&&clearTimeout(k),m.value=1;let $={page:m.value,searchQueryInfinite:q};for(const y in d)$[y]=d[y];for(const y in _.value)$[y]=_[y];k=setTimeout(async()=>{await f($),g.value=[],I&&I.value!==void 0&&g.value.push(...I.value),S&&S.value!==void 0&&(n.value=S.value)},300)}),{searchQueryInfinite:v,dataNueva:g,page:m,filterInterno:_,next:b,prev:w,search:a,totalLinks:n}}const De=N("span",null," Formulario estudiante ",-1),Ee=N("b",{class:"text-warning"},"*",-1),Me={style:{"block-size":"200px","inline-size":"200px"}},St=Z({__name:"Form",setup(f){const I=ve(),{toast:S}=ke(),d=c({}),v=c(!1),g=ye(),m=c(),n=Ve({form:!1,countries:!1,states:!1,cities:!1}),_=c([]),w=c([]),b=c([]),a=c({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null,nationalized:null}),k=()=>{for(const i in a.value)a.value[i]=null},q=async()=>{a.value.id=g.params.id||null;const i=a.value.id?`/student/${a.value.id}/edit`:"/student/create";n.form=!0;const{response:t,data:u}=await K(i).get();if(n.form=!1,t.status==200&&u&&(z.dataNueva.value=u.countries_arrayInfo,z.totalLinks.value=u.countries_countLinks,_.value=u.typeEducations,w.value=u.sections,b.value=u.typeDocuments,u.form)){a.value=u.form;const s=JSON.parse(JSON.stringify(u.form));u.form.id&&s.country_id&&s.state_id&&(await J(s.country_id),await H(s.state_id),a.value.country_id=s.country_id,a.value.state_id=s.state_id,a.value.city_id=s.city_id)}},F=async()=>{var t;const i=await((t=m.value)==null?void 0:t.validate());if(i!=null&&i.valid){a.value.company_id=I.company.id;const u=a.value.id?`/student/update/${a.value.id}`:"/student/store",s=new FormData;for(const U in a.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(U)||s.append(U,a.value[U]);s.append("country_id",a.value.country_id.value),s.append("state_id",a.value.state_id),s.append("city_id",a.value.city_id),s.append("gender",a.value.gender),s.append("birthday",a.value.birthday),n.form=!0;const{data:C,response:T}=await K(u).post(s);n.form=!1,T.status==200&&C&&C.code==200&&be.push({name:"Student-List"}),C.code===422&&(d.value=C.errors??{})}else S("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(v.value=!0),h(async()=>{k(),await q()});const $=Y(()=>Object.values(n).some(i=>i)),y=c(Ce()),ae=["jpg","jpeg","png"];y.value.allowedExtensions=ae;const le=i=>{n.form=!0,y.value.handleImageSelected(i),setTimeout(()=>{a.value.photo=y.value.imageFile,n.form=!1},1e3)},ie=Y(()=>a.value.type_education_id?_.value.find(i=>i.value==a.value.type_education_id).grades:[]),Q=c([]),O=c([]),R=c([]),G=c(1),z=Pe(async i=>{var s;n.countries=!0;const{data:t,response:u}=await A("/selectInfiniteCountries").post(i);n.countries=!1,(s=u.value)!=null&&s.ok&&t.value&&(R.value=t.value.countries_arrayInfo,G.value=t.value.countries_countLinks)},R,G,{}),J=async i=>{var s;a.value.state_id=null,a.value.city_id=null,n.states=!0;const{data:t,response:u}=await A(`/selectStates/${i.value}`).get();n.states=!1,(s=u.value)!=null&&s.ok&&t.value&&(Q.value=t.value.states)},H=async i=>{var s;a.value.city_id=null,n.cities=!0;const{data:t,response:u}=await A(`/selectCities/${i}`).get();n.cities=!1,(s=u.value)!=null&&s.ok&&t.value&&(O.value=t.value.cities)},oe=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(i,t)=>{const u=te,s=Le,C=we,T=Ie,U=Fe,re=qe;return B(),P("div",null,[l(Be,{disabled:e(n).form,loading:e(n).form},{default:r(()=>[l(Ue,{class:"d-flex justify-space-between"},{default:r(()=>[De]),_:1}),l(W,null,{default:r(()=>[l(Ne,{ref_key:"formValidation",ref:m,onSubmit:ge(()=>{},["prevent"]),disabled:e(v)},{default:r(()=>[l(M,null,{default:r(()=>[l(p,{cols:"12",sm:"4"},{default:r(()=>[l(u,{items:e(_),clearable:"",requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(a).type_education_id,"onUpdate:modelValue":t[0]||(t[0]=o=>e(a).type_education_id=o),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),l(p,{cols:"12",sm:"4"},{default:r(()=>[l(u,{clearable:"",items:e(ie),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(a).grade_id,"onUpdate:modelValue":t[1]||(t[1]=o=>e(a).grade_id=o),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),l(p,{cols:"12",sm:"4"},{default:r(()=>[l(u,{clearable:"",items:e(w),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(a).section_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e(a).section_id=o),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),l(p,{cols:"12",md:"3"},{default:r(()=>[l(s,{requiredField:!0,label:"País",returnObject:"",modelValue:e(a).country_id,"onUpdate:modelValue":[t[3]||(t[3]=o=>e(a).country_id=o),t[4]||(t[4]=o=>J(o))],select:e(z),"error-messages":e(d).country_id,onInput:t[5]||(t[5]=o=>e(d).country_id=""),clearable:"",loading:e(n).countries,rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),l(p,{cols:"12",md:"3"},{default:r(()=>[l(C,{loading:e(n).states,requiredField:!0,clearable:"",items:e(Q),modelValue:e(a).state_id,"onUpdate:modelValue":[t[6]||(t[6]=o=>e(a).state_id=o),t[7]||(t[7]=o=>H(o))],label:"Estado","error-messages":e(d).state_id,onInput:t[8]||(t[8]=o=>e(d).state_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),l(p,{cols:"12",md:"4"},{default:r(()=>[l(C,{loading:e(n).cities,requiredField:!0,clearable:"",items:e(O),modelValue:e(a).city_id,"onUpdate:modelValue":t[9]||(t[9]=o=>e(a).city_id=o),label:"Municipio","error-messages":e(d).city_id,onInput:t[10]||(t[10]=o=>e(d).city_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),l(p,{cols:"12",md:"2"},{default:r(()=>[l(Te,{modelValue:e(a).nationalized,"onUpdate:modelValue":t[11]||(t[11]=o=>e(a).nationalized=o),label:"Nacionalizado","true-value":!0,"false-value":!1},{label:r(()=>[j(" Nacionalizado: "+_e(e(a).nationalized?"Sí":"No"),1)]),_:1},8,["modelValue"])]),_:1}),l(p,{cols:"12",sm:"3"},{default:r(()=>[l(u,{clearable:"",items:e(b),rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(a).type_document_id,"onUpdate:modelValue":t[12]||(t[12]=o=>e(a).type_document_id=o),label:"Tipo de documento"},null,8,["items","rules","modelValue"])]),_:1}),l(p,{cols:"12",sm:"3"},{default:r(()=>[l(T,{clearable:"",modelValue:e(a).identity_document,"onUpdate:modelValue":t[13]||(t[13]=o=>e(a).identity_document=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).identity_document,label:"Documento",onInput:t[14]||(t[14]=o=>e(d).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),l(p,{cols:"12",sm:"6"},{default:r(()=>[l(T,{clearable:"",modelValue:e(a).full_name,"onUpdate:modelValue":t[15]||(t[15]=o=>e(a).full_name=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).full_name,label:"Nombre completo",onInput:t[16]||(t[16]=o=>e(d).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),l(p,{cols:"12",sm:"3"},{default:r(()=>[l(u,{clearable:"",modelValue:e(a).gender,"onUpdate:modelValue":t[17]||(t[17]=o=>e(a).gender=o),items:oe,rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).gender,label:"Sexo",onInput:t[18]||(t[18]=o=>e(d).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),l(p,{cols:"12",sm:"3"},{default:r(()=>[l(U,{clearable:"",modelValue:e(a).birthday,"onUpdate:modelValue":t[19]||(t[19]=o=>e(a).birthday=o),label:"Fecha de nacimiento",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).birthday,onInput:t[20]||(t[20]=o=>e(d).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),l(p,{cols:"12",sm:"3"},{default:r(()=>[l(U,{clearable:"",modelValue:e(a).real_entry_date,"onUpdate:modelValue":t[21]||(t[21]=o=>e(a).real_entry_date=o),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).real_entry_date,onInput:t[22]||(t[22]=o=>e(d).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),l(p,{cols:"12",sm:"3"},{default:r(()=>[(B(),L(Se,{accept:"image/*",key:e(y).key,onChange:t[23]||(t[23]=o=>le(o)),"onClick:clear":e(y).clearData},{label:r(()=>[j(" Foto "),Ee]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),l(M,null,{default:r(()=>[l(p,{cols:"12",class:"d-flex justify-center"},{default:r(()=>[N("div",Me,[l(ze,{src:e(y).imageUrl??("storageBack"in i?i.storageBack:e(se))(e(a).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),l(W,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:r(()=>[l(re,{disabled:e($),loading:e($)},null,8,["disabled","loading"]),e(v)?D("",!0):(B(),L(E,{key:0,disabled:e($),loading:e($),onClick:t[24]||(t[24]=o=>F()),color:"primary"},{default:r(()=>[j(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{St as default};
