import{s as j}from"./helpers-k4gBJwIF.js";import{d as F,U as P,r as S,aa as q,N as G,h as i,o,f as a,b as t,c as d,y as m,D as r,E as _,l as n,a9 as y,a7 as f,F as x,q as z,e as p,G as Z,af as V,ac as C,aI as H,b6 as J,Z as K,$ as O}from"./index-C9b6hrcK.js";import{u as Q}from"./useNotificationStore-B0Mda58C.js";import{V as W,a as X}from"./VRow-ZGlPE998.js";import{V as Y,c as aa,a as ea,d as ta}from"./VCard-e9jpbFqx.js";import{V as w}from"./VSkeletonLoader-j5ZQdz4i.js";import{V as sa,a as oa,b as la,d as A}from"./VList-MUuu6vN0.js";import{V as ia}from"./VDivider-DvYWI5ti.js";import{V as ra}from"./VChip-DuawQfnX.js";import{V as B}from"./VAvatar-CaIuQVp3.js";import{V as na}from"./VImg-MODgQ4GY.js";import{V as ca}from"./VContainer-DeFtrRug.js";import{_ as da}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-30sb_wC2.js";/* empty css              */import"./VCardText-CxJltrbS.js";import"./ssrBoot-DxvvqgRH.js";const L=h=>(K("data-v-1ce58392"),h=h(),O(),h),pa={key:0,class:"pa-4"},fa={class:"w-100"},ua={key:0,class:"me-3 d-flex align-center justify-center",style:{width:"40px",height:"40px"}},ma={class:"d-flex flex-column align-end gap-2"},_a={class:"text-caption text-disabled"},ya={class:"actions"},ha={key:1,class:"text-center pa-10"},ka=L(()=>p("h3",{class:"text-h6"},"No hay notificaciones",-1)),va=L(()=>p("p",{class:"text-disabled"},"Estás al día con todo.",-1)),ba={key:2,class:"text-center mt-4"},ga=F({__name:"Index",setup(h){const{toast:T}=J(),c=Q(),{notifications:u,unreadCount:I,nextPageUrl:b}=P(c),k=S(!1),v=S(!1),l=q(new Set);G(async()=>{if(u.value.length===0){k.value=!0;try{await c.fetchNotifications()}finally{k.value=!1}}});const N=async s=>{l.add(s);try{await c.markAsRead([s])}finally{l.delete(s)}},M=async s=>{l.add(s);try{await c.markAsUnread([s])}finally{l.delete(s)}},R=async s=>{l.add(s);try{await c.remove(s),T("Notificación eliminada","","success")}finally{l.delete(s)}},$=async()=>{v.value=!0;try{await c.markAllRead()}finally{v.value=!1}},E=async()=>{b.value&&await c.fetchNotifications(b.value)},U=s=>{s.isSeen||N(s.id),s.action_url&&(s.openInNewTab?window.open(s.action_url,"_blank"):window.location.href=s.action_url)};return(s,xa)=>(o(),i(ca,null,{default:a(()=>[t(W,{justify:"center"},{default:a(()=>[t(X,{cols:"12",md:"10",lg:"8"},{default:a(()=>[t(Y,{class:"pb-4"},{default:a(()=>[t(aa,{class:"border-b mb-2 py-4"},{prepend:a(()=>[t(f,{icon:"tabler-bell",size:"32",class:"me-2 text-primary"})]),append:a(()=>[n(I)>0?(o(),i(y,{key:0,variant:"tonal",color:"primary",size:"small","prepend-icon":"tabler-mail-opened",loading:v.value,onClick:$},{default:a(()=>[r(" Marcar todo como leído ")]),_:1},8,["loading"])):m("",!0)]),default:a(()=>[t(ea,{class:"text-h5"},{default:a(()=>[r("Centro de Notificaciones")]),_:1}),t(ta,null,{default:a(()=>[r(" Tienes "+_(n(I))+" notificación(es) sin leer ",1)]),_:1})]),_:1}),k.value&&n(u).length===0?(o(),d("div",pa,[(o(),d(x,null,z(3,e=>p("div",{key:e,class:"d-flex align-center gap-3 mb-4"},[t(w,{type:"avatar"}),p("div",fa,[t(w,{type:"text",class:"mb-1",width:"60%"}),t(w,{type:"text",width:"40%"})])])),64))])):(o(),i(sa,{key:1,lines:"two",class:"pa-0"},{default:a(()=>[n(u).length>0?(o(!0),d(x,{key:0},z(n(u),(e,D)=>(o(),d(x,{key:e.id},[D>0?(o(),i(ia,{key:0})):m("",!0),t(oa,{class:Z([{"bg-var-theme-background":!e.isSeen},"py-3 px-4 notification-item"]),disabled:l.has(e.id)||v.value,onClick:g=>U(e)},{prepend:a(()=>[l.has(e.id)?(o(),d("div",ua,[t(H,{indeterminate:"",color:"primary",size:"24"})])):(o(),i(B,{key:1,color:e.color||"primary",variant:"tonal",size:"40",class:"me-3"},{default:a(()=>[e.img?(o(),i(na,{key:0,src:("storageBack"in s?s.storageBack:n(j))(e.img)},null,8,["src"])):(o(),i(f,{key:1,icon:e.icon||"tabler-bell"},null,8,["icon"]))]),_:2},1032,["color"]))]),append:a(()=>[p("div",ma,[p("span",_a,_(e.time),1),p("div",ya,[e.isSeen?(o(),i(y,{key:1,icon:"",variant:"text",color:"medium-emphasis",size:"small",disabled:l.has(e.id),onClick:V(g=>M(e.id),["stop"])},{default:a(()=>[t(f,{icon:"tabler-circle"}),t(C,{activator:"parent",location:"top"},{default:a(()=>[r(" Marcar como no leída ")]),_:1})]),_:2},1032,["disabled","onClick"])):(o(),i(y,{key:0,icon:"",variant:"text",color:"primary",size:"small",disabled:l.has(e.id),onClick:V(g=>N(e.id),["stop"])},{default:a(()=>[t(f,{icon:"tabler-circle-check"}),t(C,{activator:"parent",location:"top"},{default:a(()=>[r(" Marcar como leída ")]),_:1})]),_:2},1032,["disabled","onClick"])),t(y,{icon:"",variant:"text",color:"error",size:"small",disabled:l.has(e.id),onClick:V(g=>R(e.id),["stop"])},{default:a(()=>[t(f,{icon:"tabler-trash"}),t(C,{activator:"parent",location:"top"},{default:a(()=>[r(" Eliminar ")]),_:1})]),_:2},1032,["disabled","onClick"])])])]),default:a(()=>[t(la,{class:"font-weight-bold mb-1"},{default:a(()=>[r(_(e.title)+" ",1),e.isSeen?m("",!0):(o(),i(ra,{key:0,size:"x-small",color:"error",class:"ms-2",label:""},{default:a(()=>[r("Nueva")]),_:1}))]),_:2},1024),t(A,{class:"text-body-2 text-high-emphasis mb-1"},{default:a(()=>[r(_(e.subtitle),1)]),_:2},1024),e.text?(o(),i(A,{key:0,class:"text-caption"},{default:a(()=>[r(_(e.text),1)]),_:2},1024)):m("",!0)]),_:2},1032,["class","disabled","onClick"])],64))),128)):(o(),d("div",ha,[t(B,{color:"surface-variant",size:"80",class:"mb-4"},{default:a(()=>[t(f,{icon:"tabler-bell-off",size:"40"})]),_:1}),ka,va]))]),_:1})),n(b)?(o(),d("div",ba,[t(y,{variant:"text",loading:k.value&&n(u).length>0,onClick:E},{default:a(()=>[r(" Cargar notificaciones antiguas ")]),_:1},8,["loading"])])):m("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),ja=da(ga,[["__scopeId","data-v-1ce58392"]]);export{ja as default};
