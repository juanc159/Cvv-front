import{_ as Ve}from"./BtnBack.vue_vue_type_script_setup_true_lang-LvM9IGc6.js";import{_ as Pe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-Bw7Anc8o.js";import{_ as he}from"./AppSelectRemote-DB_wyvbL.js";import{_ as ke}from"./AppTextField.vue_vue_type_script_setup_true_lang-tPb9GRlz.js";import{_ as Ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-K6gbidqT.js";import{ae as O,af as z,a2 as ue,cL as Se,aq as Y,b as a,bU as Ce,cM as Ie,aX as le,Q as de,R as Ae,bN as Te,aZ as re,Y as V,bA as we,aE as ce,a7 as $e,b3 as ie,co as Fe,bl as Re,al as je,aO as ve,av as Be,cp as Ne,br as De,a0 as Ue,cj as Le,aj as qe,bp as Ge,aK as b,at as Me,cN as Oe,cm as ze,d as Ye,V as Ze,t as Ke,r as $,b5 as Qe,N as Xe,c as k,o as m,f as s,ac as He,h as q,y as R,F as G,q as M,D as H,E as x,a9 as J,e as f,l as Je,G as We,aT as ea,b7 as aa,aY as la,aS as ta,Z as na,$ as sa}from"./index-CtOr4Wu7.js";import{c as oa}from"./createUrl-D9sypOAs.js";import{a as ia,V as ua}from"./VCard-COZucsTL.js";import{V as W}from"./VCardText-v8gCKQRH.js";import{V as da}from"./VForm-BhvUgRDX.js";import{V as j,a as E}from"./VRow-C1C7EzPn.js";import{V as ra}from"./VTable-ClsD0PQ0.js";import{_ as ca}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-B9CXAvdJ.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-6vZWU1pl.js";import"./VDialog-CybUf8DC.js";import"./dialog-transition-dwJwLnHT.js";import"./VSelect-BZZhkYMh.js";import"./VTextField-B5WBRC1t.js";/* empty css                   */import"./VCounter-DANGpuYg.js";import"./VImg-Ctxsnw81.js";import"./VList-BoAmY9IJ.js";import"./ssrBoot-CB8iZIPO.js";import"./VAvatar-e7AxYF9T.js";import"./VDivider-Du-RozYy.js";import"./VMenu-D4hRRJEr.js";import"./VCheckboxBtn-Cah7cXyy.js";import"./VSelectionControl-Uad4iysT.js";import"./VChip-X8cnhpwt.js";import"./filter-RDRewW1g.js";import"./helpers-BPprKBaR.js";import"./constants-2GBt7OCP.js";import"./index-0F-JFElI.js";/* empty css              */const B=Symbol.for("vuetify:v-expansion-panel"),me=z({...le(),...Ie()},"VExpansionPanelText"),ee=O()({name:"VExpansionPanelText",props:me(),setup(e,y){let{slots:o}=y;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:r}=Se(e,n.isSelected);return Y(()=>a(Ce,{onAfterLeave:r},{default:()=>{var _;return[de(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&u.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(_=o.default)==null?void 0:_.call(o)])]),[[Ae,n.isSelected.value]])]}})),{}}}),pe=z({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...le()},"VExpansionPanelTitle"),ae=O()({name:"VExpansionPanelTitle",directives:{Ripple:Te},props:pe(),setup(e,y){let{slots:o}=y;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"color"),_=V(()=>({collapseIcon:e.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),v=V(()=>n.isSelected.value?e.collapseIcon:e.expandIcon);return Y(()=>{var S;return de(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[r.value,e.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:e.readonly?void 0:n.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(S=o.default)==null?void 0:S.call(o,_.value),!e.hideActions&&a(ce,{defaults:{VIcon:{icon:v.value}}},{default:()=>{var P;return[a("span",{class:"v-expansion-panel-title__icon"},[((P=o.actions)==null?void 0:P.call(o,_.value))??a($e,null,null)])]}})]),[[we("ripple"),e.ripple]])}),{}}}),fe=z({title:String,text:String,bgColor:String,...De(),...Ne(),...Be(),...ve(),...pe(),...me()},"VExpansionPanel"),va=O()({name:"VExpansionPanel",props:fe(),emits:{"group:selected":e=>!0},setup(e,y){let{slots:o}=y;const n=Fe(e,B),{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"bgColor"),{elevationClasses:_}=Re(e),{roundedClasses:v}=je(e),S=V(()=>(n==null?void 0:n.disabled.value)||e.disabled),P=V(()=>n.group.items.value.reduce((h,p,F)=>(n.group.selected.value.includes(p.id)&&h.push(F),h),[])),t=V(()=>{const h=n.group.items.value.findIndex(p=>p.id===n.id);return!n.isSelected.value&&P.value.some(p=>p-h===1)}),K=V(()=>{const h=n.group.items.value.findIndex(p=>p.id===n.id);return!n.isSelected.value&&P.value.some(p=>p-h===-1)});return Ue(B,n),Y(()=>{const h=!!(o.text||e.text),p=!!(o.title||e.title),F=ae.filterProps(e),N=ee.filterProps(e);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":t.value,"v-expansion-panel--after-active":K.value,"v-expansion-panel--disabled":S.value},v.value,u.value,e.class],style:[r.value,e.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",..._.value]},null),a(ce,{defaults:{VExpansionPanelTitle:{...F},VExpansionPanelText:{...N}}},{default:()=>{var A;return[p&&a(ae,{key:"title"},{default:()=>[o.title?o.title():e.title]}),h&&a(ee,{key:"text"},{default:()=>[o.text?o.text():e.text]}),(A=o.default)==null?void 0:A.call(o)]}})]})}),{groupItem:n}}}),ma=["default","accordion","inset","popout"],pa=z({flat:Boolean,...ze(),...Oe(fe(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...Me(),...le(),...ve(),variant:{type:String,default:"default",validator:e=>ma.includes(e)}},"VExpansionPanels"),fa=O()({name:"VExpansionPanels",props:pa(),emits:{"update:modelValue":e=>!0},setup(e,y){let{slots:o}=y;const{next:n,prev:u}=Le(e,B),{themeClasses:r}=qe(e),_=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Ge({VExpansionPanel:{bgColor:b(e,"bgColor"),collapseIcon:b(e,"collapseIcon"),color:b(e,"color"),eager:b(e,"eager"),elevation:b(e,"elevation"),expandIcon:b(e,"expandIcon"),focusable:b(e,"focusable"),hideActions:b(e,"hideActions"),readonly:b(e,"readonly"),ripple:b(e,"ripple"),rounded:b(e,"rounded"),static:b(e,"static")}}),Y(()=>a(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,_.value,e.class],style:e.style},{default:()=>{var v;return[(v=o.default)==null?void 0:v.call(o,{prev:u,next:n})]}})),{next:n,prev:u}}}),Z=e=>(na("data-v-488abbe7"),e=e(),sa(),e),_a=Z(()=>f("span",null," Formulario periodo escolar ",-1)),ga={key:0,class:"error--text"},ba={class:"text-center"},xa={class:"text-center"},ya=Z(()=>f("p",{class:"text-center"}," Reporte de materia pendiente. ",-1)),Va=Z(()=>f("th",null,"No.",-1)),Pa=Z(()=>f("th",null,"ALUMNO",-1)),ha={key:0},ka=["colspan"],Ea=Ye({__name:"Form",setup(e){const y=Ze(),o=Ke(),{toast:n}=ta(),u=$({}),r=$(!1),_=$(),v=Qe({form:!1}),S=$([]),P=$([]),t=$({id:null,term_id:null,type_education_id:null,grade_id:null,code:null,students:[]}),K=()=>{t.value={id:null,term_id:null,type_education_id:null,grade_id:null,students:[]}},h=async()=>{var T;t.value.id=o.params.id;const i=t.value.id?`/pendingRegistration/${t.value.id}/edit`:"/pendingRegistration/create";v.form=!0;const{data:l,response:C}=await ea(oa(`${i}`,{query:{company_id:y.company.id}}));v.form=!1,(T=C.value)!=null&&T.ok&&l.value&&(l.value.form&&(t.value={id:l.value.form.id||null,term_id:l.value.form.term_id||null,code:l.value.form.code||null,type_education_id:l.value.form.type_education_id||null,grade_id:l.value.form.grade_id||null,students:l.value.form.students||[]}),l.value.terms&&(S.value=l.value.terms),l.value.typeEducations&&(P.value=l.value.typeEducations))},p=()=>{t.value.students.push({student_id:null,subjects:[]})},F=i=>{t.value.students.splice(i,1)},N=async()=>{var l;const i=await((l=_.value)==null?void 0:l.validate());if(i!=null&&i.valid){const C={...t.value,company_id:y.company.id,students:t.value.students.map(U=>({student_id:U.student_id,subjects:U.subjects}))},T=t.value.id?`/pendingRegistration/update/${t.value.id}`:"/pendingRegistration/store";v.form=!0;const{data:w,response:X}=await aa(T).post(C);v.form=!1,X.status==200&&w&&w.code===200&&la.push({name:"PendingRegistration-List"}),w.code===422&&(u.value=w.errors??{})}else n("Faltan campos por diligenciar","","danger")};o.params.action==="view"&&(r.value=!0),Xe(async()=>{K(),await h()});const A=V(()=>Object.values(v).some(i=>i)),_e=[i=>!!i||"El código es obligatorio"],te=[i=>!!i||"El periodo es obligatorio"],ge=[i=>!!i||"El grado es obligatorio"],be=[i=>!!i||"El estudiante es obligatorio"],xe=[i=>i.length>0||"Debe seleccionar al menos una materia"],Q=V(()=>{if(t.value.type_education_id){const i=P.value.find(l=>l.value==t.value.type_education_id);return i?i.grades:[]}return[]}),ne=V(()=>t.value.grade_id?Q.value.find(i=>i.value==t.value.grade_id).subjects:[]),D=V(()=>{const i=t.value.students.flatMap(l=>l.subjects);return[...new Set(i)].map(l=>ne.value.find(C=>C.value===l)).filter(l=>l!==void 0)});return(i,l)=>{const C=Ee,T=ke,w=he,X=Pe,U=Ve;return m(),k("div",null,[a(ua,{disabled:v.form,loading:v.form},{default:s(()=>[a(ia,{class:"d-flex justify-space-between"},{default:s(()=>[_a]),_:1}),a(W,null,{default:s(()=>[a(da,{ref_key:"formValidation",ref:_,onSubmit:He(N,["prevent"]),disabled:r.value},{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.term_id,"onUpdate:modelValue":l[0]||(l[0]=d=>t.value.term_id=d),items:S.value,label:"Periodo",rules:te,"error-messages":u.value.term_id,onChange:l[1]||(l[1]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(T,{requiredField:"true",modelValue:t.value.code,"onUpdate:modelValue":l[2]||(l[2]=d=>t.value.code=d),rules:_e,label:"Código de sección"},null,8,["modelValue"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.type_education_id,"onUpdate:modelValue":l[3]||(l[3]=d=>t.value.type_education_id=d),items:P.value,label:"Tipo de educación",rules:te,"error-messages":u.value.term_id,onChange:l[4]||(l[4]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.grade_id,"onUpdate:modelValue":l[5]||(l[5]=d=>t.value.grade_id=d),items:Q.value,label:"Grados y niveles",rules:ge,"error-messages":u.value.grade_id,onChange:l[6]||(l[6]=d=>u.value.grade_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12"},{default:s(()=>[a(fa,{multiple:""},{default:s(()=>[(m(!0),k(G,null,M(t.value.students,(d,g)=>(m(),q(va,{key:g},{default:s(()=>[a(ae,null,{actions:s(()=>[r.value?R("",!0):(m(),q(J,{key:0,icon:"tabler-x",color:"error",onClick:I=>F(g)},null,8,["onClick"]))]),default:s(()=>[H(" Estudiante "+x(g+1)+" ",1)]),_:2},1024),a(ee,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"6"},{default:s(()=>[a(w,{modelValue:d.student_id,"onUpdate:modelValue":I=>d.student_id=I,url:"selectInfiniteStudent",arrayInfo:"student",rules:be,label:"Estudiante","error-messages":u.value[`students.${g}.student_id`],onInput:I=>u.value[`students.${g}.student_id`]="",readonly:r.value,params:{type_education_id:t.value.type_education_id}},null,8,["modelValue","onUpdate:modelValue","error-messages","onInput","readonly","params"])]),_:2},1024),a(E,{cols:"12",md:"6"},{default:s(()=>[a(X,{modelValue:d.subjects,"onUpdate:modelValue":I=>d.subjects=I,items:ne.value,label:"Materias",multiple:"",chips:"","closable-chips":"",rules:xe,"error-messages":u.value[`students.${g}.subjects`],onInput:I=>u.value[`students.${g}.subjects`]="",readonly:r.value},null,8,["modelValue","onUpdate:modelValue","items","error-messages","onInput","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value?R("",!0):(m(),q(J,{key:0,color:"primary",onClick:p,class:"mt-2"},{default:s(()=>[H(" Agregar Estudiante ")]),_:1}))]),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>[Object.keys(u.value).length>0?(m(),k("div",ga," Por favor, corrige los errores indicados. ")):R("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),a(W,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d;return[f("h2",ba,x(Je(y).company.name),1),f("p",xa," Año Escolar: "+x(((d=S.value.find(g=>g.value===t.value.term_id))==null?void 0:d.title)||"N/A")+" | Fecha: "+x(new Date().toLocaleDateString("es-ES")),1),ya]}),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d,g,I;return[f("h3",null," Sección: "+x(((d=S.value.find(c=>c.value===t.value.term_id))==null?void 0:d.title)||"N/A")+" - "+x(((g=P.value.find(c=>c.value===t.value.type_education_id))==null?void 0:g.title)||"N/A")+" - "+x(((I=Q.value.find(c=>c.value===t.value.grade_id))==null?void 0:I.title)||"N/A")+" - "+x(t.value.code||"N/A"),1),a(ra,{class:"bordered-table"},{default:s(()=>[f("thead",null,[f("tr",null,[Va,Pa,(m(!0),k(G,null,M(D.value,c=>(m(),k("th",{key:c.value},x(c.abbreviation||c.title),1))),128))])]),f("tbody",null,[(m(!0),k(G,null,M(t.value.students,(c,ye)=>{var se,oe;return m(),k("tr",{key:(se=c.student_id)==null?void 0:se.value},[f("td",null,x(ye+1),1),f("td",null,x(((oe=c.student_id)==null?void 0:oe.title)||"N/A"),1),(m(!0),k(G,null,M(D.value,L=>(m(),k("td",{key:L.value,class:We({"bg-yellow-lighten-3":c.subjects.includes(L.value),"bg-grey-lighten-3":!c.subjects.includes(L.value)&&D.value.length>0})},x(c.subjects.includes(L.value)?"--":""),3))),128))])}),128)),t.value.students.length?R("",!0):(m(),k("tr",ha,[f("td",{colspan:D.value.length+2,class:"text-center"}," No hay estudiantes seleccionados. ",8,ka)]))])]),_:1})]}),_:1})]),_:1})]),_:1}),a(W,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[a(U,{disabled:A.value,loading:A.value},null,8,["disabled","loading"]),r.value?R("",!0):(m(),q(J,{key:0,disabled:A.value,loading:A.value,onClick:N,color:"primary"},{default:s(()=>[H(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}}),il=ca(Ea,[["__scopeId","data-v-488abbe7"]]);export{il as default};
