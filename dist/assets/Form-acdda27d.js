import{V as B,r as g,e as U}from"./VForm-47a2101d.js";import{_}from"./AppTextField.vue_vue_type_script_setup_true_lang-dc2bc2f0.js";import{d as S,p as A,r as m,R as N,Q as T,w as I,L as K,o as y,c as R,b as o,f as l,k as e,B as F,g as D,ag as P,e as z,aA as E,aB as L}from"./index-a70c310d.js";import{u as j}from"./useImageUpload-77d7b627.js";import{u as x}from"./useCrudUserStore-1509bc12.js";import{V as G}from"./VCardText-a04b16cb.js";import{V as w}from"./VRow-4f083af2.js";import{V as d}from"./VCol-e195c0cc.js";import{V as H}from"./VField-2ed8a089.js";import{V as M}from"./VFileInput-85e9f98a.js";import{V as Q}from"./VImg-b4a62fd2.js";import{V as J}from"./VCard-d61c3423.js";import"./helpers-3edea678.js";import"./VTextField-8ddf2a14.js";import"./sweetalert2.all-e795d634.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VChip-9a337289.js";import"./VAvatar-22f50111.js";const O=z("b",{class:"text-warning"},"*",-1),ce=S({__name:"Form",setup(W){const b=A(),{toast:k}=L(),v=m();N();const p=x(),{form:i,loading:C}=T(p),n=m({}),u=m(j()),f=m(!1),V=m([]),q=r=>{u.value.handleImageSelected(r)},$=async()=>{var a,c;const r=await((a=v.value)==null?void 0:a.validate());if(r!=null&&r.valid){u.value.imageFile&&(i.value.photo=u.value.imageFile);const t=await p.fetchSave();(t==null?void 0:t.code)===200&&(V.value=[],n.value={},u.value.clearData(),await((c=v.value)==null?void 0:c.resetValidation())),(t==null?void 0:t.code)===422&&(n.value=t.errors??{})}else k("Faltan Campos Por Diligenciar","","danger")};return I(i,(r,a)=>{r.id?V.value.password=[]:V.value.password=[g(r.password)]},{deep:!0}),K(async()=>{p.clearForm(),await p.fetchDataForm(Number(b.params.id),b.params.action)}),(r,a)=>{const c=E,t=_;return y(),R("div",null,[o(J,null,{default:l(()=>[o(G,null,{default:l(()=>[o(w,null,{default:l(()=>[o(d,null,{default:l(()=>[o(c,{"sub-title":"form de usuario",action:String(r.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:r.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),o(e(B),{ref_key:"formValidation",ref:v,"lazy-validation":""},{default:l(()=>[o(w,null,{default:l(()=>[o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).email,"onUpdate:modelValue":a[0]||(a[0]=s=>e(i).email=s),rules:["requiredValidator"in r?r.requiredValidator:e(g),"emailValidator"in r?r.emailValidator:e(U)],autocomplete:"off","error-messages":e(n).email,label:"Email",onKeypress:a[1]||(a[1]=s=>e(n).email=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).password,"onUpdate:modelValue":a[2]||(a[2]=s=>e(i).password=s),rules:e(V).password,autocomplete:"off",type:e(f)?"text":"password","append-icon":e(f)?"mdi-eye":"mdi-eye-off","error-messages":e(n).password,label:"Contraseña","onClick:append":a[3]||(a[3]=s=>f.value=!e(f)),onKeypress:a[4]||(a[4]=s=>e(n).password=""),requiredField:!0},null,8,["modelValue","rules","type","append-icon","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).name,"onUpdate:modelValue":a[5]||(a[5]=s=>e(i).name=s),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(n).name,label:"Nombre",onKeypress:a[6]||(a[6]=s=>e(n).name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:e(i).last_name,"onUpdate:modelValue":a[7]||(a[7]=s=>e(i).last_name=s),rules:["requiredValidator"in r?r.requiredValidator:e(g)],"error-messages":e(n).last_name,label:"Apellido",onKeypress:a[8]||(a[8]=s=>e(n).last_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(H,null,{default:l(()=>[F("Foto  "),O]),_:1}),(y(),D(M,{key:e(u).key,"show-size":"",counter:"",accept:"image/*",onChange:a[9]||(a[9]=s=>q(s))}))]),_:1}),o(d,{cols:"12"},{default:l(()=>[o(Q,{contain:"",src:e(u).imageUrl??e(i).photo,alt:"foto Personal","max-width":200,class:"mx-auto img-fluid"},null,8,["src"])]),_:1})]),_:1}),o(w,null,{default:l(()=>[o(d,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[o(P,{loading:e(C).form,color:"primary",onClick:a[10]||(a[10]=s=>$())},{default:l(()=>[F(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{ce as default};
