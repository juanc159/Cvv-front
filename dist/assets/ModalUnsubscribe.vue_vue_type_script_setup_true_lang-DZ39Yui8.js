import{r as oe}from"./validators-Ry998vJq.js";import{_ as Ve}from"./ModalQuestion.vue_vue_type_script_setup_true_lang-Cz9DBNko.js";import{V as xe}from"./VTooltip-Dc02b3Ml.js";import{ag as _e,ah as he,aF as we,X as I,r as v,az as be,a$ as ye,M as Ce,w as B,aX as ke,ai as Fe,aH as Pe,b as a,z as L,aE as W,b0 as Ie,aW as Me,F as Y,P as le,aL as Se,cw as $e,c4 as Te,d as fe,bX as G,c as K,o as A,E as Re,g as J,x as j,k as t,f as i,C as N,D as M,e as f,a8 as De,n as ne,j as se,bY as Ae,p as Be,H as Ne,ae as ze,af as ie,ad as re}from"./index-DGPbDN3C.js";import{u as qe,a as ue,f as He,d as Ue,m as Ee,e as Ge,V as je}from"./VInput-Dia3tYqM.js";/* empty css                   */import{V as Le}from"./VCounter-C2lrhQKL.js";import{f as Qe}from"./forwardRefs-C-GTDzx5.js";import{I as Oe}from"./VImg-GOtdv2YA.js";import{_ as Xe}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-hJM2748A.js";import{_ as We}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-no7OzUOA.js";import{V as Ye}from"./VDialog-BEXli9K0.js";import{V as Je}from"./VCard-Cd5LzZ9C.js";import{V as Ke,a as Ze}from"./VToolbar-CByEh591.js";import{V as de}from"./VCardText-Ck9j2ztd.js";import{V as et}from"./VAlert-C0TSEVtr.js";import{V as tt}from"./VForm-CjqQXUGV.js";import{V as at}from"./VContainer-DyoTUTiM.js";import{V as ot,a as ce}from"./VRow-B_7Qk2u7.js";const lt=he({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Ee(),...Ue()},"VTextarea"),nt=_e()({name:"VTextarea",directives:{Intersect:Oe},inheritAttrs:!1,props:lt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,S){let{attrs:y,emit:$,slots:s}=S;const n=we(e,"modelValue"),{isFocused:p,focus:V,blur:d}=qe(e),c=I(()=>typeof e.counterValue=="function"?e.counterValue(n.value):(n.value||"").toString().length),z=I(()=>{if(y.maxlength)return y.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function T(l,g){var m,b;!e.autofocus||!l||(b=(m=g[0].target)==null?void 0:m.focus)==null||b.call(m)}const q=v(),R=v(),H=be(""),_=v(),Q=I(()=>e.persistentPlaceholder||p.value||e.active);function h(){var l;_.value!==document.activeElement&&((l=_.value)==null||l.focus()),p.value||V()}function r(l){h(),$("click:control",l)}function o(l){$("mousedown:control",l)}function C(l){l.stopPropagation(),h(),W(()=>{n.value="",Te(e["onClick:clear"],l)})}function w(l){var m;const g=l.target;if(n.value=g.value,(m=e.modelModifiers)!=null&&m.trim){const b=[g.selectionStart,g.selectionEnd];W(()=>{g.selectionStart=b[0],g.selectionEnd=b[1]})}}const x=v(),k=v(+e.rows),u=I(()=>["plain","underlined"].includes(e.variant));ye(()=>{e.autoGrow||(k.value=+e.rows)});function D(){e.autoGrow&&W(()=>{if(!x.value||!R.value)return;const l=getComputedStyle(x.value),g=getComputedStyle(R.value.$el),m=parseFloat(l.getPropertyValue("--v-field-padding-top"))+parseFloat(l.getPropertyValue("--v-input-padding-top"))+parseFloat(l.getPropertyValue("--v-field-padding-bottom")),b=x.value.scrollHeight,U=parseFloat(l.lineHeight),O=Math.max(parseFloat(e.rows)*U+m,parseFloat(g.getPropertyValue("--v-input-control-height"))),X=parseFloat(e.maxRows)*U+m||1/0,P=Me(b??0,O,X);k.value=Math.floor((P-m)/U),H.value=Ie(P)})}Ce(D),B(n,D),B(()=>e.rows,D),B(()=>e.maxRows,D),B(()=>e.density,D);let F;return B(x,l=>{l?(F=new ResizeObserver(D),F.observe(x.value)):F==null||F.disconnect()}),ke(()=>{F==null||F.disconnect()}),Fe(()=>{const l=!!(s.counter||e.counter||e.counterValue),g=!!(l||s.details),[m,b]=Pe(y),{modelValue:U,...O}=ue.filterProps(e),X=He(e);return a(ue,L({ref:q,modelValue:n.value,"onUpdate:modelValue":P=>n.value=P,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":u.value},e.class],style:e.style},m,O,{centerAffix:k.value===1&&!u.value,focused:p.value}),{...s,default:P=>{let{id:E,isDisabled:Z,isDirty:ee,isReadonly:me,isValid:ve}=P;return a(Ge,L({ref:R,style:{"--v-textarea-control-height":H.value},onClick:r,onMousedown:o,"onClick:clear":C,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},X,{id:E.value,active:Q.value||ee.value,centerAffix:k.value===1&&!u.value,dirty:ee.value||e.dirty,disabled:Z.value,focused:p.value,error:ve.value===!1}),{...s,default:pe=>{let{props:{class:te,...ae}}=pe;return a(Y,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),le(a("textarea",L({ref:_,class:te,value:n.value,onInput:w,autofocus:e.autofocus,readonly:me.value,disabled:Z.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:h,onBlur:d},ae,b),null),[[Se("intersect"),{handler:T},null,{once:!0}]]),e.autoGrow&&le(a("textarea",{class:[te,"v-textarea__sizer"],id:`${ae.id}-sizer`,"onUpdate:modelValue":ge=>n.value=ge,ref:x,readonly:!0,"aria-hidden":"true"},null),[[$e,n.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:g?P=>{var E;return a(Y,null,[(E=s.details)==null?void 0:E.call(s,P),l&&a(Y,null,[a("span",null,null),a(Le,{active:e.persistentCounter||p.value,value:c.value,max:z.value,disabled:e.disabled},s.counter)])])}:void 0})}),Qe({},q,R,_)}}),st={key:0},it=f("b",{class:"text-warning"},"*",-1),rt=fe({name:"AppTextarea",inheritAttrs:!1,__name:"AppTextarea",setup(e){const S=I(()=>{const n=G(),p=n.id||n.label;return p?`app-textarea-${p}-${Math.random().toString(36).slice(2,7)}`:void 0}),y=I(()=>G().label),$=I(()=>G().requiredField),s=I(()=>G().tooltip);return(n,p)=>(A(),K("div",{class:Re(["app-textarea flex-grow-1",n.$attrs.class])},[t(y)?(A(),J(je,{key:0,for:t(S),class:"mb-1 text-body-2 text-high-emphasis"},{default:i(()=>[N(M(t(y))+" ",1),t($)?(A(),K("span",st,[N("  "),it])):j("",!0),t(s)?(A(),J(xe,{key:1,location:t(s).location??"top"},{activator:i(({props:V})=>[t(s).icon?(A(),J(De,L({key:0},V,{icon:t(s).icon}),null,16,["icon"])):j("",!0)]),default:i(()=>[f("span",null,M(t(s).text),1)]),_:1},8,["location"])):j("",!0)]),_:1},8,["for"])):j("",!0),a(nt,ne(se({...n.$attrs,class:null,label:void 0,variant:"outlined",id:t(S)})),Ae({_:2},[Be(n.$slots,(V,d)=>({name:d,fn:i(c=>[Ne(n.$slots,d,ne(se(c||{})))])}))]),1040)],2))}}),ut={class:"student-info"},dt={class:"text-h6 mb-2"},ct={class:"d-flex gap-4"},ft=f("span",{class:"text-caption"},"Identificación:",-1),mt={class:"font-weight-medium"},vt=f("span",{class:"text-caption"},"Grado:",-1),pt={class:"font-weight-medium"},gt=f("span",{class:"text-caption"},"Sección:",-1),Vt={class:"font-weight-medium"},Nt=fe({__name:"ModalUnsubscribe",emits:["execute"],setup(e,{expose:S,emit:y}){const $=y,s=v({}),n=v(),p=v("Dar de baja"),V=v(!1),d=v(!1),c=v({id:null,date:null,reason:null}),z=()=>{for(const r in c.value)c.value[r]=null},T=()=>{V.value=!V.value},q=async r=>{z(),T(),c.value.id=r,await R()},R=async()=>{var w;const r=`/student/show/${c.value.id}`;d.value=!0;const{data:o,response:C}=await ie(r).get();d.value=!1,(w=C.value)!=null&&w.ok&&o.value&&(h.value={fullName:o.value.student.full_name,document:o.value.student.identity_document,grade:o.value.student.grade_name,section:o.value.student.section_name})},H=async r=>{var C,w;const o=await((C=n.value)==null?void 0:C.validate());if(o!=null&&o.valid){const x="/student/withdraw";d.value=!0;const{response:k,data:u}=await ie(x).post({student_id:c.value.id,date:c.value.date,reason:c.value.reason});d.value=!1,(w=k.value)!=null&&w.ok&&u.value&&(z(),T(),$("execute")),u.value.code==422&&(s.value=u.value.errors??{})}},_=v(),Q=async()=>{var o;const r=await((o=n.value)==null?void 0:o.validate());r!=null&&r.valid&&(_.value.openModal(),_.value.componentData.title="¿Seguro desea dar de baja al estudiante?",_.value.componentData.subTitle="Verifique la información")},h=v({fullName:"",document:"",grade:"",section:""});return S({openModal:q}),(r,o)=>{const C=We,w=Xe,x=rt,k=Ve;return A(),K("div",null,[a(Ye,{modelValue:t(V),"onUpdate:modelValue":o[6]||(o[6]=u=>ze(V)?V.value=u:null),overlay:!1,"max-width":"50rem",transition:"dialog-transition",persistent:""},{default:i(()=>[a(C,{onClick:T}),a(Je,{loading:t(d),disabled:t(d),class:"w-100"},{default:i(()=>[f("div",null,[a(Ke,{color:"primary"},{default:i(()=>[a(Ze,null,{default:i(()=>[N(M(t(p)),1)]),_:1})]),_:1})]),a(de,{class:"pt-4 pb-0"},{default:i(()=>[a(et,{color:"info",variant:"tonal",border:"start",class:"mb-4"},{default:i(()=>[f("div",ut,[f("div",dt,M(t(h).fullName),1),f("div",ct,[f("div",null,[ft,f("span",mt,M(t(h).document),1)]),f("div",null,[vt,f("span",pt,M(t(h).grade),1)]),f("div",null,[gt,f("span",Vt,M(t(h).section),1)])])])]),_:1}),a(tt,{ref_key:"refForm",ref:n},{default:i(()=>[a(at,null,{default:i(()=>[a(ot,null,{default:i(()=>[a(ce,{cols:"6"},{default:i(()=>[a(w,{clearable:"",modelValue:t(c).date,"onUpdate:modelValue":o[0]||(o[0]=u=>t(c).date=u),label:"Fecha",rules:["requiredValidator"in r?r.requiredValidator:t(oe)],requiredField:!0,"error-messages":t(s).date,onInput:o[1]||(o[1]=u=>t(s).date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),a(ce,{cols:"12"},{default:i(()=>[a(x,{requiredField:!0,rules:["requiredValidator"in r?r.requiredValidator:t(oe)],label:"Motivo",modelValue:t(c).reason,"onUpdate:modelValue":o[2]||(o[2]=u=>t(c).reason=u),clearable:"",counter:"",maxlength:"255","error-messages":t(s).reason,onInput:o[3]||(o[3]=u=>t(s).reason="")},null,8,["rules","modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),a(de,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:i(()=>[a(re,{disabled:t(d),loading:t(d),onClick:o[4]||(o[4]=u=>T()),color:"secondary"},{default:i(()=>[N(" Cancelar ")]),_:1},8,["disabled","loading"]),a(re,{disabled:t(d),loading:t(d),onClick:o[5]||(o[5]=u=>Q())},{default:i(()=>[N(" Guardar ")]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"]),a(k,{ref_key:"refModalQuestion",ref:_,onSuccess:H},null,512)])}}});export{Nt as _};
