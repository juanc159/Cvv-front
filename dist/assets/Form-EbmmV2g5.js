import{s as J}from"./helpers-nlAMT8CX.js";import{r as v,u as O}from"./validators-DKbmw92y.js";import{d as R,r as p,t as P,aU as Y,N as z,w as H,Y as K,c as $,o as c,b as e,f as o,e as U,l as a,a9 as Q,h as F,y as I,D,a8 as q,F as W,q as X,a6 as Z,aJ as M,aM as h,aV as x}from"./index-lrlC7dU6.js";import{_ as ee}from"./BtnBack.vue_vue_type_script_setup_true_lang-D6kMyPWm.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-CJwmaM6Y.js";import{_ as le}from"./AppTextField.vue_vue_type_script_setup_true_lang-Ck9sddvT.js";import{u as oe,V as re}from"./VFileInput-DazQfvh8.js";import{a as N,V as te}from"./VCard-u4KjVU6S.js";import{V as C}from"./VCardText-BWBQCuaJ.js";import{V as ie}from"./VForm-C1UsIQOl.js";import{V as _,a as s}from"./VRow-Y-px9dy8.js";import{V as ne}from"./VInput-DI6tl7Gf.js";import{V as se}from"./VImg-CHZL3vTv.js";import{V as ue}from"./VDivider-Dcm9G-1v.js";import{V as de}from"./VTooltip-DtKi32nu.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-BxXeVVMU.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CHrMvmXo.js";import"./VDialog-BH4E8l9N.js";import"./VOverlay-onlbvDoS.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-B5aYFXc4.js";import"./VSelect-B_Uw_j_U.js";import"./VTextField-Cn0h9Jbo.js";/* empty css                   */import"./VCounter-B4tjcVkd.js";import"./VList-B08cmeCh.js";import"./ssrBoot-4AFRnSrN.js";import"./VAvatar-Dh--CA_q.js";import"./VMenu-B5PHd5e4.js";import"./VCheckboxBtn-C7iXD_AJ.js";import"./VSelectionControl-CjT_Q8-s.js";import"./VChip-Bx98Ga3Z.js";import"./sweetalert2.esm.all-DV3w3JmD.js";/* empty css              */const me=U("span",null," Formulario Compañia ",-1),pe={class:"d-flex justify-space-between"},fe=U("span",null,"Información de adicional",-1),Xe=R({__name:"Form",setup(ce){const{toast:T}=x(),V=p({}),k=p(!1),w=P(),B=p(),m=Y({form:!1}),j=p([]),r=p({id:null,name:null,slogan:null,image_principal:null,iframeGoogleMap:null,students_pending_subject:null,arrayDetails:[]}),G=()=>{for(const l in r.value)r.value[l]=null;r.value.arrayDetails=[]},A=async()=>{var f;r.value.id=w.params.id||null;const l=r.value.id?`/company/${r.value.id}/edit`:"/company/create";m.form=!0;const{response:i,data:n}=await M(l).get();m.form=!1,(f=i.value)!=null&&f.ok&&n.value&&(j.value=n.value.typeDetails,n.value.form&&(r.value=n.value.form))},E=async()=>{var i,n;const l=await((i=B.value)==null?void 0:i.validate());if(l!=null&&l.valid){const f=r.value.id?`/company/update/${r.value.id}`:"/company/store";d.value.imageFile&&(r.value.image_principal=d.value.imageFile);const g=new FormData;for(const u in r.value)["arrayDetails"].includes(u)||g.append(u,r.value[u]);g.append("arrayDetails",JSON.stringify(r.value.arrayDetails)),m.form=!0;const{data:t,response:b}=await M(f).post(g);m.form=!1,(n=b.value)!=null&&n.ok&&t.value&&t.value.code==200&&h.push({name:"Company-List"}),t.value.code===422&&(V.value=t.value.errors??{})}else T("Faltan Campos Por Diligenciar","","danger")};w.params.action=="view"&&(k.value=!0),z(async()=>{G(),await A()});const d=p(oe());d.value.allowedExtensions=["jpg","jpeg","png"],H(d.value,(l,i)=>{l.imageFile&&(r.value.image_principal=l.imageFile)});const y=K(()=>Object.values(m).some(l=>l)),L=()=>{r.value.arrayDetails.push({id:null,type_detail_id:null,icon:null,color:null,content:null})},S=l=>{r.value.arrayDetails.splice(l,1)};return p(),(l,i)=>{const n=le,f=ae,g=ee;return c(),$("div",null,[e(te,{disabled:a(m).form,loading:a(m).form},{default:o(()=>[e(N,{class:"d-flex justify-space-between"},{default:o(()=>[me]),_:1}),e(C,null,{default:o(()=>[e(ie,{ref_key:"formValidation",ref:B,onSubmit:Q(()=>{},["prevent"]),disabled:a(k)},{default:o(()=>[e(_,null,{default:o(()=>[e(s,{sm:"4"},{default:o(()=>[e(_,null,{default:o(()=>[e(s,null,{default:o(()=>[e(ne,null,{default:o(()=>[D("Imagen principal")]),_:1}),(c(),F(re,{accept:"image/*",loading:a(d).loading,onChange:a(d).handleImageSelected,key:a(d).key},null,8,["loading","onChange"]))]),_:1})]),_:1}),a(d).imageUrl||a(r).image_principal?(c(),F(_,{key:0},{default:o(()=>[e(s,{class:"d-flex justify-center"},{default:o(()=>[e(se,{src:a(d).imageUrl??("storageBack"in l?l.storageBack:a(J))(a(r).image_principal),alt:"alt"},null,8,["src"])]),_:1})]),_:1})):I("",!0)]),_:1}),e(s,{sm:"8"},{default:o(()=>[e(_,null,{default:o(()=>[e(s,{cols:"12"},{default:o(()=>[e(n,{requiredField:!0,rules:["requiredValidator"in l?l.requiredValidator:a(v)],modelValue:a(r).name,"onUpdate:modelValue":i[0]||(i[0]=t=>a(r).name=t),label:"Nombre","error-messages":a(V).name,onInput:i[1]||(i[1]=t=>a(V).name=""),clearable:""},null,8,["rules","modelValue","error-messages"])]),_:1}),e(s,{cols:"12"},{default:o(()=>[e(n,{clearable:"",modelValue:a(r).slogan,"onUpdate:modelValue":i[2]||(i[2]=t=>a(r).slogan=t),rules:["requiredValidator"in l?l.requiredValidator:a(v)],"error-messages":a(V).slogan,label:"Eslogan",onInput:i[3]||(i[3]=t=>a(V).slogan=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),e(s,{cols:"12"},{default:o(()=>[e(n,{clearable:"",modelValue:a(r).iframeGoogleMap,"onUpdate:modelValue":i[4]||(i[4]=t=>a(r).iframeGoogleMap=t),label:"iframeGoogleMap"},null,8,["modelValue"])]),_:1}),e(s,{cols:"12"},{default:o(()=>[e(n,{modelValue:a(r).students_pending_subject,"onUpdate:modelValue":i[5]||(i[5]=t=>a(r).students_pending_subject=t),label:"Documento de materia pendiente",clearable:"",rules:["urlValidator"in l?l.urlValidator:a(O)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),e(ue,{class:"my-5"}),e(N,{"primary-title":""},{default:o(()=>[U("div",pe,[fe,e(q,{color:"success",onClick:i[6]||(i[6]=t=>L())},{default:o(()=>[D("Agregar")]),_:1})])]),_:1}),e(C,null,{default:o(()=>[(c(!0),$(W,null,X(a(r).arrayDetails,(t,b)=>(c(),F(_,{key:b},{default:o(()=>[e(s,{cols:"12",md:"2"},{default:o(()=>[e(f,{items:a(j),modelValue:t.type_detail_id,"onUpdate:modelValue":u=>t.type_detail_id=u,label:"Tipo",requiredField:!0},null,8,["items","modelValue","onUpdate:modelValue"])]),_:2},1024),e(s,{cols:"12",md:"2"},{default:o(()=>[e(n,{clearable:"",modelValue:t.icon,"onUpdate:modelValue":u=>t.icon=u,rules:["requiredValidator"in l?l.requiredValidator:a(v)],label:"Icono",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(s,{cols:"12",md:"2"},{default:o(()=>[e(n,{clearable:"",modelValue:t.color,"onUpdate:modelValue":u=>t.color=u,rules:["requiredValidator"in l?l.requiredValidator:a(v)],label:"Color",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(s,{cols:"12",md:"5"},{default:o(()=>[e(n,{clearable:"",modelValue:t.content,"onUpdate:modelValue":u=>t.content=u,rules:["requiredValidator"in l?l.requiredValidator:a(v)],label:"Contenido",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(s,{cols:"12",md:"1"},{default:o(()=>[e(q,{icon:"",color:"error",variant:"text",class:"mt-6",onClick:u=>S(b)},{default:o(()=>[e(Z,{icon:"tabler-trash"}),e(de,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(C,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:o(()=>[e(g,{disabled:a(y),loading:a(y)},null,8,["disabled","loading"]),a(k)?I("",!0):(c(),F(q,{key:0,disabled:a(y),loading:a(y),onClick:i[7]||(i[7]=t=>E()),color:"primary"},{default:o(()=>[D(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Xe as default};
