import{r as h,V as j}from"./VForm-09f36129.js";import{_ as x}from"./AppTextField.vue_vue_type_script_setup_true_lang-668364af.js";import{d as z,p as K,r as d,R as N,Q as P,L as U,ad as y,a as L,o as c,c as k,b as e,f as t,k as a,B as _,E as O,g as C,F as Y,m as H,ag as G,aB as M,aC as Q,ci as J,C as W}from"./index-a73ef7a4.js";import{u as F}from"./useImageUpload-1a3a20dc.js";import{u as X}from"./useCrudServiceStore-eda59517.js";import{V as Z}from"./VCardText-f167dd9c.js";import{V as g}from"./VRow-be98792f.js";import{V as u}from"./VCol-38ed283b.js";import{V as ee}from"./VField-c03f9512.js";import{V as ae}from"./VFileInput-2f0c9cb7.js";import{V as te}from"./VImg-92b32f5d.js";import{V as oe}from"./VCard-3c846ebb.js";import"./helpers-3edea678.js";import"./VTextField-cd57f2d2.js";import"./sweetalert2.all-e795d634.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VChip-eb33449f.js";import"./VAvatar-c8033367.js";const re="9ckqih5g25k3jtb9l2c6iv9ewziedlu79zh7k3amkq9qt9vn",le={key:0,class:"text-warning"},Ee=z({__name:"Form",setup(ie){const V=K(),{toast:I}=Q(),v=d(),p=X(),E=N(),{form:n,loading:S}=P(p),w=d(F()),s=d({}),T=d([]),m=d(F()),B=["jpg","jpeg","png"];m.value.allowedExtensions=B;const D=async()=>{var o,f;n.value.company_id=E.company.id;const r=await((o=v.value)==null?void 0:o.validate());if(r!=null&&r.valid){const l=await p.fetchSave();(l==null?void 0:l.code)===200&&(T.value=[],s.value={},w.value.clearData(),await((f=v.value)==null?void 0:f.resetValidation())),(l==null?void 0:l.code)===422&&(s.value=l.errors??{})}else I("Faltan Campos Por Diligenciar","","danger")},q=r=>{m.value.handleImageSelected(r),setTimeout(()=>{n.value.image=m.value.imageFile},1e3)};U(async()=>{p.clearForm(),V.params.id&&await p.fetchDataForm(Number(V.params.id),V.params.action)});const A=y(()=>{if(s.value.html)return s.value.html}),b=y(()=>n.value.id?[]:[h]);return(r,o)=>{const f=M,l=x,R=L("Editor");return c(),k("div",null,[e(oe,null,{default:t(()=>[e(Z,null,{default:t(()=>[e(g,null,{default:t(()=>[e(u,null,{default:t(()=>[e(f,{"sub-title":"Formulario Servicio",action:String(r.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:r.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),e(a(j),{ref_key:"formValidation",ref:v,"lazy-validation":""},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{cols:"12",sm:"3"},{default:t(()=>[e(l,{clearable:"",modelValue:a(n).title,"onUpdate:modelValue":o[0]||(o[0]=i=>a(n).title=i),rules:["requiredValidator"in r?r.requiredValidator:a(h)],"error-messages":a(s).title,label:"Título",onKeypress:o[1]||(o[1]=i=>a(s).title=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),e(u,{cols:"12",sm:"3"},{default:t(()=>[e(ee,null,{default:t(()=>[_(" Imagen "),a(b).length>0?(c(),k("b",le,"*")):O("",!0)]),_:1}),(c(),C(ae,{accept:"image/*",rules:a(b),key:a(m).key,onChange:o[2]||(o[2]=i=>q(i)),"onClick:clear":a(m).clearData},null,8,["rules","onClick:clear"]))]),_:1}),e(u,{cols:"12",sm:"3"},{default:t(()=>[e(te,{src:a(m).imageUrl??a(n).image},null,8,["src"])]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(R,{"api-key":"API_KEY_EDITOR"in r?r.API_KEY_EDITOR:a(re),init:{toolbar_mode:"sliding",plugins:"anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount linkchecker",toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat"},"initial-value":"",modelValue:a(n).html,"onUpdate:modelValue":o[3]||(o[3]=i=>a(n).html=i)},null,8,["api-key","modelValue"]),(c(!0),k(Y,null,H(a(A),(i,$)=>(c(),C(J,{key:$,class:"my-2",variant:"tonal",color:"error"},{default:t(()=>[_(W(i),1)]),_:2},1024))),128))]),_:1})]),_:1}),e(g),e(g,null,{default:t(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:t(()=>[e(G,{loading:a(S).form,color:"primary",onClick:o[4]||(o[4]=i=>D())},{default:t(()=>[_(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{Ee as default};
