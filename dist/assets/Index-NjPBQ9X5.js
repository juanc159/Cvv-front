import{h as b,b as ae}from"./helpers-B_zKm85t.js";import{r as B}from"./validators-C2Y1mJAW.js";import{_ as oe}from"./ModalQuestion.vue_vue_type_script_setup_true_lang-D6tnpPzz.js";import{_ as le}from"./DragAndDrop.vue_vue_type_script_setup_true_lang-D8NoztZm.js";import{_ as te}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-DeUFXCKk.js";import{_ as se}from"./AppSelect.vue_vue_type_script_setup_true_lang-D4wrV86H.js";import{d as ie,U as ne,ax as re,r as m,M as de,af as g,X as ue,c as M,o as u,g as c,x as k,b as a,k as e,f as o,C as f,e as F,ad as S,ae as me,F as x,p as I,D as _e,ay as ce}from"./index-CQ5LwE8r.js";import{u as fe,V as pe}from"./VFileInput-Dt_AkNB4.js";import{c as ge}from"./createUrl-BpmGQ1rQ.js";import{b as U,V as w}from"./VCard-JKtH56dP.js";import{V as v}from"./VCardText-D6bON79e.js";import{V as L}from"./VForm-DLT830yQ.js";import{V as _,a as r}from"./VRow-ocuWGgYQ.js";import{V as ve}from"./VInput-BqCcxrym.js";import{V as E}from"./VSwitch-BKb7Fxsq.js";import{V as ye}from"./VDivider-CvhtBvMu.js";import"./constants-2GBt7OCP.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-DrPHqJSJ.js";import"./VDialog-d0rYhkcX.js";import"./VOverlay-bLSEVn9u.js";import"./VImg-De6hWsIg.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-CWo1Z0Yi.js";import"./VSpacer-btdGLzUy.js";/* empty css              */import"./VAvatar-DbSbetP_.js";import"./VTooltip-oTjvs5Vh.js";import"./VSelect-BWOslUTJ.js";import"./VTextField-C4UCk_EU.js";/* empty css                   */import"./VCounter-CLbdetcI.js";import"./VList-DktQQALS.js";import"./ssrBoot-DSYWuai_.js";import"./VMenu-RovNws4k.js";import"./VCheckboxBtn-CI2ehhay.js";import"./VSelectionControl-D0KUwFUG.js";import"./VChip-B9yyqRQ0.js";import"./filter-DVWHqjhP.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./index-0F-JFElI.js";const Ve=F("b",{class:"text-warning"},"*",-1),be={class:"demo-space-x"},ke={class:"demo-space-x"},we={class:"demo-space-x"},ua=ie({__name:"Index",setup(he){const $=ne(),{toast:T}=ce(),s=re({form:!1,download_notes:!1,block_uploading_of_grades_to_teachers:!1,viewing_notes:!1}),p=m({company_id:null,type_education_id:null,teacher_id:null,archive:null}),y=m({}),Q=m(),R=m(),h=m([]),j=m([]),C=m(fe());C.value.allowedExtensions=["xls","xlsx"];const D=m(!1),N=m({});de(async()=>{var n;await O(),s.form=!0;const{data:l,response:t}=await g("note-dataForm").get();(n=t.value)!=null&&n.ok&&l.value&&(h.value=l.value.typeEducations,D.value=l.value.blockData,j.value=l.value.teachers),s.form=!1});const O=async()=>{var n;const{data:l,response:t}=await g("/type_educations/visualization/show").get();(n=t.value)!=null&&n.ok&&l.value&&(N.value=l.value.selectedNotes)},G=async()=>{var t;p.value.archive=C.value.imageFile,p.value.company_id=$.company.id;const l=await((t=Q.value)==null?void 0:t.validate());if(l!=null&&l.valid){const n=new FormData;for(const V in p.value)n.append(V,p.value[V]);s.form=!0;const{data:d,response:P}=await g("note-store").post(n);s.form=!1}else T("Faltan Campos Por Diligenciar","","danger")},q=m({type_education_id:null}),X=async()=>{var t,n;const l=await((t=R.value)==null?void 0:t.validate());if(l!=null&&l.valid){s.download_notes=!0;const d=h.value.find(i=>i.value==q.value.type_education_id),{data:P,response:V}=await g(ge("/note-downloadAllConsolidated",{query:{type_education_id:q.value.type_education_id,company_id:$.company.id}}));s.download_notes=!1,(n=V.value)!=null&&n.ok&&P.value&&ae(P.value.excel,"Consolidado "+(d==null?void 0:d.title))}else T("Faltan Campos Por Diligenciar","","danger")},H=async l=>{var d;s.block_uploading_of_grades_to_teachers=!0;const{data:t,response:n}=await g("/note-blockPayrollUpload").post({value:l});(d=n.value)!=null&&d.ok&&t.value,s.block_uploading_of_grades_to_teachers=!1},J=async l=>{var d;s.block_uploading_of_grades_to_teachers=!0;const{data:t,response:n}=await g("/note-resetOptionDownloadPdf").post({company_id:$.company.id});(d=n.value)!=null&&d.ok&&t.value,s.block_uploading_of_grades_to_teachers=!1},K=ue(()=>D.value?"Sí":"No"),W=async()=>{s.viewing_notes=!0;const{data:l,response:t}=await g("/type_educations/visualization/store").post({selectedNotes:N.value});s.viewing_notes=!1},z=m(),Y=()=>{z.value.openModal(),z.value.componentData.title="Esta seguro que desea activar a todos los estudiantes en un estado insolventes"};return(l,t)=>{const n=se,d=te,P=le,V=oe;return u(),M("div",null,[("hasPermission"in l?l.hasPermission:e(b))("note.upload_notes")?(u(),c(w,{key:0,disabled:e(s).form,loading:e(s).form},{default:o(()=>[a(U,{"primary-title":""},{default:o(()=>[f("Cargar Notas")]),_:1}),a(v,null,{default:o(()=>[a(e(L),{ref_key:"formValidation",ref:Q,"lazy-validation":""},{default:o(()=>[a(_,null,{default:o(()=>[a(r,{cols:"12",sm:"4"},{default:o(()=>[a(n,{clearable:"",modelValue:e(p).type_education_id,"onUpdate:modelValue":t[0]||(t[0]=i=>e(p).type_education_id=i),rules:["requiredValidator"in l?l.requiredValidator:e(B)],"error-messages":e(y).type_education_id,label:"Tipo",onChange:t[1]||(t[1]=i=>e(y).type_education_id=""),requiredField:!0,items:e(h)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),a(r,{cols:"12",sm:"4"},{default:o(()=>[a(ve,null,{default:o(()=>[f("Archivo "),Ve]),_:1}),(u(),c(pe,{key:e(C).key,onChange:e(C).handleImageSelected,"onClick:clear":e(C).clearData,rules:["requiredValidator"in l?l.requiredValidator:e(B)]},null,8,["onChange","onClick:clear","rules"]))]),_:1}),a(r,{cols:"12",sm:"4"},{default:o(()=>[a(d,{clearable:"",modelValue:e(p).teacher_id,"onUpdate:modelValue":t[2]||(t[2]=i=>e(p).teacher_id=i),"error-messages":e(y).teacher_id,label:"Docente",onChange:t[3]||(t[3]=i=>e(y).teacher_id=""),items:e(j)},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),a(_,null,{default:o(()=>[a(r,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[a(S,{loading:e(s).form,disabled:e(s).form,color:"primary",onClick:t[4]||(t[4]=i=>G())},{default:o(()=>[f(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])):k("",!0),("hasPermission"in l?l.hasPermission:e(b))("note.download_notes")?(u(),c(w,{key:1,disabled:e(s).download_notes,loading:e(s).download_notes,class:"mt-3"},{default:o(()=>[a(U,{"primary-title":""},{default:o(()=>[f("Descargar Notas")]),_:1}),a(v,null,{default:o(()=>[a(e(L),{ref_key:"formValidationDownload",ref:R,"lazy-validation":""},{default:o(()=>[a(_,null,{default:o(()=>[a(r,{cols:"12",sm:"4"},{default:o(()=>[a(n,{clearable:"",modelValue:e(q).type_education_id,"onUpdate:modelValue":t[5]||(t[5]=i=>e(q).type_education_id=i),rules:["requiredValidator"in l?l.requiredValidator:e(B)],"error-messages":e(y).type_education_id,label:"Tipo",onChange:t[6]||(t[6]=i=>e(y).type_education_id=""),requiredField:!0,items:e(h)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),a(_,null,{default:o(()=>[a(r,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[a(S,{loading:e(s).download_notes,disabled:e(s).download_notes,color:"primary",onClick:t[7]||(t[7]=i=>X())},{default:o(()=>[f(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])):k("",!0),a(_,null,{default:o(()=>[a(r,{cols:"4"},{default:o(()=>[("hasPermission"in l?l.hasPermission:e(b))("note.block_uploading_of_grades_to_teachers")?(u(),c(w,{key:0,disabled:e(s).block_uploading_of_grades_to_teachers,loading:e(s).block_uploading_of_grades_to_teachers,class:"mt-3"},{default:o(()=>[a(U,{"primary-title":""},{default:o(()=>[f("Bloquear carga de notas a los profesores")]),_:1}),a(v,null,{default:o(()=>[a(_,null,{default:o(()=>[a(r,{cols:"12",sm:"4"},{default:o(()=>[F("div",be,[a(E,{modelValue:e(D),"onUpdate:modelValue":[t[8]||(t[8]=i=>me(D)?D.value=i:null),t[9]||(t[9]=i=>H(i))],label:e(K),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):k("",!0)]),_:1}),a(r,{cols:"4"},{default:o(()=>[("hasPermission"in l?l.hasPermission:e(b))("note.reset_option_download_pdf")?(u(),c(w,{key:0,disabled:e(s).block_uploading_of_grades_to_teachers,loading:e(s).block_uploading_of_grades_to_teachers,class:"mt-3"},{default:o(()=>[a(U,{"primary-title":""},{default:o(()=>[f("Reiniciar opción descarga pdf y boletin")]),_:1}),a(v,null,{default:o(()=>[a(_,null,{default:o(()=>[a(r,{cols:"12",sm:"4"},{default:o(()=>[F("div",ke,[a(S,{color:"primary",onClick:Y},{default:o(()=>[f("Reiniciar")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):k("",!0)]),_:1})]),_:1}),("hasPermission"in l?l.hasPermission:e(b))("note.viewing_notes")?(u(),c(w,{key:2,disabled:e(s).viewing_notes,loading:e(s).viewing_notes,class:"mt-3",title:"Visualización de las notas"},{default:o(()=>[(u(!0),M(x,null,I(e(h),i=>(u(),c(v,{key:i.value},{default:o(()=>[a(ye),a(_,null,{default:o(()=>[a(r,null,{default:o(()=>[F("span",null,_e(i.title),1)]),_:2},1024)]),_:2},1024),a(_,null,{default:o(()=>[(u(!0),M(x,null,I(i.cantNotes,(A,Z)=>(u(),c(r,{cols:"12",sm:"4",key:Z},{default:o(()=>[F("div",we,[a(E,{modelValue:e(N)[i.value]["note_"+A],"onUpdate:modelValue":ee=>e(N)[i.value]["note_"+A]=ee,label:"Nota "+A,color:"success"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128)),a(v,null,{default:o(()=>[a(_,null,{default:o(()=>[a(r,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[a(S,{loading:e(s).form,disabled:e(s).form,color:"primary",onClick:t[10]||(t[10]=i=>W())},{default:o(()=>[f(" Guardar Visualización ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):k("",!0),("hasPermission"in l?l.hasPermission:e(b))("note.bulk_file_upload")?(u(),c(w,{key:3,title:"Carga de archivos masivos",class:"mt-3"},{default:o(()=>[a(v,null,{default:o(()=>[a(P)]),_:1})]),_:1})):k("",!0),a(V,{ref_key:"refModalQuestion",ref:z,onSuccess:J},null,512)])}}});export{ua as default};
