const L=/#/g,C=/&/g,d=/=/g,h=/\+/g,O=/%5e/gi,P=/%60/gi,T=/%7c/gi,I=/%20/gi;function N(t){return encodeURI(""+t).replace(T,"|")}function a(t){return N(typeof t=="string"?t:JSON.stringify(t)).replace(h,"%2B").replace(I,"+").replace(L,"%23").replace(C,"%26").replace(P,"`").replace(O,"^")}function s(t){return a(t).replace(d,"%3D")}function _(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function Q(t){return _(t.replace(h," "))}function S(t){return _(t.replace(h," "))}function U(t=""){const e={};t[0]==="?"&&(t=t.slice(1));for(const n of t.split("&")){const r=n.match(/([^=]+)=?(.*)/)||[];if(r.length<2)continue;const c=Q(r[1]);if(c==="__proto__"||c==="constructor")continue;const o=S(r[2]||"");e[c]===void 0?e[c]=o:Array.isArray(e[c])?e[c].push(o):e[c]=[e[c],o]}return e}function b(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(n=>`${s(t)}=${a(n)}`).join("&"):`${s(t)}=${a(e)}`:s(t)}function j(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>b(e,t[e])).filter(Boolean).join("&")}const w=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,$=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,G=/^([/\\]\s*){2,}[^/\\]/;function E(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?w.test(t):$.test(t)||(e.acceptRelative?G.test(t):!1)}const B=/\/$|\/\?/;function i(t="",e=!1){return e?B.test(t):t.endsWith("/")}function H(t="",e=!1){if(!e)return(i(t)?t.slice(0,-1):t)||"/";if(!i(t,!0))return t||"/";const[n,...r]=t.split("?");return(n.slice(0,-1)||"/")+(r.length>0?`?${r.join("?")}`:"")}function K(t="",e=!1){if(!e)return t.endsWith("/")?t:t+"/";if(i(t,!0))return t||"/";const[n,...r]=t.split("?");return n+"/"+(r.length>0?`?${r.join("?")}`:"")}function J(t,e){if(W(e)||E(t))return t;const n=H(e);return t.startsWith(n)?t:V(n,t)}function v(t,e){const n=y(t),r={...U(n.search),...e};return n.search=j(r),X(n)}function W(t){return!t||t==="/"}function D(t){return t&&t!=="/"}const M=/^\.?\//;function V(t,...e){let n=t||"";for(const r of e.filter(c=>D(c)))if(n){const c=r.replace(M,"");n=K(n)+c}else n=r;return n}function y(t="",e){const n=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/);if(n){const[,l,u=""]=n;return{protocol:l,pathname:u,href:l+u,auth:"",host:"",search:"",hash:""}}if(!E(t,{acceptRelative:!0}))return e?y(e+t):R(t);const[,r="",c,o=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,f="",m=""]=o.match(/([^#/?]*)(.*)?/)||[],{pathname:g,search:A,hash:p}=R(m.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:r,auth:c?c.slice(0,Math.max(0,c.length-1)):"",host:f,pathname:g,search:A,hash:p}}function R(t=""){const[e="",n="",r=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:r}}function X(t){const e=t.pathname||"",n=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",r=t.hash||"",c=t.auth?t.auth+"@":"",o=t.host||"";return(t.protocol?t.protocol+"//":"")+c+o+e+n+r}export{J as a,v as w};
