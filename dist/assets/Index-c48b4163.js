import{V as R,r as N}from"./VForm-70a51769.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-6532682d.js";import{ag as le,aj as te,aG as z,aH as oe,r as u,ab as L,aI as ie,ak as se,aJ as ne,b as a,y as j,F as re,aK as de,a6 as ue,aL as ce,aM as me,d as fe,R as ve,aF as pe,L as Ve,af as S,o as M,c as ge,f as o,B as g,k as l,e as G,g as ye,ae as H,a9 as _e,aA as be}from"./index-551c6ec5.js";import{u as ke}from"./useImageUpload-6d0014af.js";import{c as Ce}from"./createUrl-68951cd0.js";import{a as we}from"./helpers-53221d8d.js";import{b as T,V as U}from"./VCard-d87e2dd9.js";import{V as $}from"./VCardText-1b43aec1.js";import{V as b}from"./VRow-51805640.js";import{V as y}from"./VCol-12daf29e.js";import{m as xe,u as Se,a as J,V as Fe}from"./VField-b9d726d8.js";import{V as Be}from"./VFileInput-0ac12804.js";import{m as De,a as K}from"./VSelect-aca9abe7.js";import"./sweetalert2.esm.all-562d67d8.js";import"./index-9c720871.js";import"./VAvatar-8b3dcd6d.js";import"./VImg-5e8a126f.js";/* empty css              */import"./VChip-fcf1a935.js";import"./VTextField-61c92ad5.js";import"./VList-ef13cd0f.js";import"./ssrBoot-45f344a7.js";import"./VDivider-a1ffd975.js";import"./dialog-transition-93c008b8.js";import"./VMenu-d88024f5.js";const Pe=le({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...xe(),...De()},"VSwitch"),qe=te()({name:"VSwitch",inheritAttrs:!1,props:Pe(),emits:{"update:focused":s=>!0,"update:modelValue":()=>!0,"update:indeterminate":s=>!0},setup(s,F){let{attrs:k,slots:n}=F;const d=z(s,"indeterminate"),m=z(s,"modelValue"),{loaderClasses:C}=oe(s),{isFocused:w,focus:v,blur:f}=Se(s),c=u(),B=L(()=>typeof s.loading=="string"&&s.loading!==""?s.loading:s.color),p=ie(),D=L(()=>s.id||`switch-${p}`);function P(){d.value&&(d.value=!1)}function q(t){var e,r;t.stopPropagation(),t.preventDefault(),(r=(e=c.value)==null?void 0:e.input)==null||r.click()}return se(()=>{const[t,e]=ne(k),[r,i]=J.filterProps(s),[x,E]=K.filterProps(s);return a(J,j({class:["v-switch",{"v-switch--inset":s.inset},{"v-switch--indeterminate":d.value},C.value,s.class],style:s.style},t,r,{id:D.value,focused:w.value}),{...n,default:A=>{let{id:O,messagesId:Q,isDisabled:W,isReadonly:X,isValid:Y}=A;return a(K,j({ref:c},x,{modelValue:m.value,"onUpdate:modelValue":[_=>m.value=_,P],id:O.value,"aria-describedby":Q.value,type:"checkbox","aria-checked":d.value?"mixed":void 0,disabled:W.value,readonly:X.value,onFocus:v,onBlur:f},e),{...n,default:_=>{let{backgroundColorClasses:I,backgroundColorStyles:V}=_;return a("div",{class:["v-switch__track",...I.value],style:V.value,onClick:q},null)},input:_=>{let{inputNode:I,icon:V,backgroundColorClasses:Z,backgroundColorStyles:ee}=_;return a(re,null,[I,a("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":V||s.loading},s.inset?void 0:Z.value],style:s.inset?void 0:ee.value},[a(de,null,{default:()=>[s.loading?a(ce,{name:"v-switch",active:!0,color:Y.value===!1?void 0:B.value},{default:h=>n.loader?n.loader(h):a(me,{active:h.isActive,color:h.color,indeterminate:!0,size:"16",width:"2"},null)}):V&&a(ue,{key:V,icon:V,size:"x-small"},null)]})])])}})}})}),{}}}),Ae={class:"demo-space-x"},ta=fe({__name:"Index",setup(s){const F=ve(),{toast:k}=be(),n=pe({form:!1,excel:!1}),d=u({company_id:null,type_education_id:null,archive:null}),m=u({}),C=u(),w=u(),v=u([]),f=u(ke());f.value.allowedExtensions=["xls","xlsx"];const c=u(!1);Ve(async()=>{var r;n.form=!0;const{data:t,response:e}=await S("note-dataForm").get();n.form=!1,(r=e.value)!=null&&r.ok&&t.value&&(v.value=t.value.typeEducations,c.value=t.value.blockData)});const B=async()=>{var e;d.value.archive=f.value.imageFile,d.value.company_id=F.company.id;const t=await((e=C.value)==null?void 0:e.validate());if(t!=null&&t.valid){const r=new FormData;for(const i in d.value)r.append(i,d.value[i]);n.form=!0,await S("note-store").post(r),n.form=!1}else k("Faltan Campos Por Diligenciar","","danger")},p=u({type_education_id:null}),D=async()=>{var e,r;const t=await((e=w.value)==null?void 0:e.validate());if(t!=null&&t.valid){n.excel=!0;const i=v.value.find(A=>A.value==p.value.type_education_id),{data:x,response:E}=await S(Ce("/teacher-downloadAllConsolidated",{query:{type_education_id:p.value.type_education_id}}));n.excel=!1,(r=E.value)!=null&&r.ok&&x.value&&we(x.value.excel,"Consolidado "+(i==null?void 0:i.title))}else k("Faltan Campos Por Diligenciar","","danger")},P=async t=>{var i;const{data:e,response:r}=await S("/note-blockPayrollUpload").post({value:t});(i=r.value)!=null&&i.ok&&e.value},q=L(()=>c.value?"Sí":"No");return(t,e)=>{const r=ae;return M(),ge("div",null,[a(U,{disabled:l(n).form,loading:l(n).form},{default:o(()=>[a(T,{"primary-title":""},{default:o(()=>e[8]||(e[8]=[g("Cargar Notas")])),_:1}),a($,null,{default:o(()=>[a(l(R),{ref_key:"formValidation",ref:C,"lazy-validation":""},{default:o(()=>[a(b,null,{default:o(()=>[a(y,{cols:"12",sm:"4"},{default:o(()=>[a(r,{clearable:"",modelValue:l(d).type_education_id,"onUpdate:modelValue":e[0]||(e[0]=i=>l(d).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:l(N)],"error-messages":l(m).type_education_id,label:"Tipo",onChange:e[1]||(e[1]=i=>l(m).type_education_id=""),requiredField:!0,items:l(v)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),a(y,{cols:"12",sm:"4"},{default:o(()=>[a(Fe,null,{default:o(()=>e[9]||(e[9]=[g("Archivo "),G("b",{class:"text-warning"},"*",-1)])),_:1}),(M(),ye(Be,{key:l(f).key,onChange:l(f).handleImageSelected,"onClick:clear":l(f).clearData,rules:["requiredValidator"in t?t.requiredValidator:l(N)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),a(b,null,{default:o(()=>[a(y,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[a(H,{loading:l(n).form,disabled:l(n).form,color:"primary",onClick:e[2]||(e[2]=i=>B())},{default:o(()=>e[10]||(e[10]=[g(" Cargar ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),a(U,{disabled:l(n).form,loading:l(n).form,class:"mt-3"},{default:o(()=>[a(T,{"primary-title":""},{default:o(()=>e[11]||(e[11]=[g("Descargar Notas")])),_:1}),a($,null,{default:o(()=>[a(l(R),{ref_key:"formValidationDownload",ref:w,"lazy-validation":""},{default:o(()=>[a(b,null,{default:o(()=>[a(y,{cols:"12",sm:"4"},{default:o(()=>[a(r,{clearable:"",modelValue:l(p).type_education_id,"onUpdate:modelValue":e[3]||(e[3]=i=>l(p).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:l(N)],"error-messages":l(m).type_education_id,label:"Tipo",onChange:e[4]||(e[4]=i=>l(m).type_education_id=""),requiredField:!0,items:l(v)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),a(b,null,{default:o(()=>[a(y,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[a(H,{loading:l(n).excel,disabled:l(n).excel,color:"primary",onClick:e[5]||(e[5]=i=>D())},{default:o(()=>e[12]||(e[12]=[g(" Descargar ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),a(U,{disabled:l(n).form,loading:l(n).form,class:"mt-3"},{default:o(()=>[a(T,{"primary-title":""},{default:o(()=>e[13]||(e[13]=[g("Bloquear carga de notas a los profesores")])),_:1}),a($,null,{default:o(()=>[a(b,null,{default:o(()=>[a(y,{cols:"12",sm:"4"},{default:o(()=>[G("div",Ae,[a(qe,{modelValue:l(c),"onUpdate:modelValue":[e[6]||(e[6]=i=>_e(c)?c.value=i:null),e[7]||(e[7]=i=>P(i))],label:l(q),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])])}}});export{ta as default};
