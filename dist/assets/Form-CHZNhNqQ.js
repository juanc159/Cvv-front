import{r as $}from"./validators-Cp7WVmEz.js";import{d as x,V as T,r as p,t as N,aU as q,N as D,Y as U,c as A,o as y,b as t,f as l,e as h,l as a,a9 as j,h as M,y as S,a8 as L,D as P,aJ as g,aM as R,aV as E}from"./index-D0sM49mL.js";import{_ as G}from"./BtnBack.vue_vue_type_script_setup_true_lang-DV_2JSCc.js";import{_ as H}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-DOzw4GvJ.js";import{_ as I}from"./AppTextField.vue_vue_type_script_setup_true_lang-DEJs6s24.js";import{c as J}from"./createUrl-DS5RLUs9.js";import{a as O,V as Y}from"./VCard-DRHna_F7.js";import{V as k}from"./VCardText-9WVNqJ1f.js";import{V as z}from"./VForm-D8-BgDJr.js";import{V as K,a as V}from"./VRow-C1-JbHeK.js";import"./helpers-BRmCdlca.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-CRHRg-Cp.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BMqRF_1e.js";import"./VDialog-B3uzvltZ.js";import"./VOverlay-B0cld0mC.js";import"./VImg-BxMgm3Ky.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-DLdSC1Yt.js";import"./VInput-QdYFhTXO.js";import"./VTooltip-DzwvR-4L.js";import"./VTextField-CS16QMEt.js";/* empty css                   */import"./VCounter-D_AZ1Kne.js";import"./index-0F-JFElI.js";import"./VAvatar-6UTSTYcF.js";/* empty css              */const Q=h("span",null," Formulario periodo escolar ",-1),Be=x({__name:"Form",setup(W){const v=T(),{toast:F}=E(),f=p({}),c=p(!1),_=N(),b=p(),i=q({form:!1}),o=p({id:null,name:null,start_date:null,end_date:null,company_id:null}),w=()=>{for(const r in o.value)o.value[r]=null},C=async()=>{var n;o.value.id=_.params.id||null;const r=o.value.id?`/term/${o.value.id}/edit`:"/term/create";i.form=!0;const{data:e,response:d}=await g(J(`${r}`,{query:{company_id:v.company.id}}));i.form=!1,(n=d.value)!=null&&n.ok&&e.value&&e.value.form&&(o.value=e.value.form)},B=async()=>{var e,d;const r=await((e=b.value)==null?void 0:e.validate());if(r!=null&&r.valid){o.value.company_id=v.company.id;const n=o.value.id?`/term/update/${o.value.id}`:"/term/store";i.form=!0;const{data:m,response:s}=await g(n).post(o.value);i.form=!1,(d=s.value)!=null&&d.ok&&m.value&&m.value.code==200&&R.push({name:"Term-List"}),m.value.code===422&&(f.value=m.value.errors??{})}else F("Faltan Campos Por Diligenciar","","danger")};_.params.action=="view"&&(c.value=!0),D(async()=>{w(),_.params.id&&await C()});const u=U(()=>Object.values(i).some(r=>r));return(r,e)=>{const d=I,n=H,m=G;return y(),A("div",null,[t(Y,{disabled:a(i).form,loading:a(i).form},{default:l(()=>[t(O,{class:"d-flex justify-space-between"},{default:l(()=>[Q]),_:1}),t(k,null,{default:l(()=>[t(z,{ref_key:"formValidation",ref:b,onSubmit:j(()=>{},["prevent"]),disabled:a(c)},{default:l(()=>[t(K,null,{default:l(()=>[t(V,{cols:"12",sm:"3"},{default:l(()=>[t(d,{clearable:"",modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).name=s),rules:["requiredValidator"in r?r.requiredValidator:a($)],"error-messages":a(f).name,label:"Nombre",onInput:e[1]||(e[1]=s=>a(f).name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(V,{cols:"12",sm:"3"},{default:l(()=>[t(n,{clearable:"",modelValue:a(o).start_date,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).start_date=s),label:"Fecha inicio",placeholder:"Desde"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"3"},{default:l(()=>[t(n,{clearable:"",modelValue:a(o).end_date,"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).end_date=s),label:"Fecha fin",placeholder:"Hasta"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),t(k,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:l(()=>[t(m,{disabled:a(u),loading:a(u)},null,8,["disabled","loading"]),a(c)?S("",!0):(y(),M(L,{key:0,disabled:a(u),loading:a(u),onClick:e[4]||(e[4]=s=>B()),color:"primary"},{default:l(()=>[P(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Be as default};
