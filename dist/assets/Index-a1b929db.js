import{a as L}from"./formatters-1588bd0d.js";import{_ as P,a as R}from"./TableFullNew.vue_vue_type_script_setup_true_lang-ef38e87c.js";import{u as j}from"./useCrudTeacherStore-293b92ef.js";import{d as G,R as O,r as v,aF as q,o as l,c as u,b as e,f as n,e as x,ae as r,B as y,k as b,D as H,g as V,C as _,F as T,m as J,a6 as c,ac as p,af as F,q as K,E as M}from"./index-637629ed.js";import{S as B}from"./sweetalert2.esm.all-562d67d8.js";import{a as Q}from"./helpers-53221d8d.js";import{b as U,V as W}from"./VCard-934e654b.js";import{V as X}from"./VCardText-45e51a5a.js";import{V as Y}from"./VAvatar-a4c167fb.js";import{V as Z}from"./VImg-d8b48e6b.js";import{V as ee,a as te,b as ae}from"./VList-16301470.js";import{V as oe}from"./VChip-efe50c83.js";import{V as ne}from"./VDivider-b6156efd.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-db1cb66a.js";import"./VDialog-a1cc5e7f.js";import"./dialog-transition-50f617be.js";import"./VField-d9d754c0.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-9f8c8095.js";import"./VSelect-ac35f58e.js";import"./VTextField-3bf1c892.js";import"./VMenu-6006b8c8.js";import"./VRow-6e530c1e.js";/* empty css              */import"./VCol-6740a4e0.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-25440106.js";import"./_commonjsHelpers-725317a4.js";import"./createUrl-ed292c04.js";import"./index-9c720871.js";import"./VContainer-d2c7f379.js";import"./VPagination-d17cb170.js";import"./VDataTable-59f4f454.js";import"./ssrBoot-a08ea34b.js";const ie={class:"app-teacher-search-filter d-flex align-center flex-wrap gap-4"},re={key:1},je=G({__name:"Index",setup(se){const h=j(),D=O(),f=K(),d=async(o="create",t)=>{if(o=="order")return f.push({name:"Teacher-Order"}),!1;if(o=="planning")return f.push({name:"Teacher-Planning",params:{id:t}}),!1;f.push({name:"Teacher-Form",params:{action:o,id:t}})},N=async(o,t)=>{const s=!o[t];(await h.changeState({id:o.id,value:s,field:t})).code==200&&(o.state=s)},S=async o=>{B.fire({title:"¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async t=>{t.isConfirmed?(await h.fetchDelete(o),await g(C.value)):t.isDenied})},k=v(),z={url:"/teacher-list",headers:[{title:"Acciones",key:"actions"},{title:"Estado",key:"state"},{title:"Foto",key:"photo"},{title:"Tipo de educación",key:"type_education_name"},{title:"Cargo",key:"job_position_name"},{title:"Nombre(s)",key:"name"},{title:"Apellido(s)",key:"last_name"},{title:"Correo",key:"email"},{title:"Telefono",key:"phone"}],params:{company_id:D.company.id}},C=v({}),g=(o={})=>{C.value=o,k.value.changeFilter(o)},E=v({inputGeneral:{relationsGeneral:{all:["name","last_name","email","phone"],typeEducation:["name"],jobPosition:["name"]}},dialog:{width:500,inputs:[{input_type:"booleanActive",title:"Estado",key:"state"}]}}),w=q({excel:!1}),$=async o=>{var m;w.excel=!0;const{data:t,response:s}=await F("/teacher-downloadConsolidated/"+o.id).get();if(w.excel=!1,(m=s.value)!=null&&m.ok&&t.value){const a="Nómina "+o.name+" "+o.last_name;Q(t.value.excel,a)}},A=async o=>{B.fire({title:"¿Seguro desea reiniciar la contraseña al registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async t=>{t.isConfirmed?await F("/teacher-resetPassword/"+o).get():t.isDenied})};return(o,t)=>{const s=P,m=R;return l(),u("div",null,[e(W,null,{default:n(()=>[e(U,{class:"d-flex justify-space-between"},{default:n(()=>[t[4]||(t[4]=x("div",null," Listado de docentes ",-1)),x("div",ie,[e(r,{color:"primary",onClick:t[0]||(t[0]=a=>d("order"))},{default:n(()=>t[2]||(t[2]=[y(" Ordenar Docentes ")])),_:1}),e(r,{color:"primary",onClick:t[1]||(t[1]=a=>d())},{default:n(()=>t[3]||(t[3]=[y(" Crear Docente ")])),_:1})])]),_:1}),e(X,null,{default:n(()=>[e(s,{ref:"filterDialogNewRef",optionsFilter:b(E),onSendFilter:g},null,8,["optionsFilter"])]),_:1}),e(m,{ref_key:"tableFullNew",ref:k,optionsTable:z},{"item.photo":n(({item:a})=>[e(Y,{color:a.photo?"":"primary",class:H(a.photo?null:"v-avatar-light-bg primary--text"),variant:a.photo?void 0:"tonal"},{default:n(()=>[a.photo?(l(),V(Z,{key:0,src:a.photo},null,8,["src"])):(l(),u("span",re,_(("avatarText"in o?o.avatarText:b(L))(a.name+" "+a.last_name)),1))]),_:2},1032,["color","class","variant"])]),"item.subjects":n(({item:a})=>[e(ee,{border:""},{default:n(()=>[(l(!0),u(T,null,J(a.subjects,(i,I)=>(l(),u(T,{key:i.name},[e(te,null,{default:n(()=>[e(ae,null,{default:n(()=>[y(_(i),1)]),_:2},1024)]),_:2},1024),I!==a.subjects.length-1?(l(),V(ne,{key:0})):M("",!0)],64))),128))]),_:2},1024)]),"item.state":n(({item:a})=>[e(oe,{color:a.state==1?"success":"error",onClick:i=>N(a,"state")},{default:n(()=>[e(c,{start:"",size:"16",icon:a.state==1?"tabler-bell":"tabler-alert-circle"},null,8,["icon"]),x("span",null,_(a.state==1?"Activo":"Inactivo"),1),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Cambiar Estado"})]),_:2},1032,["color","onClick"])]),"item.actions":n(({item:a})=>[e(r,{icon:"",size:"x-small",color:"error",variant:"text",onClick:i=>S(a.id)},{default:n(()=>[e(c,{size:"22",icon:"tabler-trash"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]),e(r,{icon:"",size:"x-small",color:"default",variant:"text",onClick:i=>d("edit",a.id)},{default:n(()=>[e(c,{size:"22",icon:"tabler-edit"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Editar"})]),_:2},1032,["onClick"]),e(r,{icon:"",size:"x-small",color:"default",variant:"text",onClick:i=>d("planning",a.id)},{default:n(()=>[e(c,{size:"22",icon:"tabler-file"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Planificación"})]),_:2},1032,["onClick"]),e(r,{icon:"",size:"x-small",variant:"text",onClick:i=>$(a)},{default:n(()=>[e(c,{size:"22",icon:"tabler-file-download"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Descargar Nómina"})]),_:2},1032,["onClick"]),e(r,{icon:"",size:"x-small",variant:"text",onClick:i=>A(a.id)},{default:n(()=>[e(c,{size:"22",icon:"tabler-lock-open"}),e(p,{location:"top",transition:"scale-transition",activator:"parent",text:"Resetear contraseña"})]),_:2},1032,["onClick"])]),_:1},512)]),_:1})])}}});export{je as default};
