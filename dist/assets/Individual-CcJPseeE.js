import{s as ie,o as ne}from"./helpers-BfzLhQ1e.js";import{d as ue,V as se,r as d,Y as de,c as A,o as _,b as e,f as a,a7 as h,e as y,b3 as Q,y as I,l as ce,E as F,D as v,F as me,q as fe,G as pe,h as T,a9 as N,ac as U,b1 as B,b2 as Z,Z as ve,$ as be}from"./index-93_j09My.js";import{_ as Ve}from"./AppSelect.vue_vue_type_script_setup_true_lang-Qf7nw74J.js";import{_ as _e}from"./AppTextField.vue_vue_type_script_setup_true_lang-KB5ef6Vr.js";import{_ as ye}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-Dlet4nUS.js";import{_ as ge}from"./AppSelectRemote-Bfc0OzLc.js";import{a as H,V as L}from"./VCard-OGc-DDIT.js";import{V as M}from"./VCardText-DZVsmiGZ.js";import{V as b,a as n}from"./VRow-CvF-SjZm.js";import{V as Ce}from"./VAvatar-C0IYOk3R.js";import{V as qe}from"./VImg-BRWFuLhl.js";import{V as K}from"./VDivider-DppjqGkO.js";import{V as z}from"./VForm-DIvPrC_7.js";import{V as he}from"./VSpacer-DA_zepTj.js";import{V as Fe}from"./VDialog-Uv8fEMsR.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-2GBt7OCP.js";import"./VSelect-BkbS8jF8.js";import"./VTextField-D8Qol1_P.js";/* empty css                   */import"./VCounter-DOEiHj1X.js";import"./VList-DAa29NIs.js";import"./ssrBoot-BuP6lpU6.js";import"./dialog-transition-8lJLbDx8.js";import"./VMenu-CyrLEex3.js";import"./VCheckboxBtn-DwouF2KZ.js";import"./VSelectionControl-BWywn0CY.js";import"./VChip-RLUPYYWW.js";/* empty css              */const W=S=>(ve("data-v-3f035471"),S=S(),be(),S),xe=W(()=>y("span",{class:"text-white text-h5"},"Generador de constancias individuales",-1)),Ie={class:"search-section mb-6"},we={key:0,class:"student-info mb-6"},De={class:"text-h5 mb-2"},$e={class:"text-body-1 mb-1"},Ee={key:0,class:"certificates-section"},Te=W(()=>y("h3",{class:"text-h6 mb-4"},"Seleccione el tipo de constancia",-1)),Se={class:"d-flex align-center mb-3"},Ae={class:"text-h6"},Ne={class:"text-body-2 text-grey-darken-1"},Ue={class:"text-h6 font-weight-bold"},Be=ue({__name:"Individual",setup(S){var J;const X=se(),$=d(""),u=d(null),k=d(!1),r=d(null),g=d(!0),E=d(null),x=d(!1),m=d({name:"",documentType:"V",documentNumber:""}),f=d({name:"",documentType:"V",documentNumber:""}),p=d({startDate:"",endDate:""}),s=d({registrationFee:68,monthlyFee:68,educationalCouncilFee:25,totalAmount:0}),G=de(()=>s.value.registrationFee+s.value.monthlyFee+s.value.educationalCouncilFee),V=async(o,l,j)=>{try{const{data:C,response:c}=await Z(o).get({params:{additionalInfo:j}});if(c.status===200&&(C!=null&&C.pdf))ne(C.pdf);else throw new Error("Invalid response format")}catch(C){console.error(`Error downloading certificate from ${o}:`,C)}},ee=[{id:1,title:"Constancia de Estudios",icon:"tabler-school",description:"Certifica que el estudiante está inscrito y cursando estudios.",handler:o=>V(`/documents/certificate/${o}`)},{id:2,title:"Constancia de Culminación",icon:"tabler-user-check",description:"Documenta la finalización exitosa de un período académico.",handler:o=>V(`/documents/certificate-completion/${o}`)},{id:3,title:"Constancia de no poseer beca",icon:"tabler-notebook",description:"Confirma que el estudiante no recibe becas institucionales.",handler:o=>V(`/documents/proof-no-scholarship/${o}`)},{id:4,title:"Constancia de Aprobación",icon:"tabler-coin",description:"Certifica la aprobación de materias o cursos específicos.",handler:o=>V(`/documents/certificate-approval/${o}`)},{id:5,title:"Constancia de Buena Conducta",icon:"tabler-shield-check",description:"Atestigua el buen comportamiento del estudiante.",handler:o=>V(`/documents/certificate-good-conduct/${o}`)},{id:6,title:"Constancia de Inscripción",icon:"tabler-calendar-check",description:"Verifica la inscripción del estudiante en la institución.",handler:o=>V(`/documents/certificate-enrollment/${o}`)},{id:7,title:"Constancia de Transportista",icon:"tabler-bus",description:"Certifica al transportista autorizado del estudiante.",requiresAdditionalInfo:!0,handler:(o,l)=>V(`/documents/certificate-transporter/${o}`,o,l)},{id:8,title:"Constancia de Inscripción por monto",icon:"tabler-receipt",description:"Detalla los montos pagados por inscripción y mensualidades.",requiresAdditionalInfo:!0,handler:(o,l)=>V(`/documents/certificate-enrollment-amount/${o}`,o,l)},{id:9,title:"Constancia de Retiro",icon:"tabler-logout",description:"Documenta el retiro del estudiante de la institución.",requiresAdditionalInfo:!0,handler:(o,l)=>V(`/documents/certificate-withdrawal/${o}`,o,l)}],le=async()=>{const o=E.value;if(!o)return!1;const{valid:l}=await o.validate();return l},ae=async()=>{if($.value){k.value=!0;try{const{response:o,data:l}=await Z(`/documents/${$.value}/show`).get();o.status===200&&(l!=null&&l.student)&&(u.value=l.student)}catch(o){console.error("Error al buscar estudiante:",o)}finally{k.value=!1}}},te=o=>{r.value=o,m.value={name:"",documentType:"V",documentNumber:""},f.value={name:"",documentType:"V",documentNumber:""},p.value={startDate:"",endDate:""},s.value={registrationFee:0,monthlyFee:0,educationalCouncilFee:0,totalAmount:0},o.requiresAdditionalInfo&&(x.value=!0)},w=async(o=!0)=>{if(!(!u.value||!r.value)&&!(o&&!await le())){k.value=!0;try{let l=null;if(r.value.id===7){if(!m.value.name||!m.value.documentNumber)return;l=m.value}else if(r.value.id===8)s.value.totalAmount=G.value,l=s.value;else if(r.value.id===9){if(!f.value.name||!f.value.documentNumber)return;l=f.value}else if(r.value.id===10){if(!p.value.startDate||!p.value.endDate)return;l=p.value}await r.value.handler(u.value.id,l),x.value=!1}catch(l){console.error("Error al generar certificado:",l)}finally{k.value=!1}}},R=()=>{u.value=null,r.value=null,$.value="",x.value=!1},P=[{value:"V",title:"V"},{value:"E",title:"E"},{value:"J",title:"J"},{value:"P",title:"P"}],oe=(o=!1)=>{x.value=o},re=d({company_id:(J=X.company)==null?void 0:J.id});return(o,l)=>{const j=ge,C=ye,c=_e,Y=Ve;return _(),A("div",null,[e(L,{class:"elevation-3",loading:k.value},{default:a(()=>[e(H,{class:"d-flex align-center pa-4 bg-primary"},{default:a(()=>[e(h,{icon:"tabler-certificate",class:"me-2",color:"white"}),xe]),_:1}),e(M,{class:"pa-6"},{default:a(()=>[y("div",Ie,[e(b,null,{default:a(()=>[e(n,{cols:"12",md:"8",class:"mx-auto"},{default:a(()=>[e(j,{"return-object":!1,modelValue:$.value,"onUpdate:modelValue":[l[0]||(l[0]=i=>$.value=i),ae],url:"selectInfiniteStudent",arrayInfo:"student",label:"Estudiante","onClick:clear":R,params:re.value},null,8,["modelValue","params"])]),_:1})]),_:1})]),e(Q,null,{default:a(()=>[u.value?(_(),A("div",we,[e(L,{class:"pa-4 bg-grey-lighten-4"},{default:a(()=>[e(b,{align:"center"},{default:a(()=>[e(n,{cols:"12",sm:"3"},{default:a(()=>[e(Ce,{size:"100",class:"elevation-2"},{default:a(()=>[e(qe,{src:("storageBack"in o?o.storageBack:ce(ie))(u.value.photo),cover:""},null,8,["src"])]),_:1})]),_:1}),e(n,{cols:"12",sm:"9"},{default:a(()=>[y("h3",De,F(u.value.full_name),1),y("p",$e,[e(h,{icon:"tabler-school",class:"me-2"}),v(" "+F(u.value.type_education_name)+", "+F(u.value.grade_name)+" "+F(u.value.section_name),1)])]),_:1})]),_:1})]),_:1})])):I("",!0)]),_:1}),e(Q,null,{default:a(()=>[u.value?(_(),A("div",Ee,[Te,e(b,null,{default:a(()=>[(_(),A(me,null,fe(ee,i=>e(n,{key:i.id,cols:"12",sm:"6",md:"4"},{default:a(()=>{var q;return[e(L,{class:pe(["certificate-card pa-4 cursor-pointer",{selected:((q=r.value)==null?void 0:q.id)===i.id}]),onClick:D=>te(i),elevation:"2",hover:""},{default:a(()=>{var D;return[y("div",Se,[e(h,{icon:i.icon,size:"32",class:"me-3",color:((D=r.value)==null?void 0:D.id)===i.id?"primary":"grey"},null,8,["icon","color"]),y("h4",Ae,F(i.title),1)]),y("p",Ne,F(i.description),1)]}),_:2},1032,["class","onClick"])]}),_:2},1024)),64))]),_:1})])):I("",!0)]),_:1})]),_:1}),e(K),e(M,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:a(()=>[e(N,{color:"error",variant:"outlined",onClick:R,disabled:!u.value},{default:a(()=>[e(h,{icon:"tabler-x",class:"me-2"}),v(" Cancelar ")]),_:1},8,["disabled"]),r.value&&!r.value.requiresAdditionalInfo?(_(),T(N,{key:0,color:"primary",onClick:l[1]||(l[1]=i=>w(!1)),disabled:!u.value||!r.value,loading:k.value},{default:a(()=>[e(h,{icon:"tabler-printer",class:"me-2"}),v(" Generar Constancia ")]),_:1},8,["disabled","loading"])):I("",!0)]),_:1})]),_:1},8,["loading"]),e(Fe,{modelValue:x.value,"onUpdate:modelValue":l[19]||(l[19]=i=>x.value=i),width:"600",persistent:""},{default:a(()=>[e(C,{onClick:l[2]||(l[2]=i=>oe())}),e(L,null,{default:a(()=>[e(H,{class:"bg-primary text-white pa-4"},{default:a(()=>{var i,q;return[e(h,{icon:(i=r.value)==null?void 0:i.icon,class:"me-2",color:"white"},null,8,["icon"]),v(" "+F((q=r.value)==null?void 0:q.title),1)]}),_:1}),e(M,{class:"pa-6"},{default:a(()=>{var i,q,D,O;return[((i=r.value)==null?void 0:i.id)===7?(_(),T(z,{key:0,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[6]||(l[6]=t=>g.value=t),ref_key:"form",ref:E},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(c,{clearable:"",modelValue:m.value.name,"onUpdate:modelValue":l[3]||(l[3]=t=>m.value.name=t),label:"Nombre del Transportista",rules:[t=>!!t||"El nombre es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(Y,{modelValue:m.value.documentType,"onUpdate:modelValue":l[4]||(l[4]=t=>m.value.documentType=t),items:P,label:"Tipo de Documento",required:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"8"},{default:a(()=>[e(c,{clearable:"",modelValue:m.value.documentNumber,"onUpdate:modelValue":l[5]||(l[5]=t=>m.value.documentNumber=t),label:"Número de Documento",rules:[t=>!!t||"El número de documento es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((q=r.value)==null?void 0:q.id)===8?(_(),T(z,{key:1,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[10]||(l[10]=t=>g.value=t),ref_key:"form",ref:E},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(B,null,{default:a(()=>[v("Inscripción:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(c,{requiredField:!0,clearable:"",modelValue:s.value.registrationFee,"onUpdate:modelValue":l[7]||(l[7]=t=>s.value.registrationFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(B,null,{default:a(()=>[v("Mensualidad Septiembre:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(c,{requiredField:!0,clearable:"",modelValue:s.value.monthlyFee,"onUpdate:modelValue":l[8]||(l[8]=t=>s.value.monthlyFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(B,null,{default:a(()=>[v("Consejo Educativo:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(c,{requiredField:!0,clearable:"",modelValue:s.value.educationalCouncilFee,"onUpdate:modelValue":l[9]||(l[9]=t=>s.value.educationalCouncilFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(b,{class:"mt-4"},{default:a(()=>[e(n,{cols:"8"},{default:a(()=>[e(B,{class:"font-weight-bold"},{default:a(()=>[v("TOTAL:")]),_:1})]),_:1}),e(n,{cols:"4"},{default:a(()=>[y("div",Ue,"$ "+F(G.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((D=r.value)==null?void 0:D.id)===9?(_(),T(z,{key:2,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[14]||(l[14]=t=>g.value=t),ref_key:"form",ref:E},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(c,{clearable:"",modelValue:f.value.name,"onUpdate:modelValue":l[11]||(l[11]=t=>f.value.name=t),label:"Nombre del Representante",rules:[t=>!!t||"El nombre es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(Y,{requiredField:!0,clearable:"",modelValue:f.value.documentType,"onUpdate:modelValue":l[12]||(l[12]=t=>f.value.documentType=t),items:P,label:"Tipo de Documento",required:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"8"},{default:a(()=>[e(c,{clearable:"",modelValue:f.value.documentNumber,"onUpdate:modelValue":l[13]||(l[13]=t=>f.value.documentNumber=t),label:"Número de Documento",rules:[t=>!!t||"El número de documento es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((O=r.value)==null?void 0:O.id)===10?(_(),T(z,{key:3,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[17]||(l[17]=t=>g.value=t),ref_key:"form",ref:E},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(c,{requiredField:!0,clearable:"",type:"date",modelValue:p.value.startDate,"onUpdate:modelValue":l[15]||(l[15]=t=>p.value.startDate=t),label:"Fecha de Inicio",rules:[t=>!!t||"La fecha de inicio es requerida"],required:""},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(c,{requiredField:!0,clearable:"",type:"date",modelValue:p.value.endDate,"onUpdate:modelValue":l[16]||(l[16]=t=>p.value.endDate=t),label:"Fecha de Fin",rules:[t=>!!t||"La fecha de fin es requerida",t=>!p.value.startDate||t>=p.value.startDate||"La fecha de fin debe ser posterior a la fecha de inicio"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0)]}),_:1}),e(K),e(M,{class:"d-flex align-center justify-center gap-4"},{default:a(()=>[e(he),e(N,{color:"error",variant:"outlined",onClick:l[18]||(l[18]=i=>x.value=!1)},{default:a(()=>[e(h,{icon:"tabler-x",class:"me-2"}),v(" Cancelar ")]),_:1}),e(N,{color:"primary",onClick:w,loading:k.value,disabled:!u.value||!r.value},{default:a(()=>[e(h,{icon:"tabler-printer",class:"me-2"}),v(" Generar Constancia ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),fl=ke(Be,[["__scopeId","data-v-3f035471"]]);export{fl as default};
