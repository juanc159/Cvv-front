import{s as te,o as oe}from"./helpers-hDk3bok4.js";import{d as re,r as c,X as ie,c as N,o as _,b as e,f as a,a8 as h,e as y,az as O,x as I,k as ne,D as F,C as b,F as ue,p as se,E as de,g as T,ad as S,ac as U,Y as ce,Z as me}from"./index-BYu3Aotl.js";import{_ as fe}from"./AppSelect.vue_vue_type_script_setup_true_lang-Cj90EGUo.js";import{_ as pe}from"./AppTextField.vue_vue_type_script_setup_true_lang-Dj6dFjFT.js";import{_ as ve}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-j4M0_081.js";import{_ as be}from"./AppSelectRemote-C5Co6UoF.js";import{u as Q}from"./useAxios-D2b_tHuN.js";import{b as X,V as B}from"./VCard-CICZTXit.js";import{V as z}from"./VCardText-Cf9xB4IO.js";import{V,a as n}from"./VRow-CkJ_F-yM.js";import{V as Ve}from"./VAvatar-BKQ4HbMx.js";import{V as _e}from"./VImg-D5JssCPZ.js";import{V as Z}from"./VDivider-1TAkoqSH.js";import{V as L}from"./VForm-C0hJ-QVa.js";import{V as M}from"./VInput-BI_Ymx9b.js";import{V as ye}from"./VSpacer-DKD24B6j.js";import{V as ge}from"./VDialog-DRK1jySI.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-2GBt7OCP.js";import"./VTooltip-8w8Jopf2.js";import"./VOverlay-Dv5GNhiB.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-BZ697rR4.js";import"./VTextField-DEVbzHjg.js";/* empty css                   */import"./VCounter-DXX86pg_.js";import"./VList-CP5YwXy-.js";import"./ssrBoot-dLtEUK4N.js";import"./dialog-transition-DzWOimIt.js";import"./VMenu-DL7aQx7O.js";import"./VCheckboxBtn-B843rXou.js";import"./VSelectionControl-BcMywpJl.js";import"./VChip-DpsaPqtn.js";/* empty css              */const H=A=>(ce("data-v-e61e190f"),A=A(),me(),A),qe=H(()=>y("span",{class:"text-white text-h5"},"Generador de Constancias",-1)),he={class:"search-section mb-6"},Fe={key:0,class:"student-info mb-6"},ke={class:"text-h5 mb-2"},xe={class:"text-body-1 mb-1"},Ie={key:0,class:"certificates-section"},we=H(()=>y("h3",{class:"text-h6 mb-4"},"Seleccione el tipo de constancia",-1)),De={class:"d-flex align-center mb-3"},Ee={class:"text-h6"},$e={class:"text-body-2 text-grey-darken-1"},Te={class:"text-h6 font-weight-bold"},Ae=re({__name:"Index",setup(A){const E=c(""),u=c(null),k=c(!1),r=c(null),g=c(!0),$=c(null),x=c(!1),m=c({name:"",documentType:"V",documentNumber:""}),f=c({name:"",documentType:"V",documentNumber:""}),p=c({startDate:"",endDate:""}),s=c({registrationFee:68,monthlyFee:68,educationalCouncilFee:25,totalAmount:0}),P=ie(()=>s.value.registrationFee+s.value.monthlyFee+s.value.educationalCouncilFee),v=async(o,l,j)=>{try{const{data:C,response:d}=await Q(o).get({params:{additionalInfo:j}});if(d.status===200&&(C!=null&&C.pdf))oe(C.pdf);else throw new Error("Invalid response format")}catch(C){console.error(`Error downloading certificate from ${o}:`,C)}},K=[{id:1,title:"Constancia de Estudios",icon:"tabler-school",description:"Certifica que el estudiante está inscrito y cursando estudios.",handler:o=>v(`/documents/certificate/${o}`)},{id:2,title:"Constancia de Culminación",icon:"tabler-user-check",description:"Documenta la finalización exitosa de un período académico.",handler:o=>v(`/documents/certificate-completion/${o}`)},{id:3,title:"Constancia de no poseer beca",icon:"tabler-notebook",description:"Confirma que el estudiante no recibe becas institucionales.",handler:o=>v(`/documents/proof-no-scholarship/${o}`)},{id:4,title:"Constancia de Aprobación",icon:"tabler-coin",description:"Certifica la aprobación de materias o cursos específicos.",handler:o=>v(`/documents/certificate-approval/${o}`)},{id:5,title:"Constancia de Buena Conducta",icon:"tabler-shield-check",description:"Atestigua el buen comportamiento del estudiante.",handler:o=>v(`/documents/certificate-good-conduct/${o}`)},{id:6,title:"Constancia de Inscripción",icon:"tabler-calendar-check",description:"Verifica la inscripción del estudiante en la institución.",handler:o=>v(`/documents/certificate-enrollment/${o}`)},{id:7,title:"Constancia de Transportista",icon:"tabler-bus",description:"Certifica al transportista autorizado del estudiante.",requiresAdditionalInfo:!0,handler:(o,l)=>v(`/documents/certificate-transporter/${o}`,o,l)},{id:8,title:"Constancia de Inscripción por monto",icon:"tabler-receipt",description:"Detalla los montos pagados por inscripción y mensualidades.",requiresAdditionalInfo:!0,handler:(o,l)=>v(`/documents/certificate-enrollment-amount/${o}`,o,l)},{id:9,title:"Constancia de Retiro",icon:"tabler-logout",description:"Documenta el retiro del estudiante de la institución.",requiresAdditionalInfo:!0,handler:(o,l)=>v(`/documents/certificate-withdrawal/${o}`,o,l)},{id:10,title:"Permiso de Ausencia Escolar",icon:"tabler-calendar-off",description:"Autoriza la ausencia del estudiante por un período específico.",requiresAdditionalInfo:!0,handler:(o,l)=>v(`/documents/absence-permission/${o}`,o,l)}],W=async()=>{const o=$.value;if(!o)return!1;const{valid:l}=await o.validate();return l},ee=async()=>{if(E.value){k.value=!0;try{const{response:o,data:l}=await Q(`/documents/${E.value}/show`).get();o.status===200&&(l!=null&&l.student)&&(u.value=l.student)}catch(o){console.error("Error al buscar estudiante:",o)}finally{k.value=!1}}},le=o=>{r.value=o,m.value={name:"",documentType:"V",documentNumber:""},f.value={name:"",documentType:"V",documentNumber:""},p.value={startDate:"",endDate:""},s.value={registrationFee:0,monthlyFee:0,educationalCouncilFee:0,totalAmount:0},o.requiresAdditionalInfo&&(x.value=!0)},w=async(o=!0)=>{if(!(!u.value||!r.value)&&!(o&&!await W())){console.log("aaaaaaaaaaa"),k.value=!0;try{let l=null;if(r.value.id===7){if(!m.value.name||!m.value.documentNumber)return;l=m.value}else if(r.value.id===8)s.value.totalAmount=P.value,l=s.value;else if(r.value.id===9){if(!f.value.name||!f.value.documentNumber)return;l=f.value}else if(r.value.id===10){if(!p.value.startDate||!p.value.endDate)return;l=p.value}await r.value.handler(u.value.id,l),x.value=!1}catch(l){console.error("Error al generar certificado:",l)}finally{k.value=!1}}},R=()=>{u.value=null,r.value=null,E.value="",x.value=!1},G=[{value:"V",title:"V"},{value:"E",title:"E"},{value:"J",title:"J"},{value:"P",title:"P"}],ae=(o=!1)=>{x.value=o};return(o,l)=>{const j=be,C=ve,d=pe,J=fe;return _(),N("div",null,[e(B,{class:"elevation-3",loading:k.value},{default:a(()=>[e(X,{class:"d-flex align-center pa-4 bg-primary"},{default:a(()=>[e(h,{icon:"tabler-certificate",class:"me-2",color:"white"}),qe]),_:1}),e(z,{class:"pa-6"},{default:a(()=>[y("div",he,[e(V,null,{default:a(()=>[e(n,{cols:"12",md:"8",class:"mx-auto"},{default:a(()=>[e(j,{"return-object":!1,modelValue:E.value,"onUpdate:modelValue":[l[0]||(l[0]=i=>E.value=i),ee],url:"selectInfiniteStudent",arrayInfo:"student",label:"Estudiante","onClick:clear":R},null,8,["modelValue"])]),_:1})]),_:1})]),e(O,null,{default:a(()=>[u.value?(_(),N("div",Fe,[e(B,{class:"pa-4 bg-grey-lighten-4"},{default:a(()=>[e(V,{align:"center"},{default:a(()=>[e(n,{cols:"12",sm:"3"},{default:a(()=>[e(Ve,{size:"100",class:"elevation-2"},{default:a(()=>[e(_e,{src:("storageBack"in o?o.storageBack:ne(te))(u.value.photo),cover:""},null,8,["src"])]),_:1})]),_:1}),e(n,{cols:"12",sm:"9"},{default:a(()=>[y("h3",ke,F(u.value.full_name),1),y("p",xe,[e(h,{icon:"tabler-school",class:"me-2"}),b(" "+F(u.value.type_education_name)+", "+F(u.value.grade_name)+" "+F(u.value.section_name),1)])]),_:1})]),_:1})]),_:1})])):I("",!0)]),_:1}),e(O,null,{default:a(()=>[u.value?(_(),N("div",Ie,[we,e(V,null,{default:a(()=>[(_(),N(ue,null,se(K,i=>e(n,{key:i.id,cols:"12",sm:"6",md:"4"},{default:a(()=>{var q;return[e(B,{class:de(["certificate-card pa-4 cursor-pointer",{selected:((q=r.value)==null?void 0:q.id)===i.id}]),onClick:D=>le(i),elevation:"2",hover:""},{default:a(()=>{var D;return[y("div",De,[e(h,{icon:i.icon,size:"32",class:"me-3",color:((D=r.value)==null?void 0:D.id)===i.id?"primary":"grey"},null,8,["icon","color"]),y("h4",Ee,F(i.title),1)]),y("p",$e,F(i.description),1)]}),_:2},1032,["class","onClick"])]}),_:2},1024)),64))]),_:1})])):I("",!0)]),_:1})]),_:1}),e(Z),e(z,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:a(()=>[e(S,{color:"error",variant:"outlined",onClick:R,disabled:!u.value},{default:a(()=>[e(h,{icon:"tabler-x",class:"me-2"}),b(" Cancelar ")]),_:1},8,["disabled"]),r.value&&!r.value.requiresAdditionalInfo?(_(),T(S,{key:0,color:"primary",onClick:l[1]||(l[1]=i=>w(!1)),disabled:!u.value||!r.value,loading:k.value},{default:a(()=>[e(h,{icon:"tabler-printer",class:"me-2"}),b(" Generar Constancia ")]),_:1},8,["disabled","loading"])):I("",!0)]),_:1})]),_:1},8,["loading"]),e(ge,{modelValue:x.value,"onUpdate:modelValue":l[19]||(l[19]=i=>x.value=i),width:"600",persistent:""},{default:a(()=>[e(C,{onClick:l[2]||(l[2]=i=>ae())}),e(B,null,{default:a(()=>[e(X,{class:"bg-primary text-white pa-4"},{default:a(()=>{var i,q;return[e(h,{icon:(i=r.value)==null?void 0:i.icon,class:"me-2",color:"white"},null,8,["icon"]),b(" "+F((q=r.value)==null?void 0:q.title),1)]}),_:1}),e(z,{class:"pa-6"},{default:a(()=>{var i,q,D,Y;return[((i=r.value)==null?void 0:i.id)===7?(_(),T(L,{key:0,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[6]||(l[6]=t=>g.value=t),ref_key:"form",ref:$},{default:a(()=>[e(V,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(d,{clearable:"",modelValue:m.value.name,"onUpdate:modelValue":l[3]||(l[3]=t=>m.value.name=t),label:"Nombre del Transportista",rules:[t=>!!t||"El nombre es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(J,{modelValue:m.value.documentType,"onUpdate:modelValue":l[4]||(l[4]=t=>m.value.documentType=t),items:G,label:"Tipo de Documento",required:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"8"},{default:a(()=>[e(d,{clearable:"",modelValue:m.value.documentNumber,"onUpdate:modelValue":l[5]||(l[5]=t=>m.value.documentNumber=t),label:"Número de Documento",rules:[t=>!!t||"El número de documento es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((q=r.value)==null?void 0:q.id)===8?(_(),T(L,{key:1,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[10]||(l[10]=t=>g.value=t),ref_key:"form",ref:$},{default:a(()=>[e(V,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(M,null,{default:a(()=>[b("Inscripción:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",modelValue:s.value.registrationFee,"onUpdate:modelValue":l[7]||(l[7]=t=>s.value.registrationFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(V,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(M,null,{default:a(()=>[b("Mensualidad Septiembre:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",modelValue:s.value.monthlyFee,"onUpdate:modelValue":l[8]||(l[8]=t=>s.value.monthlyFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(V,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(M,null,{default:a(()=>[b("Consejo Educativo:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",modelValue:s.value.educationalCouncilFee,"onUpdate:modelValue":l[9]||(l[9]=t=>s.value.educationalCouncilFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(V,{class:"mt-4"},{default:a(()=>[e(n,{cols:"8"},{default:a(()=>[e(M,{class:"font-weight-bold"},{default:a(()=>[b("TOTAL:")]),_:1})]),_:1}),e(n,{cols:"4"},{default:a(()=>[y("div",Te,"$ "+F(P.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((D=r.value)==null?void 0:D.id)===9?(_(),T(L,{key:2,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[14]||(l[14]=t=>g.value=t),ref_key:"form",ref:$},{default:a(()=>[e(V,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(d,{clearable:"",modelValue:f.value.name,"onUpdate:modelValue":l[11]||(l[11]=t=>f.value.name=t),label:"Nombre del Representante",rules:[t=>!!t||"El nombre es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(J,{requiredField:!0,clearable:"",modelValue:f.value.documentType,"onUpdate:modelValue":l[12]||(l[12]=t=>f.value.documentType=t),items:G,label:"Tipo de Documento",required:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"8"},{default:a(()=>[e(d,{clearable:"",modelValue:f.value.documentNumber,"onUpdate:modelValue":l[13]||(l[13]=t=>f.value.documentNumber=t),label:"Número de Documento",rules:[t=>!!t||"El número de documento es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((Y=r.value)==null?void 0:Y.id)===10?(_(),T(L,{key:3,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[17]||(l[17]=t=>g.value=t),ref_key:"form",ref:$},{default:a(()=>[e(V,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",type:"date",modelValue:p.value.startDate,"onUpdate:modelValue":l[15]||(l[15]=t=>p.value.startDate=t),label:"Fecha de Inicio",rules:[t=>!!t||"La fecha de inicio es requerida"],required:""},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",type:"date",modelValue:p.value.endDate,"onUpdate:modelValue":l[16]||(l[16]=t=>p.value.endDate=t),label:"Fecha de Fin",rules:[t=>!!t||"La fecha de fin es requerida",t=>!p.value.startDate||t>=p.value.startDate||"La fecha de fin debe ser posterior a la fecha de inicio"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0)]}),_:1}),e(Z),e(z,{class:"d-flex align-center justify-center gap-4"},{default:a(()=>[e(ye),e(S,{color:"error",variant:"outlined",onClick:l[18]||(l[18]=i=>x.value=!1)},{default:a(()=>[e(h,{icon:"tabler-x",class:"me-2"}),b(" Cancelar ")]),_:1}),e(S,{color:"primary",onClick:w,loading:k.value,disabled:!u.value||!r.value},{default:a(()=>[e(h,{icon:"tabler-printer",class:"me-2"}),b(" Generar Constancia ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),pl=Ce(Ae,[["__scopeId","data-v-e61e190f"]]);export{pl as default};
