import{_ as Ve}from"./BtnBack.vue_vue_type_script_setup_true_lang-CVhwYgKW.js";import{_ as Pe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-C0YRAML3.js";import{_ as ke}from"./AppSelectRemote-BEi18a5r.js";import{_ as he}from"./AppTextField.vue_vue_type_script_setup_true_lang-Bv5NlyTN.js";import{_ as Ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-ByqahL2b.js";import{ag as O,ah as z,a1 as ue,ai as Q,b as a,aG as Se,ak as te,P as de,Q as Ce,aH as Ie,am as re,X as V,aI as we,aJ as ce,a8 as Ae,aw as ie,aK as Te,aL as $e,an as Fe,aj as me,au as Re,aM as je,aN as Be,$ as Ne,aO as De,aP as Ue,aQ as Le,a7 as x,at as Ge,aR as Me,aS as qe,d as Oe,U as ze,q as Qe,r as $,ax as He,M as Je,c as h,o as p,f as s,ac as Ke,g as G,x as R,F as M,p as q,C as Y,D as y,ad as Z,e as f,k as Xe,E as Ye,af as Ze,al as We,ay as ea,Y as aa,Z as ta}from"./index-D51GRe6t.js";import{c as la}from"./createUrl-CN7FkQCt.js";import{u as na}from"./useAxios-DW8bvlc7.js";import{b as sa,V as oa}from"./VCard-CL0_f1Rv.js";import{V as W}from"./VCardText-BG9Be0VU.js";import{V as ia}from"./VForm-HzVY-XEm.js";import{V as j,a as E}from"./VRow-AzIICDfk.js";import{u as ua,m as da}from"./VOverlay-BKCzoZnS.js";import{V as ra}from"./VTable-DyDNuAbG.js";import{_ as ca}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-osgM7-BI.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-Dn7MW0hk.js";import"./VDialog-DEHTgb_t.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-B6ybcPVi.js";import"./VInput-DOt6-JQk.js";import"./VImg-BAMlD0AI.js";import"./VTooltip-B0MeQ_W-.js";import"./VSelect-DsHnhIbc.js";import"./VTextField-D1dTraZf.js";/* empty css                   */import"./VCounter-Cq_xbMWB.js";import"./VList-CwHYFaLE.js";import"./ssrBoot-FcSyyOeW.js";import"./VAvatar-YSQqMGG0.js";import"./VDivider-BNBB-q-1.js";import"./VMenu-BU6phFtj.js";import"./VCheckboxBtn-DYkEu2zv.js";import"./VSelectionControl-BAtgv-0e.js";import"./VChip-cwtQUJt7.js";import"./filter-mrmxV9Mf.js";import"./helpers-DdkYGSV2.js";import"./constants-2GBt7OCP.js";import"./index-0F-JFElI.js";/* empty css              */const B=Symbol.for("vuetify:v-expansion-panel"),pe=z({...te(),...da()},"VExpansionPanelText"),ee=O()({name:"VExpansionPanelText",props:pe(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:r}=ua(e,n.isSelected);return Q(()=>a(Se,{onAfterLeave:r},{default:()=>{var _;return[de(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&u.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(_=o.default)==null?void 0:_.call(o)])]),[[Ce,n.isSelected.value]])]}})),{}}}),ve=z({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...te()},"VExpansionPanelTitle"),ae=O()({name:"VExpansionPanelTitle",directives:{Ripple:Ie},props:ve(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"color"),_=V(()=>({collapseIcon:e.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),m=V(()=>n.isSelected.value?e.collapseIcon:e.expandIcon);return Q(()=>{var S;return de(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[r.value,e.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:e.readonly?void 0:n.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(S=o.default)==null?void 0:S.call(o,_.value),!e.hideActions&&a(ce,{defaults:{VIcon:{icon:m.value}}},{default:()=>{var P;return[a("span",{class:"v-expansion-panel-title__icon"},[((P=o.actions)==null?void 0:P.call(o,_.value))??a(Ae,null,null)])]}})]),[[we("ripple"),e.ripple]])}),{}}}),fe=z({title:String,text:String,bgColor:String,...Be(),...je(),...Re(),...me(),...ve(),...pe()},"VExpansionPanel"),ma=O()({name:"VExpansionPanel",props:fe(),emits:{"group:selected":e=>!0},setup(e,b){let{slots:o}=b;const n=Te(e,B),{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"bgColor"),{elevationClasses:_}=$e(e),{roundedClasses:m}=Fe(e),S=V(()=>(n==null?void 0:n.disabled.value)||e.disabled),P=V(()=>n.group.items.value.reduce((k,v,F)=>(n.group.selected.value.includes(v.id)&&k.push(F),k),[])),l=V(()=>{const k=n.group.items.value.findIndex(v=>v.id===n.id);return!n.isSelected.value&&P.value.some(v=>v-k===1)}),J=V(()=>{const k=n.group.items.value.findIndex(v=>v.id===n.id);return!n.isSelected.value&&P.value.some(v=>v-k===-1)});return Ne(B,n),Q(()=>{const k=!!(o.text||e.text),v=!!(o.title||e.title),F=ae.filterProps(e),N=ee.filterProps(e);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":l.value,"v-expansion-panel--after-active":J.value,"v-expansion-panel--disabled":S.value},m.value,u.value,e.class],style:[r.value,e.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",..._.value]},null),a(ce,{defaults:{VExpansionPanelTitle:{...F},VExpansionPanelText:{...N}}},{default:()=>{var w;return[v&&a(ae,{key:"title"},{default:()=>[o.title?o.title():e.title]}),k&&a(ee,{key:"text"},{default:()=>[o.text?o.text():e.text]}),(w=o.default)==null?void 0:w.call(o)]}})]})}),{groupItem:n}}}),pa=["default","accordion","inset","popout"],va=z({flat:Boolean,...qe(),...Me(fe(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...Ge(),...te(),...me(),variant:{type:String,default:"default",validator:e=>pa.includes(e)}},"VExpansionPanels"),fa=O()({name:"VExpansionPanels",props:va(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:o}=b;const{next:n,prev:u}=De(e,B),{themeClasses:r}=Ue(e),_=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Le({VExpansionPanel:{bgColor:x(e,"bgColor"),collapseIcon:x(e,"collapseIcon"),color:x(e,"color"),eager:x(e,"eager"),elevation:x(e,"elevation"),expandIcon:x(e,"expandIcon"),focusable:x(e,"focusable"),hideActions:x(e,"hideActions"),readonly:x(e,"readonly"),ripple:x(e,"ripple"),rounded:x(e,"rounded"),static:x(e,"static")}}),Q(()=>a(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,_.value,e.class],style:e.style},{default:()=>{var m;return[(m=o.default)==null?void 0:m.call(o,{prev:u,next:n})]}})),{next:n,prev:u}}}),H=e=>(aa("data-v-3260d25e"),e=e(),ta(),e),_a=H(()=>f("span",null," Formulario periodo escolar ",-1)),ga={key:0,class:"error--text"},xa={class:"text-center"},ya={class:"text-center"},ba=H(()=>f("p",{class:"text-center"}," Reporte de materia pendiente. ",-1)),Va=H(()=>f("th",null,"No.",-1)),Pa=H(()=>f("th",null,"ALUMNO",-1)),ka={key:0},ha=["colspan"],Ea=Oe({__name:"Form",setup(e){const b=ze(),o=Qe(),{toast:n}=ea(),u=$({}),r=$(!1),_=$(),m=He({form:!1}),S=$([]),P=$([]),l=$({id:null,term_id:null,type_education_id:null,grade_id:null,code:null,students:[]}),J=()=>{l.value={id:null,term_id:null,type_education_id:null,grade_id:null,students:[]}},k=async()=>{var A;l.value.id=o.params.id;const i=l.value.id?`/pendingRegistration/${l.value.id}/edit`:"/pendingRegistration/create";m.form=!0;const{data:t,response:C}=await Ze(la(`${i}`,{query:{company_id:b.company.id}}));m.form=!1,(A=C.value)!=null&&A.ok&&t.value&&(t.value.form&&(l.value={id:t.value.form.id||null,term_id:t.value.form.term_id||null,code:t.value.form.code||null,type_education_id:t.value.form.type_education_id||null,grade_id:t.value.form.grade_id||null,students:t.value.form.students||[]}),t.value.terms&&(S.value=t.value.terms),t.value.typeEducations&&(P.value=t.value.typeEducations))},v=()=>{l.value.students.push({student_id:null,subjects:[]})},F=i=>{l.value.students.splice(i,1)},N=async()=>{var t;const i=await((t=_.value)==null?void 0:t.validate());if(i!=null&&i.valid){const C={...l.value,company_id:b.company.id,students:l.value.students.map(U=>({student_id:U.student_id,subjects:U.subjects}))},A=l.value.id?`/pendingRegistration/update/${l.value.id}`:"/pendingRegistration/store";m.form=!0;const{data:T,response:X}=await na(A).post(C);m.form=!1,X.status==200&&T&&T.code===200&&We.push({name:"PendingRegistration-List"}),T.code===422&&(u.value=T.errors??{})}else n("Faltan campos por diligenciar","","danger")};o.params.action==="view"&&(r.value=!0),Je(async()=>{J(),await k()});const w=V(()=>Object.values(m).some(i=>i)),_e=[i=>!!i||"El código es obligatorio"],le=[i=>!!i||"El periodo es obligatorio"],ge=[i=>!!i||"El grado es obligatorio"],xe=[i=>!!i||"El estudiante es obligatorio"],ye=[i=>i.length>0||"Debe seleccionar al menos una materia"],K=V(()=>{if(l.value.type_education_id){const i=P.value.find(t=>t.value==l.value.type_education_id);return i?i.grades:[]}return[]}),ne=V(()=>l.value.grade_id?K.value.find(i=>i.value==l.value.grade_id).subjects:[]),D=V(()=>{const i=l.value.students.flatMap(t=>t.subjects);return[...new Set(i)].map(t=>ne.value.find(C=>C.value===t)).filter(t=>t!==void 0)});return(i,t)=>{const C=Ee,A=he,T=ke,X=Pe,U=Ve;return p(),h("div",null,[a(oa,{disabled:m.form,loading:m.form},{default:s(()=>[a(sa,{class:"d-flex justify-space-between"},{default:s(()=>[_a]),_:1}),a(W,null,{default:s(()=>[a(ia,{ref_key:"formValidation",ref:_,onSubmit:Ke(N,["prevent"]),disabled:r.value},{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:l.value.term_id,"onUpdate:modelValue":t[0]||(t[0]=d=>l.value.term_id=d),items:S.value,label:"Periodo",rules:le,"error-messages":u.value.term_id,onChange:t[1]||(t[1]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(A,{requiredField:"true",modelValue:l.value.code,"onUpdate:modelValue":t[2]||(t[2]=d=>l.value.code=d),rules:_e,label:"Código de sección"},null,8,["modelValue"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:l.value.type_education_id,"onUpdate:modelValue":t[3]||(t[3]=d=>l.value.type_education_id=d),items:P.value,label:"Tipo de educación",rules:le,"error-messages":u.value.term_id,onChange:t[4]||(t[4]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:l.value.grade_id,"onUpdate:modelValue":t[5]||(t[5]=d=>l.value.grade_id=d),items:K.value,label:"Grados y niveles",rules:ge,"error-messages":u.value.grade_id,onChange:t[6]||(t[6]=d=>u.value.grade_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12"},{default:s(()=>[a(fa,{multiple:""},{default:s(()=>[(p(!0),h(M,null,q(l.value.students,(d,g)=>(p(),G(ma,{key:g},{default:s(()=>[a(ae,null,{actions:s(()=>[r.value?R("",!0):(p(),G(Z,{key:0,icon:"tabler-x",color:"error",onClick:I=>F(g)},null,8,["onClick"]))]),default:s(()=>[Y(" Estudiante "+y(g+1)+" ",1)]),_:2},1024),a(ee,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"6"},{default:s(()=>[a(T,{modelValue:d.student_id,"onUpdate:modelValue":I=>d.student_id=I,url:"selectInfiniteStudent",arrayInfo:"student",rules:xe,label:"Estudiante","error-messages":u.value[`students.${g}.student_id`],onInput:I=>u.value[`students.${g}.student_id`]="",readonly:r.value,params:{type_education_id:l.value.type_education_id}},null,8,["modelValue","onUpdate:modelValue","error-messages","onInput","readonly","params"])]),_:2},1024),a(E,{cols:"12",md:"6"},{default:s(()=>[a(X,{modelValue:d.subjects,"onUpdate:modelValue":I=>d.subjects=I,items:ne.value,label:"Materias",multiple:"",chips:"","closable-chips":"",rules:ye,"error-messages":u.value[`students.${g}.subjects`],onInput:I=>u.value[`students.${g}.subjects`]="",readonly:r.value},null,8,["modelValue","onUpdate:modelValue","items","error-messages","onInput","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value?R("",!0):(p(),G(Z,{key:0,color:"primary",onClick:v,class:"mt-2"},{default:s(()=>[Y(" Agregar Estudiante ")]),_:1}))]),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>[Object.keys(u.value).length>0?(p(),h("div",ga," Por favor, corrige los errores indicados. ")):R("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),a(W,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d;return[f("h2",xa,y(Xe(b).company.name),1),f("p",ya," Año Escolar: "+y(((d=S.value.find(g=>g.value===l.value.term_id))==null?void 0:d.title)||"N/A")+" | Fecha: "+y(new Date().toLocaleDateString("es-ES")),1),ba]}),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d,g,I;return[f("h3",null," Sección: "+y(((d=S.value.find(c=>c.value===l.value.term_id))==null?void 0:d.title)||"N/A")+" - "+y(((g=P.value.find(c=>c.value===l.value.type_education_id))==null?void 0:g.title)||"N/A")+" - "+y(((I=K.value.find(c=>c.value===l.value.grade_id))==null?void 0:I.title)||"N/A")+" - "+y(l.value.code||"N/A"),1),a(ra,{class:"bordered-table"},{default:s(()=>[f("thead",null,[f("tr",null,[Va,Pa,(p(!0),h(M,null,q(D.value,c=>(p(),h("th",{key:c.value},y(c.abbreviation||c.title),1))),128))])]),f("tbody",null,[(p(!0),h(M,null,q(l.value.students,(c,be)=>{var se,oe;return p(),h("tr",{key:(se=c.student_id)==null?void 0:se.value},[f("td",null,y(be+1),1),f("td",null,y(((oe=c.student_id)==null?void 0:oe.title)||"N/A"),1),(p(!0),h(M,null,q(D.value,L=>(p(),h("td",{key:L.value,class:Ye({"bg-yellow-lighten-3":c.subjects.includes(L.value),"bg-grey-lighten-3":!c.subjects.includes(L.value)&&D.value.length>0})},y(c.subjects.includes(L.value)?"--":""),3))),128))])}),128)),l.value.students.length?R("",!0):(p(),h("tr",ka,[f("td",{colspan:D.value.length+2,class:"text-center"}," No hay estudiantes seleccionados. ",8,ha)]))])]),_:1})]}),_:1})]),_:1})]),_:1}),a(W,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[a(U,{disabled:w.value,loading:w.value},null,8,["disabled","loading"]),r.value?R("",!0):(p(),G(Z,{key:0,disabled:w.value,loading:w.value,onClick:N,color:"primary"},{default:s(()=>[Y(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}}),mt=ca(Ea,[["__scopeId","data-v-3260d25e"]]);export{mt as default};
