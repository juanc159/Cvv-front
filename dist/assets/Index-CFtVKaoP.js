import{r as N}from"./validators-7D4Imc0R.js";import{_ as J}from"./DragAndDrop.vue_vue_type_script_setup_true_lang-CwEnIFqD.js";import{_ as K}from"./AppSelect.vue_vue_type_script_setup_true_lang-CfS2zmgm.js";import{d as O,U as Q,ax as W,r as n,M as Y,af as _,X as Z,c as q,o as v,b as e,f as a,C as f,k as l,g as S,e as D,ad as U,ae as ee,F as j,p as I,D as ae,ay as le}from"./index-CgnQDxxm.js";import{u as oe,V as te}from"./VFileInput-D8Gp175i.js";import{c as se}from"./createUrl-rmyP6L74.js";import{b as ie}from"./helpers-BRtxQQYN.js";import{b as z,V as k}from"./VCard-jZNOwtFJ.js";import{V}from"./VCardText-hyg9zJrY.js";import{V as L}from"./VForm-BINSioA6.js";import{V as c,a as u}from"./VRow-DITKpF8g.js";import{V as re}from"./VInput-a6BroeAw.js";import{V as P}from"./VSwitch-6m2nSXi8.js";import{V as de}from"./VDivider-D_xG5oaH.js";import"./VImg-pdbdKQJ1.js";import"./VSpacer-fxsB29wU.js";/* empty css              */import"./VAvatar-aBjmOXNa.js";import"./VTooltip-CNREpurF.js";import"./VOverlay-Dw72OMCM.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-D58bruy6.js";import"./VTextField-Cr7uYRF3.js";/* empty css                   */import"./VCounter-B1cVocVv.js";import"./VList-CO3QrId2.js";import"./ssrBoot-8rNYjAxW.js";import"./dialog-transition-hPKYU2vt.js";import"./VMenu-CONMBowW.js";import"./VCheckboxBtn-Bm-lVHq5.js";import"./VSelectionControl-QRqGCGBp.js";import"./VChip-1ALGcPfj.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./index-0F-JFElI.js";import"./constants-2GBt7OCP.js";const ne=D("b",{class:"text-warning"},"*",-1),ue={class:"demo-space-x"},me={class:"demo-space-x"},Ke=O({__name:"Index",setup(ce){const B=Q(),{toast:$}=le(),s=W({form:!1,excel:!1}),p=n({company_id:null,type_education_id:null,archive:null}),w=n({}),A=n(),T=n(),y=n([]),g=n(oe());g.value.allowedExtensions=["xls","xlsx"];const b=n(!1),C=n({});Y(async()=>{var r;await h(),s.form=!0;const{data:t,response:o}=await _("note-dataForm").get();(r=o.value)!=null&&r.ok&&t.value&&(y.value=t.value.typeEducations,b.value=t.value.blockData),s.form=!1});const h=async()=>{var r;const{data:t,response:o}=await _("/type_educations/visualization/show").get();(r=o.value)!=null&&r.ok&&t.value&&(C.value=t.value.selectedNotes)},M=async()=>{var o;p.value.archive=g.value.imageFile,p.value.company_id=B.company.id;const t=await((o=A.value)==null?void 0:o.validate());if(t!=null&&t.valid){const r=new FormData;for(const m in p.value)r.append(m,p.value[m]);s.form=!0;const{data:d,response:i}=await _("note-store").post(r);s.form=!1}else $("Faltan Campos Por Diligenciar","","danger")},x=n({type_education_id:null}),R=async()=>{var o,r;const t=await((o=T.value)==null?void 0:o.validate());if(t!=null&&t.valid){s.excel=!0;const d=y.value.find(F=>F.value==x.value.type_education_id),{data:i,response:m}=await _(se("/note-downloadAllConsolidated",{query:{type_education_id:x.value.type_education_id,company_id:B.company.id}}));s.excel=!1,(r=m.value)!=null&&r.ok&&i.value&&ie(i.value.excel,"Consolidado "+(d==null?void 0:d.title))}else $("Faltan Campos Por Diligenciar","","danger")},E=async t=>{var d;const{data:o,response:r}=await _("/note-blockPayrollUpload").post({value:t});(d=r.value)!=null&&d.ok&&o.value},G=Z(()=>b.value?"Sí":"No"),X=async()=>{s.form=!0;const{data:t,response:o}=await _("/type_educations/visualization/store").post({selectedNotes:C.value});s.form=!1};return(t,o)=>{const r=K,d=J;return v(),q("div",null,[e(k,{disabled:l(s).form,loading:l(s).form},{default:a(()=>[e(z,{"primary-title":""},{default:a(()=>[f("Cargar Notas")]),_:1}),e(V,null,{default:a(()=>[e(l(L),{ref_key:"formValidation",ref:A,"lazy-validation":""},{default:a(()=>[e(c,null,{default:a(()=>[e(u,{cols:"12",sm:"4"},{default:a(()=>[e(r,{clearable:"",modelValue:l(p).type_education_id,"onUpdate:modelValue":o[0]||(o[0]=i=>l(p).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:l(N)],"error-messages":l(w).type_education_id,label:"Tipo",onChange:o[1]||(o[1]=i=>l(w).type_education_id=""),requiredField:!0,items:l(y)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),e(u,{cols:"12",sm:"4"},{default:a(()=>[e(re,null,{default:a(()=>[f("Archivo "),ne]),_:1}),(v(),S(te,{key:l(g).key,onChange:l(g).handleImageSelected,"onClick:clear":l(g).clearData,rules:["requiredValidator"in t?t.requiredValidator:l(N)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[e(U,{loading:l(s).form,disabled:l(s).form,color:"primary",onClick:o[2]||(o[2]=i=>M())},{default:a(()=>[f(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),e(k,{disabled:l(s).form,loading:l(s).form,class:"mt-3"},{default:a(()=>[e(z,{"primary-title":""},{default:a(()=>[f("Descargar Notas")]),_:1}),e(V,null,{default:a(()=>[e(l(L),{ref_key:"formValidationDownload",ref:T,"lazy-validation":""},{default:a(()=>[e(c,null,{default:a(()=>[e(u,{cols:"12",sm:"4"},{default:a(()=>[e(r,{clearable:"",modelValue:l(x).type_education_id,"onUpdate:modelValue":o[3]||(o[3]=i=>l(x).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:l(N)],"error-messages":l(w).type_education_id,label:"Tipo",onChange:o[4]||(o[4]=i=>l(w).type_education_id=""),requiredField:!0,items:l(y)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[e(U,{loading:l(s).excel,disabled:l(s).excel,color:"primary",onClick:o[5]||(o[5]=i=>R())},{default:a(()=>[f(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),e(k,{disabled:l(s).form,loading:l(s).form,class:"mt-3"},{default:a(()=>[e(z,{"primary-title":""},{default:a(()=>[f("Bloquear carga de notas a los profesores")]),_:1}),e(V,null,{default:a(()=>[e(c,null,{default:a(()=>[e(u,{cols:"12",sm:"4"},{default:a(()=>[D("div",ue,[e(P,{modelValue:l(b),"onUpdate:modelValue":[o[6]||(o[6]=i=>ee(b)?b.value=i:null),o[7]||(o[7]=i=>E(i))],label:l(G),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"]),e(k,{disabled:l(s).form,loading:l(s).form,class:"mt-3",title:"Visualización de las notas"},{default:a(()=>[(v(!0),q(j,null,I(l(y),i=>(v(),S(V,{key:i.value},{default:a(()=>[e(de),e(c,null,{default:a(()=>[e(u,null,{default:a(()=>[D("span",null,ae(i.title),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:a(()=>[(v(!0),q(j,null,I(i.cantNotes,(m,F)=>(v(),S(u,{cols:"12",sm:"4",key:F},{default:a(()=>[D("div",me,[e(P,{modelValue:l(C)[i.value]["note_"+m],"onUpdate:modelValue":H=>l(C)[i.value]["note_"+m]=H,label:"Nota "+m,color:"success"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128)),e(V,null,{default:a(()=>[e(c,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[e(U,{loading:l(s).form,disabled:l(s).form,color:"primary",onClick:o[8]||(o[8]=i=>X())},{default:a(()=>[f(" Guardar Visualización ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"]),e(k,{title:"Carga de archivos masivos",class:"mt-3"},{default:a(()=>[e(V,null,{default:a(()=>[e(d)]),_:1})]),_:1})])}}});export{Ke as default};
