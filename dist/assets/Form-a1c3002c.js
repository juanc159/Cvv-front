import{V as B,r as c,e as U}from"./VForm-43b0bb0b.js";import{_ as S}from"./AppTextField.vue_vue_type_script_setup_true_lang-4fc0a184.js";import{d as A,r as d,R as N,Q as T,L as I,o as y,c as K,b as o,f as l,k as a,B as F,e as R,g as z,ae as D,p as P,az as E,aA as L}from"./index-4f81429d.js";import{u as _}from"./useImageUpload-8ebcd37b.js";import{u as j}from"./useCrudUserStore-55a8a236.js";import{V as x}from"./VCardText-29420ad3.js";import{V as v}from"./VRow-6a50fe05.js";import{V as m}from"./VCol-a7c5bc1b.js";import{V as G}from"./VField-83b24b5b.js";import{V as H}from"./VFileInput-674595ea.js";import{V as M}from"./VImg-6edd56e6.js";import{V as Q}from"./VCard-832cd683.js";import"./helpers-3edea678.js";import"./VTextField-59dde88f.js";import"./sweetalert2.esm.all-562d67d8.js";/* empty css              */import"./VChip-c78765a0.js";import"./VAvatar-509cb4e6.js";const pe=A({__name:"Form",setup(J){const b=P(),{toast:k}=L(),g=d();N();const p=j(),{form:i,loading:C}=T(p),n=d({}),u=d(_()),f=d(!1),w=d([]),q=r=>{u.value.handleImageSelected(r)},$=async()=>{var e,V;const r=await((e=g.value)==null?void 0:e.validate());if(r!=null&&r.valid){u.value.imageFile&&(i.value.photo=u.value.imageFile);const t=await p.fetchSave();(t==null?void 0:t.code)===200&&(w.value=[],n.value={},u.value.clearData(),await((V=g.value)==null?void 0:V.resetValidation())),(t==null?void 0:t.code)===422&&(n.value=t.errors??{})}else k("Faltan Campos Por Diligenciar","","danger")};return I(async()=>{p.clearForm(),await p.fetchDataForm(Number(b.params.id),b.params.action)}),(r,e)=>{const V=E,t=S;return y(),K("div",null,[o(Q,null,{default:l(()=>[o(x,null,{default:l(()=>[o(v,null,{default:l(()=>[o(m,null,{default:l(()=>[o(V,{"sub-title":"form de usuario",action:String(r.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:r.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),o(a(B),{ref_key:"formValidation",ref:g,"lazy-validation":""},{default:l(()=>[o(v,null,{default:l(()=>[o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:a(i).email,"onUpdate:modelValue":e[0]||(e[0]=s=>a(i).email=s),rules:["requiredValidator"in r?r.requiredValidator:a(c),"emailValidator"in r?r.emailValidator:a(U)],autocomplete:"off","error-messages":a(n).email,label:"Email",onKeypress:e[1]||(e[1]=s=>a(n).email=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:a(i).password,"onUpdate:modelValue":e[2]||(e[2]=s=>a(i).password=s),rules:a(w).password,autocomplete:"off",type:a(f)?"text":"password","append-icon":a(f)?"mdi-eye":"mdi-eye-off","error-messages":a(n).password,label:"Contraseña","onClick:append":e[3]||(e[3]=s=>f.value=!a(f)),onKeypress:e[4]||(e[4]=s=>a(n).password=""),requiredField:!0},null,8,["modelValue","rules","type","append-icon","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:a(i).name,"onUpdate:modelValue":e[5]||(e[5]=s=>a(i).name=s),rules:["requiredValidator"in r?r.requiredValidator:a(c)],"error-messages":a(n).name,label:"Nombre",onKeypress:e[6]||(e[6]=s=>a(n).name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(t,{clearable:"",modelValue:a(i).last_name,"onUpdate:modelValue":e[7]||(e[7]=s=>a(i).last_name=s),rules:["requiredValidator"in r?r.requiredValidator:a(c)],"error-messages":a(n).last_name,label:"Apellido",onKeypress:e[8]||(e[8]=s=>a(n).last_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(m,{cols:"12",md:"4"},{default:l(()=>[o(G,null,{default:l(()=>e[11]||(e[11]=[F("Foto  "),R("b",{class:"text-warning"},"*",-1)])),_:1}),(y(),z(H,{key:a(u).key,"show-size":"",counter:"",accept:"image/*",onChange:e[9]||(e[9]=s=>q(s))}))]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(M,{contain:"",src:a(u).imageUrl??a(i).photo,alt:"foto Personal","max-width":200,class:"mx-auto img-fluid"},null,8,["src"])]),_:1})]),_:1}),o(v,null,{default:l(()=>[o(m,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[o(D,{loading:a(C).form,color:"primary",onClick:e[10]||(e[10]=s=>$())},{default:l(()=>e[12]||(e[12]=[F(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{pe as default};
