import{h as V,b as ae}from"./helpers-upj93DMB.js";import{V as I,r as B}from"./VForm-Bs3PART1.js";import{_ as oe}from"./ModalQuestion.vue_vue_type_script_setup_true_lang-D25jZfLl.js";import{_ as le}from"./DragAndDrop.vue_vue_type_script_setup_true_lang-D35GLznw.js";import{_ as te}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-BFnma5ZV.js";import{_ as se}from"./AppSelect.vue_vue_type_script_setup_true_lang-ByoSRW3r.js";import{d as ie,U as ne,ax as de,r as m,M as re,af as g,Z as ue,o as u,c as M,k as e,g as c,f as a,b as o,C as f,ad as q,G as b,e as D,ae as me,F as L,p as x,ay as _e,D as ce}from"./index-DAr2upiy.js";import{u as fe,V as pe}from"./VFileInput-CtP4SjFD.js";import{c as ge}from"./createUrl-DcgsqEvO.js";import{b as S,V as k}from"./VCard-CGmGEMqU.js";import{V as _,a as r}from"./VRow-DUD9vsF6.js";import{V as ve}from"./VInput-DUzkoKUG.js";import{V as v}from"./VCardText-CvT14MiE.js";import{V as E}from"./VSwitch-Ba7IJiz7.js";import{V as ye}from"./VDivider-DsvQeesb.js";import"./constants-2GBt7OCP.js";import"./forwardRefs-C-GTDzx5.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-DeurfORW.js";import"./VDialog-CKoy472U.js";import"./VOverlay-BIhjNxwp.js";import"./VImg-B_nB46wv.js";import"./dialog-transition-OAnkhNJZ.js";import"./VSpacer-B6M8Cwj5.js";/* empty css              */import"./VAvatar-DsBa6V7B.js";import"./VTooltip-BdkVEjDn.js";import"./VSelect-CqnIqhM2.js";import"./VTextField-Bf4NTB6r.js";/* empty css                   */import"./VList-DLnrFgXa.js";import"./ssrBoot-DUsnO7GJ.js";import"./VMenu-5LwpensE.js";import"./VCheckboxBtn-DHQkD95d.js";import"./VSelectionControl-BYsu3Szo.js";import"./VChip-kz0JIWHk.js";import"./filter-CvljXm9j.js";import"./sweetalert2.esm.all-DOYwHpwi.js";import"./index-0F-JFElI.js";const Ve=D("b",{class:"text-warning"},"*",-1),be={class:"demo-space-x"},ke={class:"demo-space-x"},we={class:"demo-space-x"},da=ie({__name:"Index",setup(he){const U=ne(),{toast:T}=_e(),s=de({form:!1,download_notes:!1,block_uploading_of_grades_to_teachers:!1,viewing_notes:!1}),p=m({company_id:null,type_education_id:null,teacher_id:null,archive:null}),y=m({}),Q=m(),R=m(),w=m([]),j=m([]),h=m(fe());h.value.allowedExtensions=["xls","xlsx"];const C=m(!1),P=m({});re(async()=>{var n;await G(),s.form=!0;const{data:l,response:t}=await g("note-dataForm").get();(n=t.value)!=null&&n.ok&&l.value&&(w.value=l.value.typeEducations,C.value=l.value.blockData,j.value=l.value.teachers),s.form=!1});const G=async()=>{var n;const{data:l,response:t}=await g("/type_educations/visualization/show").get();(n=t.value)!=null&&n.ok&&l.value&&(P.value=l.value.selectedNotes)},O=async()=>{var t;p.value.archive=h.value.imageFile,p.value.company_id=U.company.id;const l=await((t=Q.value)==null?void 0:t.validate());if(l!=null&&l.valid){const n=new FormData;for(const d in p.value)n.append(d,p.value[d]);s.form=!0,await g("note-store").post(n),s.form=!1}else T("Faltan Campos Por Diligenciar","","danger")},F=m({type_education_id:null}),Z=async()=>{var t,n;const l=await((t=R.value)==null?void 0:t.validate());if(l!=null&&l.valid){s.download_notes=!0;const d=w.value.find(i=>i.value==F.value.type_education_id),{data:N,response:z}=await g(ge("/note-downloadAllConsolidated",{query:{type_education_id:F.value.type_education_id,company_id:U.company.id}}));s.download_notes=!1,(n=z.value)!=null&&n.ok&&N.value&&ae(N.value.excel,"Consolidado "+(d==null?void 0:d.title))}else T("Faltan Campos Por Diligenciar","","danger")},H=async l=>{var d;s.block_uploading_of_grades_to_teachers=!0;const{data:t,response:n}=await g("/note-blockPayrollUpload").post({value:l});(d=n.value)!=null&&d.ok&&t.value,s.block_uploading_of_grades_to_teachers=!1},J=async l=>{var d;s.block_uploading_of_grades_to_teachers=!0;const{data:t,response:n}=await g("/note-resetOptionDownloadPdf").post({company_id:U.company.id});(d=n.value)!=null&&d.ok&&t.value,s.block_uploading_of_grades_to_teachers=!1},K=ue(()=>C.value?"Sí":"No"),W=async()=>{s.viewing_notes=!0,await g("/type_educations/visualization/store").post({selectedNotes:P.value}),s.viewing_notes=!1},$=m(),X=()=>{$.value.openModal(),$.value.componentData.title="Esta seguro que desea activar a todos los estudiantes en un estado insolventes"};return(l,t)=>{const n=se,d=te,N=le,z=oe;return u(),M("div",null,[("hasPermission"in l?l.hasPermission:e(V))("note.upload_notes")?(u(),c(k,{key:0,disabled:e(s).form,loading:e(s).form},{default:a(()=>[o(S,{"primary-title":""},{default:a(()=>[f("Cargar Notas")]),_:1}),o(v,null,{default:a(()=>[o(e(I),{ref_key:"formValidation",ref:Q,"lazy-validation":""},{default:a(()=>[o(_,null,{default:a(()=>[o(r,{cols:"12",sm:"4"},{default:a(()=>[o(n,{clearable:"",modelValue:e(p).type_education_id,"onUpdate:modelValue":t[0]||(t[0]=i=>e(p).type_education_id=i),rules:["requiredValidator"in l?l.requiredValidator:e(B)],"error-messages":e(y).type_education_id,label:"Tipo",onChange:t[1]||(t[1]=i=>e(y).type_education_id=""),requiredField:!0,items:e(w)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),o(r,{cols:"12",sm:"4"},{default:a(()=>[o(ve,null,{default:a(()=>[f("Archivo "),Ve]),_:1}),(u(),c(pe,{key:e(h).key,onChange:e(h).handleImageSelected,"onClick:clear":e(h).clearData,rules:["requiredValidator"in l?l.requiredValidator:e(B)]},null,8,["onChange","onClick:clear","rules"]))]),_:1}),o(r,{cols:"12",sm:"4"},{default:a(()=>[o(d,{clearable:"",modelValue:e(p).teacher_id,"onUpdate:modelValue":t[2]||(t[2]=i=>e(p).teacher_id=i),"error-messages":e(y).teacher_id,label:"Docente",onChange:t[3]||(t[3]=i=>e(y).teacher_id=""),items:e(j)},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),o(_,null,{default:a(()=>[o(r,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[o(q,{loading:e(s).form,disabled:e(s).form,color:"primary",onClick:t[4]||(t[4]=i=>O())},{default:a(()=>[f(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])):b("",!0),("hasPermission"in l?l.hasPermission:e(V))("note.download_notes")?(u(),c(k,{key:1,disabled:e(s).download_notes,loading:e(s).download_notes,class:"mt-3"},{default:a(()=>[o(S,{"primary-title":""},{default:a(()=>[f("Descargar Notas")]),_:1}),o(v,null,{default:a(()=>[o(e(I),{ref_key:"formValidationDownload",ref:R,"lazy-validation":""},{default:a(()=>[o(_,null,{default:a(()=>[o(r,{cols:"12",sm:"4"},{default:a(()=>[o(n,{clearable:"",modelValue:e(F).type_education_id,"onUpdate:modelValue":t[5]||(t[5]=i=>e(F).type_education_id=i),rules:["requiredValidator"in l?l.requiredValidator:e(B)],"error-messages":e(y).type_education_id,label:"Tipo",onChange:t[6]||(t[6]=i=>e(y).type_education_id=""),requiredField:!0,items:e(w)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),o(_,null,{default:a(()=>[o(r,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[o(q,{loading:e(s).download_notes,disabled:e(s).download_notes,color:"primary",onClick:t[7]||(t[7]=i=>Z())},{default:a(()=>[f(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"])):b("",!0),o(_,null,{default:a(()=>[o(r,{cols:"4"},{default:a(()=>[("hasPermission"in l?l.hasPermission:e(V))("note.block_uploading_of_grades_to_teachers")?(u(),c(k,{key:0,disabled:e(s).block_uploading_of_grades_to_teachers,loading:e(s).block_uploading_of_grades_to_teachers,class:"mt-3"},{default:a(()=>[o(S,{"primary-title":""},{default:a(()=>[f("Bloquear carga de notas a los profesores")]),_:1}),o(v,null,{default:a(()=>[o(_,null,{default:a(()=>[o(r,{cols:"12",sm:"4"},{default:a(()=>[D("div",be,[o(E,{modelValue:e(C),"onUpdate:modelValue":[t[8]||(t[8]=i=>me(C)?C.value=i:null),t[9]||(t[9]=i=>H(i))],label:e(K),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):b("",!0)]),_:1}),o(r,{cols:"4"},{default:a(()=>[("hasPermission"in l?l.hasPermission:e(V))("note.reset_option_download_pdf")?(u(),c(k,{key:0,disabled:e(s).block_uploading_of_grades_to_teachers,loading:e(s).block_uploading_of_grades_to_teachers,class:"mt-3"},{default:a(()=>[o(S,{"primary-title":""},{default:a(()=>[f("Reiniciar opción descarga pdf y boletin")]),_:1}),o(v,null,{default:a(()=>[o(_,null,{default:a(()=>[o(r,{cols:"12",sm:"4"},{default:a(()=>[D("div",ke,[o(q,{color:"primary",onClick:X},{default:a(()=>[f("Reiniciar")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):b("",!0)]),_:1})]),_:1}),("hasPermission"in l?l.hasPermission:e(V))("note.viewing_notes")?(u(),c(k,{key:2,disabled:e(s).viewing_notes,loading:e(s).viewing_notes,class:"mt-3",title:"Visualización de las notas"},{default:a(()=>[(u(!0),M(L,null,x(e(w),i=>(u(),c(v,{key:i.value},{default:a(()=>[o(ye),o(_,null,{default:a(()=>[o(r,null,{default:a(()=>[D("span",null,ce(i.title),1)]),_:2},1024)]),_:2},1024),o(_,null,{default:a(()=>[(u(!0),M(L,null,x(i.cantNotes,(A,Y)=>(u(),c(r,{cols:"12",sm:"4",key:Y},{default:a(()=>[D("div",we,[o(E,{modelValue:e(P)[i.value]["note_"+A],"onUpdate:modelValue":ee=>e(P)[i.value]["note_"+A]=ee,label:"Nota "+A,color:"success"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128)),o(v,null,{default:a(()=>[o(_,null,{default:a(()=>[o(r,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[o(q,{loading:e(s).form,disabled:e(s).form,color:"primary",onClick:t[10]||(t[10]=i=>W())},{default:a(()=>[f(" Guardar Visualización ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"])):b("",!0),("hasPermission"in l?l.hasPermission:e(V))("note.bulk_file_upload")?(u(),c(k,{key:3,title:"Carga de archivos masivos",class:"mt-3"},{default:a(()=>[o(v,null,{default:a(()=>[o(N)]),_:1})]),_:1})):b("",!0),o(z,{ref_key:"refModalQuestion",ref:$,onSuccess:J},null,512)])}}});export{da as default};
