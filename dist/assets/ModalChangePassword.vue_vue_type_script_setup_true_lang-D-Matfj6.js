import{V as L,r as T}from"./VForm-CsghMn2d.js";import{d as U,r as c,ax as A,o as f,c as N,b as s,f as r,k as o,g as V,G as g,e as v,C as _,D as P,ac as I,a8 as C,ad as y,af as M}from"./index-CuVxboY0.js";import{_ as z}from"./AppTextField.vue_vue_type_script_setup_true_lang-CaGkDmKs.js";import{_ as R}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BS51bAzx.js";import{V as S,a as j}from"./VToolbar-PZ7BOyYu.js";import{V as E}from"./VCard-CBu53-3u.js";import{V as D}from"./VCardText-Eo5-Vh-o.js";import{V as G,a as w}from"./VRow-CdzrJ3n6.js";import{V as Z}from"./VDialog-Dbsoce_I.js";const H=v("h4",null,"¡Bienvenido! Como es tu primera vez ingresando al sistema, es necesario que cambies tu contraseña. Por favor, elige una nueva contraseña que sea segura y fácil de recordar.",-1),J=v("span",null," Requisitos de la Contraseña: Mínimo de 8 caracteres. Debe incluir al menos: Una letra mayúscula (A-Z) Una letra minúscula (a-z) Un número (0-9) Asegúrate de que la nueva contraseña no sea igual a la contraseña actual. ",-1),se=U({__name:"ModalChangePassword",emits:["execute"],setup(K,{expose:k,emit:x}){const n=c({}),B=x,e=A({titleDialog:"Cambiar contraseña",isDialogVisible:!1,isLoading:!1,first_time:!1,statuses:[],form:{id:null,new_password:""}}),q=()=>{e.form={id:null,new_password:""},n.value={},t.value=!1},d=()=>{e.isDialogVisible=!e.isDialogVisible},$=async i=>{q(),d(),e.form.id=i},F=async()=>{var a,u,m;const i=await((a=b.value)==null?void 0:a.validate());if(i!=null&&i.valid){e.isLoading=!0;const{response:l,data:p}=await M("/user/changePassword").post({id:e.form.id,new_password:e.form.new_password});e.isLoading=!1,(u=l.value)!=null&&u.ok&&((m=p.value)==null?void 0:m.code)==200&&(d(),B("execute")),p.value.code==422&&(n.value=p.value.errors??{})}},b=c();k({openDialog:$});const t=c(!1);return(i,a)=>{const u=R,m=z;return f(),N("div",null,[s(Z,{modelValue:o(e).isDialogVisible,"onUpdate:modelValue":a[6]||(a[6]=l=>o(e).isDialogVisible=l),persistent:"","max-width":"40rem",transition:"dialog-transition"},{default:r(()=>[o(e).first_time?g("",!0):(f(),V(u,{key:0,onClick:a[0]||(a[0]=l=>d())})),v("div",null,[s(S,{color:"primary"},{default:r(()=>[s(j,null,{default:r(()=>[_(P(o(e).titleDialog),1)]),_:1})]),_:1})]),s(E,null,{default:r(()=>[s(D,null,{default:r(()=>[s(L,{ref_key:"refForm",ref:b,onSubmit:I(()=>{},["prevent"])},{default:r(()=>[s(G,null,{default:r(()=>[o(e).first_time?(f(),V(w,{key:0,cols:"12"},{default:r(()=>[H]),_:1})):g("",!0),s(w,{cols:"12"},{default:r(()=>[s(m,{clearable:"",modelValue:o(e).form.new_password,"onUpdate:modelValue":a[1]||(a[1]=l=>o(e).form.new_password=l),label:"Contraseña",placeholder:"············",type:o(t)?"text":"password","append-inner-icon":o(t)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[2]||(a[2]=l=>t.value=!o(t)),rules:["requiredValidator"in i?i.requiredValidator:o(T)],"error-messages":o(n).new_password,onInput:a[3]||(a[3]=l=>o(n).new_password="")},null,8,["modelValue","type","append-inner-icon","rules","error-messages"])]),_:1}),s(w,{cols:"12"},{default:r(()=>[J]),_:1})]),_:1})]),_:1},512)]),_:1}),s(D,{class:"d-flex justify-end gap-3 flex-wrap"},{default:r(()=>[o(e).first_time?g("",!0):(f(),V(y,{key:0,loading:o(e).isLoading,color:"secondary",variant:"tonal",onClick:a[4]||(a[4]=l=>d())},{default:r(()=>[s(C,{start:"",icon:"tabler-x"}),_(" Cancelar ")]),_:1},8,["loading"])),s(y,{disabled:o(e).isLoading,loading:o(e).isLoading,onClick:a[5]||(a[5]=l=>F()),color:"primary"},{default:r(()=>[s(C,{start:"",icon:"tabler-device-floppy"}),_(" Cambiar contraseña ")]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{se as _};
