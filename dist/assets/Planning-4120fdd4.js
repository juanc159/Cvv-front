import{V as M,r as A}from"./VForm-0125f40e.js";import{d as O}from"./helpers-53221d8d.js";import{_ as K}from"./AppTextField.vue_vue_type_script_setup_true_lang-550b8754.js";import{d as Q,r as _,aF as B,L as W,af as $,o as d,c as V,b as e,f as l,k as r,g as k,e as v,C as y,F as D,m as I,E as S,ae as x,B as F,p as X,ay as Y,az as Z,D as j,a6 as b,ac as q,V as ee}from"./index-45124b2c.js";import{u as N}from"./useImageUpload-568a4ec9.js";import{V as E}from"./VCardText-bc141056.js";import{V as h}from"./VRow-3e28075c.js";import{V as p}from"./VCol-fa442cdc.js";import{V as P,b as ae}from"./VCard-5fd62cdf.js";import{V as le}from"./VField-9e33ebe8.js";import{V as te}from"./VFileInput-c15a09ac.js";import{V as oe}from"./VDataTable-a9afd072.js";import"./VTextField-a51272e9.js";import"./VImg-f16b99f3.js";import"./sweetalert2.esm.all-562d67d8.js";/* empty css              */import"./VAvatar-197de976.js";import"./VChip-021ef7bf.js";import"./VSelect-8fdff58c.js";import"./VList-93087bdf.js";import"./ssrBoot-aa33b706.js";import"./VDivider-4bd18a2a.js";import"./dialog-transition-c9465328.js";import"./VMenu-53ea3bb3.js";const re={key:1},ie=["onClick"],ne=Q({__name:"Planning",setup(se){const L=X();_(),_(),_([]);const U=_(N()),G=["jpg","jpeg","png","pdf","ppsx","pptx"];U.value.allowedExtensions=G;const R=async()=>{var i;const a=new FormData;a.append("teacher_id",JSON.stringify(u.value.id));let t=0;u.value.complementaries.forEach(n=>{n.subjects.forEach(o=>{o.files.forEach((m,c)=>{a.append("file_id_"+t,m.id),a.append("file_grade_id_"+t,n.grade_id),a.append("file_section_id_"+t,n.section_id),a.append("file_subject_id_"+t,o.value),a.append("file_file_"+t,m.file),a.append("file_name_"+t,m.name),a.append("file_delete_"+t,m.delete),t++})}),a.append("files_cant",t)}),g.form=!0;const{data:f,response:C}=await $("/teacher-planningStore").post(a);g.form=!1,(i=C.value)!=null&&i.ok&&f.value&&Y.push({name:"Teacher-Index"})},g=B({form:!1}),u=_(),s=B({});W(async()=>{var i;g.form=!0;const{data:a,response:t,error:f,isFetching:C}=await $("/teacher-planning/"+L.params.id).get();g.form=!1,(i=t.value)!=null&&i.ok&&a.value&&(u.value=a.value.data,u.value.complementaries.forEach(n=>{n.subjects.forEach(o=>{s["file-"+o.value]=_(N()),s["file-"+o.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))});const H=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],J=async a=>{a.files.push({name:s["file-"+a.value].name,file:s["file-"+a.value].imageFile,id:null,delete:0}),s["file-"+a.value].clearData()},T=(a,t,f)=>{a[t].delete=f};return(a,t)=>{const f=Z,C=K;return d(),V("div",null,[e(P,null,{default:l(()=>[e(E,null,{default:l(()=>[e(h,null,{default:l(()=>[e(p,null,{default:l(()=>[e(f,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:a.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),r(u)?(d(),k(E,{key:0},{default:l(()=>[e(h,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>{var i,n;return[v("h2",null,y((i=r(u))==null?void 0:i.name)+" "+y((n=r(u))==null?void 0:n.last_name),1)]}),_:1})]),_:1}),e(h,null,{default:l(()=>[(d(!0),V(D,null,I(r(u).complementaries,(i,n)=>(d(),k(p,{cols:"12",key:n},{default:l(()=>[e(P,{class:j({"green-background":n%2===0,"red-background":n%2!==0})},{default:l(()=>[e(ae,{"primary-title":""},{default:l(()=>[v("h2",null,"Grado: "+y(i.grade_name)+" "+y(i.section_name),1)]),_:2},1024),e(E,null,{default:l(()=>[(d(!0),V(D,null,I(i.subjects,(o,m)=>(d(),V("div",{key:m},[v("h3",null,"Planificacion: "+y(o.title),1),e(r(M),{"lazy-validation":""},{default:l(()=>[e(h,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(C,{clearable:"",modelValue:r(s)["file-"+o.value].name,"onUpdate:modelValue":c=>r(s)["file-"+o.value].name=c,rules:["requiredValidator"in a?a.requiredValidator:r(A)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(le,null,{default:l(()=>t[1]||(t[1]=[F("Archivo "),v("b",{class:"text-warning"},"*",-1)])),_:1}),(d(),k(te,{rules:["requiredValidator"in a?a.requiredValidator:r(A)],onChange:r(s)["file-"+o.value].handleImageSelected,key:r(s)["file-"+o.value].key,"onClick:clear":r(s)["file-"+o.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(x,{size:"30",class:"mt-6",icon:"",color:"success",onClick:c=>J(o)},{default:l(()=>[e(b,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),e(p,{cols:"12"},{default:l(()=>[e(r(oe),{headers:H,items:o.files,"items-per-page":999},{"item.actions":l(({item:c,index:w})=>[v("div",null,[c.id?(d(),k(x,{key:0,icon:"",size:"x-small",color:"primary",variant:"text",onClick:z=>("descargarArchivo"in a?a.descargarArchivo:r(O))(c.file,c.name)},{default:l(()=>[e(b,{size:"22",icon:"tabler-eye"}),e(q,{location:"top",transition:"scale-transition",activator:"parent",text:"Visualizar"})]),_:2},1032,["onClick"])):S("",!0),c.delete?(d(),V("span",re,[t[2]||(t[2]=F(" Sera eliminado al guardar, ")),v("b",{style:{cursor:"pointer"},onClick:z=>T(o.files,w,0)},"restaurar",8,ie)])):(d(),k(x,{key:2,icon:"",size:"x-small",color:"error",variant:"text",onClick:z=>T(o.files,w,1)},{default:l(()=>[e(b,{size:"22",icon:"tabler-trash"}),e(q,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]))])]),bottom:l(()=>t[3]||(t[3]=[])),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),_:1})):S("",!0),e(h,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(x,{loading:r(g).form,color:"primary",onClick:t[0]||(t[0]=i=>R())},{default:l(()=>t[4]||(t[4]=[F(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}});const De=ee(ne,[["__scopeId","data-v-6765e9a9"]]);export{De as default};
