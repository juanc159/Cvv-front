import{r as y,V as z}from"./VForm-9a5c98dc.js";import{_ as j}from"./AppTextField.vue_vue_type_script_setup_true_lang-3831bdce.js";import{d as x,r as d,R as K,Q as N,L as P,ab as C,a as U,o as c,c as k,b as e,f as o,k as t,B as _,E as L,g as h,F as O,m as Y,ae as H,p as G,az as M,aA as Q,cg as J,C as W}from"./index-851eab8c.js";import{u as F}from"./useImageUpload-fbb9d4ef.js";import{u as X}from"./useCrudServiceStore-a2889caf.js";import{V as Z}from"./VCardText-76dfba56.js";import{V as g}from"./VRow-229dac96.js";import{V as u}from"./VCol-0729af45.js";import{V as ee}from"./VField-3401bb6d.js";import{V as ae}from"./VFileInput-87686969.js";import{V as te}from"./VImg-cb326996.js";import{V as oe}from"./VCard-483170f5.js";import"./helpers-3edea678.js";import"./VTextField-4101146d.js";import"./sweetalert2.esm.all-562d67d8.js";/* empty css              */import"./VChip-194a3cab.js";import"./VAvatar-b49ddc1b.js";const le="9ckqih5g25k3jtb9l2c6iv9ewziedlu79zh7k3amkq9qt9vn",re={key:0,class:"text-warning"},Ie=x({__name:"Form",setup(ie){const V=G(),{toast:I}=Q(),v=d(),p=X(),E=K(),{form:n,loading:S}=N(p),w=d(F()),s=d({}),T=d([]),m=d(F()),A=["jpg","jpeg","png"];m.value.allowedExtensions=A;const B=async()=>{var a,f;n.value.company_id=E.company.id;const l=await((a=v.value)==null?void 0:a.validate());if(l!=null&&l.valid){const r=await p.fetchSave();(r==null?void 0:r.code)===200&&(T.value=[],s.value={},w.value.clearData(),await((f=v.value)==null?void 0:f.resetValidation())),(r==null?void 0:r.code)===422&&(s.value=r.errors??{})}else I("Faltan Campos Por Diligenciar","","danger")},D=l=>{m.value.handleImageSelected(l),setTimeout(()=>{n.value.image=m.value.imageFile},1e3)};P(async()=>{p.clearForm(),V.params.id&&await p.fetchDataForm(Number(V.params.id),V.params.action)});const q=C(()=>{if(s.value.html)return s.value.html}),b=C(()=>n.value.id?[]:[y]);return(l,a)=>{const f=M,r=j,R=U("Editor");return c(),k("div",null,[e(oe,null,{default:o(()=>[e(Z,null,{default:o(()=>[e(g,null,{default:o(()=>[e(u,null,{default:o(()=>[e(f,{"sub-title":"Formulario Servicio",action:String(l.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:l.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),e(t(z),{ref_key:"formValidation",ref:v,"lazy-validation":""},{default:o(()=>[e(g,null,{default:o(()=>[e(u,{cols:"12",sm:"3"},{default:o(()=>[e(r,{clearable:"",modelValue:t(n).title,"onUpdate:modelValue":a[0]||(a[0]=i=>t(n).title=i),rules:["requiredValidator"in l?l.requiredValidator:t(y)],"error-messages":t(s).title,label:"Título",onKeypress:a[1]||(a[1]=i=>t(s).title=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),e(u,{cols:"12",sm:"3"},{default:o(()=>[e(ee,null,{default:o(()=>[a[5]||(a[5]=_(" Imagen ")),t(b).length>0?(c(),k("b",re,"*")):L("",!0)]),_:1}),(c(),h(ae,{accept:"image/*",rules:t(b),key:t(m).key,onChange:a[2]||(a[2]=i=>D(i)),"onClick:clear":t(m).clearData},null,8,["rules","onClick:clear"]))]),_:1}),e(u,{cols:"12",sm:"3"},{default:o(()=>[e(te,{src:t(m).imageUrl??t(n).image},null,8,["src"])]),_:1}),e(u,{cols:"12"},{default:o(()=>[e(R,{"api-key":"API_KEY_EDITOR"in l?l.API_KEY_EDITOR:t(le),init:{toolbar_mode:"sliding",plugins:"anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount linkchecker",toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat"},"initial-value":"",modelValue:t(n).html,"onUpdate:modelValue":a[3]||(a[3]=i=>t(n).html=i)},null,8,["api-key","modelValue"]),(c(!0),k(O,null,Y(t(q),(i,$)=>(c(),h(J,{key:$,class:"my-2",variant:"tonal",color:"error"},{default:o(()=>[_(W(i),1)]),_:2},1024))),128))]),_:1})]),_:1}),e(g),e(g,null,{default:o(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:o(()=>[e(H,{loading:t(S).form,color:"primary",onClick:a[4]||(a[4]=i=>B())},{default:o(()=>a[6]||(a[6]=[_(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{Ie as default};
