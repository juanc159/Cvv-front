import{r as b}from"./validators-BvQ1oDJn.js";import{d as T,V as S,r as m,t as U,aU as A,N as E,Y as M,c as D,o as k,b as r,f as s,e as J,l as a,a9 as O,h as x,y as G,a8 as I,D as L,aJ as F,aM as R,aV as P}from"./index-RzV1QAoP.js";import{_ as Y}from"./BtnBack.vue_vue_type_script_setup_true_lang-DGe99Fjc.js";import{_ as z}from"./AppTextField.vue_vue_type_script_setup_true_lang-DUTBFEvl.js";import{_ as H}from"./AppSelect.vue_vue_type_script_setup_true_lang-D8yGCHXs.js";import{c as K}from"./createUrl-DCK_vFzY.js";import{a as Q,V as W}from"./VCard-DaNQ3_6f.js";import{V as q}from"./VCardText-Dm2CnPNw.js";import{V as X}from"./VForm-C5IeNRcC.js";import{V as Z,a as _}from"./VRow-CO85CijB.js";import"./helpers-wifU2dAA.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-DDbD3EeL.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-DeSKSFZb.js";import"./VDialog-Cs4xHY-b.js";import"./VOverlay-BvGCFOa_.js";import"./VImg-B6DACBgf.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-DQiKwflT.js";import"./VTooltip-Dej9oMs9.js";import"./VInput-DoFUtF3M.js";import"./VTextField-B3IkfSa7.js";/* empty css                   */import"./VCounter-3jTD3ZlP.js";import"./VSelect-DXIcYGLO.js";import"./VList-BzOepPo2.js";import"./ssrBoot-BbaJipyo.js";import"./VAvatar-DN0PlqS7.js";import"./VDivider-D39uZXIY.js";import"./VMenu-DYssu-La.js";import"./VCheckboxBtn-DhUXxJCj.js";import"./VSelectionControl-BJXbCgDq.js";import"./VChip-DsDkGwaf.js";import"./index-0F-JFElI.js";/* empty css              */const h=J("span",null," Formulario grado ",-1),De=T({__name:"Form",setup(ee){const y=S(),{toast:B}=P(),p=m({}),f=m(!1),g=U(),w=m(),d=A({form:!1}),v=m([]),o=m({id:null,type_education_id:null,name:null,subjects:[],company_id:null}),C=()=>{for(const t in o.value)o.value[t]=null;o.value.subjects=[]},$=async()=>{var n;o.value.id=g.params.id||null;const t=o.value.id?`/grade/${o.value.id}/edit`:"/grade/create";d.form=!0;const{data:e,response:i}=await F(K(`${t}`,{query:{company_id:y.company.id}}));if(d.form=!1,(n=i.value)!=null&&n.ok&&e.value&&(v.value=e.value.typeEducations,e.value.form)){o.value=e.value.form;const u=JSON.parse(JSON.stringify(o.value));await j(u.type_education_id),o.value.subjects=u.subjects}},N=async()=>{var e,i;const t=await((e=w.value)==null?void 0:e.validate());if(t!=null&&t.valid){o.value.company_id=y.company.id;const n=o.value.id?`/grade/update/${o.value.id}`:"/grade/store";d.form=!0;const{data:u,response:l}=await F(n).post(o.value);d.form=!1,(i=l.value)!=null&&i.ok&&u.value&&u.value.code==200&&R.push({name:"Grade-List"}),u.value.code===422&&(p.value=u.value.errors??{})}else B("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(f.value=!0),E(async()=>{C(),await $()});const c=M(()=>Object.values(d).some(t=>t)),V=m([]),j=async t=>{if(V.value=[],o.value.subjects=[],t){const e=await v.value.find(i=>i.value==t);V.value=e.subjects}};return(t,e)=>{const i=H,n=z,u=Y;return k(),D("div",null,[r(W,{disabled:a(d).form,loading:a(d).form},{default:s(()=>[r(Q,{class:"d-flex justify-space-between"},{default:s(()=>[h]),_:1}),r(q,null,{default:s(()=>[r(X,{ref_key:"formValidation",ref:w,onSubmit:O(()=>{},["prevent"]),disabled:a(f)},{default:s(()=>[r(Z,null,{default:s(()=>[r(_,{cols:"12",sm:"3"},{default:s(()=>[r(i,{clearable:"",modelValue:a(o).type_education_id,"onUpdate:modelValue":[e[0]||(e[0]=l=>a(o).type_education_id=l),e[2]||(e[2]=l=>j(l))],rules:["requiredValidator"in t?t.requiredValidator:a(b)],"error-messages":a(p).type_education_id,label:"Tipo",onInput:e[1]||(e[1]=l=>t.errorsBacktype_education_id=""),requiredField:!0,items:a(v)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),r(_,{cols:"12",sm:"3"},{default:s(()=>[r(n,{clearable:"",modelValue:a(o).name,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).name=l),rules:["requiredValidator"in t?t.requiredValidator:a(b)],"error-messages":a(p).name,label:"Nombre",onInput:e[4]||(e[4]=l=>a(p).name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),r(_,{cols:"12",sm:"3"},{default:s(()=>[r(i,{clearable:"",modelValue:a(o).subjects,"onUpdate:modelValue":e[5]||(e[5]=l=>a(o).subjects=l),"item-value":"id","item-title":"name",label:"Materias",multiple:"",requiredField:!0,items:a(V),rules:["requiredValidator"in t?t.requiredValidator:a(b)]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),r(q,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[r(u,{disabled:a(c),loading:a(c)},null,8,["disabled","loading"]),a(f)?G("",!0):(k(),x(I,{key:0,disabled:a(c),loading:a(c),onClick:e[6]||(e[6]=l=>N()),color:"primary"},{default:s(()=>[L(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{De as default};
