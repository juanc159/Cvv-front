import{V as S,r as x}from"./VForm-0f76fb1a.js";import{d as I,j as T,r as s,a0 as $,$ as j,E as D,o as g,c as E,b as a,f as e,n,g as N,t as _,a9 as q,e as R,aw as A,ax as U}from"./index-a30326ee.js";import{u as v}from"./useImageUpload-51a5fa0f.js";import{u as z}from"./useCrudBannerStore-235db082.js";import{V as G}from"./VCardText-ca73b5bb.js";import{V as c}from"./VRow-3a68e704.js";import{V as m}from"./VCol-0df0a306.js";import{V as H}from"./VFileInput-00efea97.js";import{V as M}from"./VImg-66082724.js";import{V as P}from"./VCard-95ab2cb2.js";import"./helpers-3edea678.js";import"./VField-cc909461.js";import"./sweetalert2.all-ae952bba.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VChip-b913721b.js";import"./VAvatar-8692be98.js";const J=R("b",{class:"text-warning"},"*",-1),ca=I({__name:"Form",setup(K){const d=T(),{toast:k}=U(),f=s(),i=z(),C=$(),{form:p,loading:h}=j(i),V=s({}),y=s(v()),b=s([]),l=s(v()),w=["jpg","jpeg","png"];l.value.allowedExtensions=w;const B=async()=>{var r,u;p.value.company_id=C.company.id;const t=await((r=f.value)==null?void 0:r.validate());if(t!=null&&t.valid){const o=await i.fetchSave();(o==null?void 0:o.code)===200&&(b.value=[],V.value={},y.value.clearData(),await((u=f.value)==null?void 0:u.resetValidation())),(o==null?void 0:o.code)===422&&(V.value=o.errors??{})}else k("Faltan Campos Por Diligenciar","","danger")},F=t=>{l.value.handleImageSelected(t),setTimeout(()=>{p.value.path=l.value.imageFile},1e3)};return D(async()=>{i.clearForm(),d.params.id&&await i.fetchDataForm(Number(d.params.id),d.params.action)}),(t,r)=>{const u=A;return g(),E("div",null,[a(P,null,{default:e(()=>[a(G,null,{default:e(()=>[a(c,null,{default:e(()=>[a(m,null,{default:e(()=>[a(u,{"sub-title":"Formulario Banner",action:String(t.$route.params.action),"btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:t.$router.back},null,8,["action","onChangeScreenBack"])]),_:1})]),_:1}),a(n(S),{ref_key:"formValidation",ref:f,"lazy-validation":""},{default:e(()=>[a(c,null,{default:e(()=>[a(m,{cols:"12",sm:"3"},{default:e(()=>[(g(),N(H,{accept:"image/*",rules:["requiredValidator"in t?t.requiredValidator:n(x)],key:n(l).key,onChange:r[0]||(r[0]=o=>F(o)),"onClick:clear":n(l).clearData},{label:e(()=>[_(" ImagenÂ "),J]),_:1},8,["rules","onClick:clear"]))]),_:1})]),_:1}),a(c,null,{default:e(()=>[a(m,{cols:"12"},{default:e(()=>[a(M,{src:n(l).imageUrl??n(p).path},null,8,["src"])]),_:1})]),_:1}),a(c,null,{default:e(()=>[a(m,{cols:"12",class:"d-flex justify-center"},{default:e(()=>[a(q,{loading:n(h).form,color:"primary",onClick:r[1]||(r[1]=o=>B())},{default:e(()=>[_(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])}}});export{ca as default};
