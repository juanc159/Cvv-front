import{V as O,r as A}from"./VForm-4dea0140.js";import{d as Z}from"./helpers-3edea678.js";import{_ as K}from"./AppTextField.vue_vue_type_script_setup_true_lang-5366d6d0.js";import{d as Q,p as W,r as _,aG as B,L as X,ah as $,o as c,c as h,b as e,f as l,k as r,g as k,e as v,C as y,F as z,m as D,E as q,ag as x,B as F,aA as Y,aB as j,D as ee,a8 as E,ae as N,Z as ae,$ as le,V as te}from"./index-41069d15.js";import{u as P}from"./useImageUpload-1b3ac284.js";import{V as w}from"./VCardText-0f09333a.js";import{V as C}from"./VRow-31ccfeac.js";import{V as p}from"./VCol-a1de57fb.js";import{V as G,b as oe}from"./VCard-598faf64.js";import{V as re}from"./VField-f1777662.js";import{V as ie}from"./VFileInput-7bbaa7d1.js";import{V as ne}from"./VDataTable-24fc04cb.js";import"./VTextField-e73d83ca.js";import"./VImg-5613246e.js";import"./sweetalert2.all-e795d634.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VAvatar-27a696a9.js";import"./VChip-c0bd6850.js";import"./VSelect-083b0325.js";import"./VList-cfef8051.js";import"./ssrBoot-ede5e026.js";import"./VDivider-a80af930.js";import"./dialog-transition-8df5256f.js";import"./VMenu-9a01e84c.js";const se=b=>(ae("data-v-b416e0b4"),b=b(),le(),b),ce=se(()=>v("b",{class:"text-warning"},"*",-1)),de={key:1},ue=["onClick"],pe=Q({__name:"Planning",setup(b){const L=W();_(),_(),_([]);const U=_(P()),R=["jpg","jpeg","png","pdf","ppsx","pptx"];U.value.allowedExtensions=R;const H=async()=>{var i;const a=new FormData;a.append("teacher_id",JSON.stringify(d.value.id));let t=0;d.value.complementaries.forEach(n=>{n.subjects.forEach(o=>{o.files.forEach((f,u)=>{a.append("file_id_"+t,f.id),a.append("file_grade_id_"+t,n.grade_id),a.append("file_section_id_"+t,n.section_id),a.append("file_subject_id_"+t,o.value),a.append("file_file_"+t,f.file),a.append("file_name_"+t,f.name),a.append("file_delete_"+t,f.delete),t++})}),a.append("files_cant",t)}),g.form=!0;const{data:m,response:V}=await $("/teacher-planningStore").post(a);g.form=!1,(i=V.value)!=null&&i.ok&&m.value&&Y.push({name:"Teacher-Index"})},g=B({form:!1}),d=_(),s=B({});X(async()=>{var i;g.form=!0;const{data:a,response:t,error:m,isFetching:V}=await $("/teacher-planning/"+L.params.id).get();g.form=V.value,(i=t.value)!=null&&i.ok&&a.value&&(d.value=a.value.data,d.value.complementaries.forEach(n=>{n.subjects.forEach(o=>{s["file-"+o.value]=_(P()),s["file-"+o.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))});const J=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],M=async a=>{a.files.push({name:s["file-"+a.value].name,file:s["file-"+a.value].imageFile,id:null,delete:0}),s["file-"+a.value].clearData()},I=(a,t,m)=>{a[t].delete=m};return(a,t)=>{const m=j,V=K;return c(),h("div",null,[e(G,null,{default:l(()=>[e(w,null,{default:l(()=>[e(C,null,{default:l(()=>[e(p,null,{default:l(()=>[e(m,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:a.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),r(d)?(c(),k(w,{key:0},{default:l(()=>[e(C,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>{var i,n;return[v("h2",null,y((i=r(d))==null?void 0:i.name)+" "+y((n=r(d))==null?void 0:n.last_name),1)]}),_:1})]),_:1}),e(C,null,{default:l(()=>[(c(!0),h(z,null,D(r(d).complementaries,(i,n)=>(c(),k(p,{cols:"12",key:n},{default:l(()=>[e(G,{class:ee({"green-background":n%2===0,"red-background":n%2!==0})},{default:l(()=>[e(oe,{"primary-title":""},{default:l(()=>[v("h2",null,"Grado: "+y(i.grade_name)+" "+y(i.section_name),1)]),_:2},1024),e(w,null,{default:l(()=>[(c(!0),h(z,null,D(i.subjects,(o,f)=>(c(),h("div",{key:f},[v("h3",null,"Planificacion: "+y(o.title),1),e(r(O),{"lazy-validation":""},{default:l(()=>[e(C,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(V,{clearable:"",modelValue:r(s)["file-"+o.value].name,"onUpdate:modelValue":u=>r(s)["file-"+o.value].name=u,rules:["requiredValidator"in a?a.requiredValidator:r(A)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(re,null,{default:l(()=>[F("Archivo "),ce]),_:1}),(c(),k(ie,{rules:["requiredValidator"in a?a.requiredValidator:r(A)],onChange:r(s)["file-"+o.value].handleImageSelected,key:r(s)["file-"+o.value].key,"onClick:clear":r(s)["file-"+o.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(x,{size:"30",class:"mt-6",icon:"",color:"success",onClick:u=>M(o)},{default:l(()=>[e(E,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),e(p,{cols:"12"},{default:l(()=>[e(r(ne),{headers:J,items:o.files,"items-per-page":999},{"item.actions":l(({item:u,index:S})=>[v("div",null,[u.id?(c(),k(x,{key:0,icon:"",size:"x-small",color:"primary",variant:"text",onClick:T=>("descargarArchivo"in a?a.descargarArchivo:r(Z))(u.file,u.name)},{default:l(()=>[e(E,{size:"22",icon:"tabler-eye"}),e(N,{location:"top",transition:"scale-transition",activator:"parent",text:"Visualizar"})]),_:2},1032,["onClick"])):q("",!0),u.delete?(c(),h("span",de,[F(" Sera eliminado al guardar, "),v("b",{style:{cursor:"pointer"},onClick:T=>I(o.files,S,0)},"restaurar",8,ue)])):(c(),k(x,{key:2,icon:"",size:"x-small",color:"error",variant:"text",onClick:T=>I(o.files,S,1)},{default:l(()=>[e(E,{size:"22",icon:"tabler-trash"}),e(N,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]))])]),bottom:l(()=>[]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),_:1})):q("",!0),e(C,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(x,{loading:r(g).form,color:"primary",onClick:t[0]||(t[0]=i=>H())},{default:l(()=>[F(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}});const Pe=te(pe,[["__scopeId","data-v-b416e0b4"]]);export{Pe as default};
