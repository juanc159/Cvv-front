import{_ as Ve}from"./BtnBack.vue_vue_type_script_setup_true_lang-Bk-jEoB0.js";import{_ as Pe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-D796b4Uc.js";import{_ as he}from"./AppSelectRemote-Di2kvgnC.js";import{_ as ke}from"./AppTextField.vue_vue_type_script_setup_true_lang-CSUd6utx.js";import{_ as Ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-Co4K0IY6.js";import{ae as O,af as z,a2 as ue,cK as Se,aq as K,b as a,bS as Ce,cL as Ie,aQ as le,Q as de,R as we,bL as Ae,aS as re,Y as V,by as Te,aE as ce,a7 as $e,aZ as ie,cy as Re,bh as Fe,al as je,aP as ve,av as Be,cz as Ne,bn as De,a0 as Le,cu as Ue,aj as qe,bl as Ge,aK as y,at as Me,cM as Oe,cw as ze,d as Ke,V as Qe,t as Ze,r as $,a$ as Ye,N as He,c as k,o as m,f as s,ac as Je,h as q,y as F,F as G,q as M,D as J,E as x,a9 as W,e as f,l as We,G as Xe,aO as ea,b2 as aa,aR as la,b0 as ta,Z as na,$ as sa}from"./index-ByDS42or.js";import{c as oa}from"./createUrl-Dn6bmref.js";import{a as ia,V as ua}from"./VCard-Dezrb7fV.js";import{V as X}from"./VCardText-CRFn74Z4.js";import{V as da}from"./VForm-Bo2H133k.js";import{V as j,a as E}from"./VRow-BVDvheM5.js";import{V as ra}from"./VTable-WfQ04ZXP.js";import{_ as ca}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-2fJt202g.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BmiBEwCM.js";import"./VDialog-CMPgUipT.js";import"./dialog-transition-ymB-VPfO.js";import"./VSelect-6mppdgrf.js";import"./VTextField-BSqJvjJB.js";/* empty css                   */import"./VCounter-dqrrb-Y0.js";import"./VImg-DTWKOLRH.js";import"./VList-DfcpPokg.js";import"./ssrBoot-_3Xo5dRQ.js";import"./VAvatar-Br4-W3BH.js";import"./VDivider-D45ckF3f.js";import"./VMenu-hs6MJuAQ.js";import"./VCheckboxBtn-IxLE1e6I.js";import"./VSelectionControl-_XC2OU_8.js";import"./VChip-DyHRgmO-.js";import"./filter-VEPPva_l.js";import"./helpers-CYfJIYD9.js";import"./constants-2GBt7OCP.js";import"./index-0F-JFElI.js";/* empty css              */const B=Symbol.for("vuetify:v-expansion-panel"),me=z({...le(),...Ie()},"VExpansionPanelText"),ee=O()({name:"VExpansionPanelText",props:me(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:r}=Se(e,n.isSelected);return K(()=>a(Ce,{onAfterLeave:r},{default:()=>{var _;return[de(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&u.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(_=o.default)==null?void 0:_.call(o)])]),[[we,n.isSelected.value]])]}})),{}}}),pe=z({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...le()},"VExpansionPanelTitle"),ae=O()({name:"VExpansionPanelTitle",directives:{Ripple:Ae},props:pe(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"color"),_=V(()=>({collapseIcon:e.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),v=V(()=>n.isSelected.value?e.collapseIcon:e.expandIcon);return K(()=>{var S;return de(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[r.value,e.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:e.readonly?void 0:n.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(S=o.default)==null?void 0:S.call(o,_.value),!e.hideActions&&a(ce,{defaults:{VIcon:{icon:v.value}}},{default:()=>{var P;return[a("span",{class:"v-expansion-panel-title__icon"},[((P=o.actions)==null?void 0:P.call(o,_.value))??a($e,null,null)])]}})]),[[Te("ripple"),e.ripple]])}),{}}}),fe=z({title:String,text:String,bgColor:String,...De(),...Ne(),...Be(),...ve(),...pe(),...me()},"VExpansionPanel"),va=O()({name:"VExpansionPanel",props:fe(),emits:{"group:selected":e=>!0},setup(e,b){let{slots:o}=b;const n=Re(e,B),{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"bgColor"),{elevationClasses:_}=Fe(e),{roundedClasses:v}=je(e),S=V(()=>(n==null?void 0:n.disabled.value)||e.disabled),P=V(()=>n.group.items.value.reduce((h,p,R)=>(n.group.selected.value.includes(p.id)&&h.push(R),h),[])),t=V(()=>{const h=n.group.items.value.findIndex(p=>p.id===n.id);return!n.isSelected.value&&P.value.some(p=>p-h===1)}),Z=V(()=>{const h=n.group.items.value.findIndex(p=>p.id===n.id);return!n.isSelected.value&&P.value.some(p=>p-h===-1)});return Le(B,n),K(()=>{const h=!!(o.text||e.text),p=!!(o.title||e.title),R=ae.filterProps(e),N=ee.filterProps(e);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":t.value,"v-expansion-panel--after-active":Z.value,"v-expansion-panel--disabled":S.value},v.value,u.value,e.class],style:[r.value,e.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",..._.value]},null),a(ce,{defaults:{VExpansionPanelTitle:{...R},VExpansionPanelText:{...N}}},{default:()=>{var w;return[p&&a(ae,{key:"title"},{default:()=>[o.title?o.title():e.title]}),h&&a(ee,{key:"text"},{default:()=>[o.text?o.text():e.text]}),(w=o.default)==null?void 0:w.call(o)]}})]})}),{groupItem:n}}}),ma=["default","accordion","inset","popout"],pa=z({flat:Boolean,...ze(),...Oe(fe(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...Me(),...le(),...ve(),variant:{type:String,default:"default",validator:e=>ma.includes(e)}},"VExpansionPanels"),fa=O()({name:"VExpansionPanels",props:pa(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:o}=b;const{next:n,prev:u}=Ue(e,B),{themeClasses:r}=qe(e),_=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Ge({VExpansionPanel:{bgColor:y(e,"bgColor"),collapseIcon:y(e,"collapseIcon"),color:y(e,"color"),eager:y(e,"eager"),elevation:y(e,"elevation"),expandIcon:y(e,"expandIcon"),focusable:y(e,"focusable"),hideActions:y(e,"hideActions"),readonly:y(e,"readonly"),ripple:y(e,"ripple"),rounded:y(e,"rounded"),static:y(e,"static")}}),K(()=>a(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,_.value,e.class],style:e.style},{default:()=>{var v;return[(v=o.default)==null?void 0:v.call(o,{prev:u,next:n})]}})),{next:n,prev:u}}}),Q=e=>(na("data-v-3260d25e"),e=e(),sa(),e),_a=Q(()=>f("span",null," Formulario periodo escolar ",-1)),ga={key:0,class:"error--text"},ya={class:"text-center"},xa={class:"text-center"},ba=Q(()=>f("p",{class:"text-center"}," Reporte de materia pendiente. ",-1)),Va=Q(()=>f("th",null,"No.",-1)),Pa=Q(()=>f("th",null,"ALUMNO",-1)),ha={key:0},ka=["colspan"],Ea=Ke({__name:"Form",setup(e){const b=Qe(),o=Ze(),{toast:n}=ta(),u=$({}),r=$(!1),_=$(),v=Ye({form:!1}),S=$([]),P=$([]),t=$({id:null,term_id:null,type_education_id:null,grade_id:null,code:null,students:[]}),Z=()=>{t.value={id:null,term_id:null,type_education_id:null,grade_id:null,students:[]}},h=async()=>{var A;t.value.id=o.params.id;const i=t.value.id?`/pendingRegistration/${t.value.id}/edit`:"/pendingRegistration/create";v.form=!0;const{data:l,response:C}=await ea(oa(`${i}`,{query:{company_id:b.company.id}}));v.form=!1,(A=C.value)!=null&&A.ok&&l.value&&(l.value.form&&(t.value={id:l.value.form.id||null,term_id:l.value.form.term_id||null,code:l.value.form.code||null,type_education_id:l.value.form.type_education_id||null,grade_id:l.value.form.grade_id||null,students:l.value.form.students||[]}),l.value.terms&&(S.value=l.value.terms),l.value.typeEducations&&(P.value=l.value.typeEducations))},p=()=>{t.value.students.push({student_id:null,subjects:[]})},R=i=>{t.value.students.splice(i,1)},N=async()=>{var l;const i=await((l=_.value)==null?void 0:l.validate());if(i!=null&&i.valid){const C={...t.value,company_id:b.company.id,students:t.value.students.map(L=>({student_id:L.student_id,subjects:L.subjects}))},A=t.value.id?`/pendingRegistration/update/${t.value.id}`:"/pendingRegistration/store";v.form=!0;const{data:T,response:H}=await aa(A).post(C);v.form=!1,H.status==200&&T&&T.code===200&&la.push({name:"PendingRegistration-List"}),T.code===422&&(u.value=T.errors??{})}else n("Faltan campos por diligenciar","","danger")};o.params.action==="view"&&(r.value=!0),He(async()=>{Z(),await h()});const w=V(()=>Object.values(v).some(i=>i)),_e=[i=>!!i||"El código es obligatorio"],te=[i=>!!i||"El periodo es obligatorio"],ge=[i=>!!i||"El grado es obligatorio"],ye=[i=>!!i||"El estudiante es obligatorio"],xe=[i=>i.length>0||"Debe seleccionar al menos una materia"],Y=V(()=>{if(t.value.type_education_id){const i=P.value.find(l=>l.value==t.value.type_education_id);return i?i.grades:[]}return[]}),ne=V(()=>t.value.grade_id?Y.value.find(i=>i.value==t.value.grade_id).subjects:[]),D=V(()=>{const i=t.value.students.flatMap(l=>l.subjects);return[...new Set(i)].map(l=>ne.value.find(C=>C.value===l)).filter(l=>l!==void 0)});return(i,l)=>{const C=Ee,A=ke,T=he,H=Pe,L=Ve;return m(),k("div",null,[a(ua,{disabled:v.form,loading:v.form},{default:s(()=>[a(ia,{class:"d-flex justify-space-between"},{default:s(()=>[_a]),_:1}),a(X,null,{default:s(()=>[a(da,{ref_key:"formValidation",ref:_,onSubmit:Je(N,["prevent"]),disabled:r.value},{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.term_id,"onUpdate:modelValue":l[0]||(l[0]=d=>t.value.term_id=d),items:S.value,label:"Periodo",rules:te,"error-messages":u.value.term_id,onChange:l[1]||(l[1]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(A,{requiredField:"true",modelValue:t.value.code,"onUpdate:modelValue":l[2]||(l[2]=d=>t.value.code=d),rules:_e,label:"Código de sección"},null,8,["modelValue"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.type_education_id,"onUpdate:modelValue":l[3]||(l[3]=d=>t.value.type_education_id=d),items:P.value,label:"Tipo de educación",rules:te,"error-messages":u.value.term_id,onChange:l[4]||(l[4]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:t.value.grade_id,"onUpdate:modelValue":l[5]||(l[5]=d=>t.value.grade_id=d),items:Y.value,label:"Grados y niveles",rules:ge,"error-messages":u.value.grade_id,onChange:l[6]||(l[6]=d=>u.value.grade_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12"},{default:s(()=>[a(fa,{multiple:""},{default:s(()=>[(m(!0),k(G,null,M(t.value.students,(d,g)=>(m(),q(va,{key:g},{default:s(()=>[a(ae,null,{actions:s(()=>[r.value?F("",!0):(m(),q(W,{key:0,icon:"tabler-x",color:"error",onClick:I=>R(g)},null,8,["onClick"]))]),default:s(()=>[J(" Estudiante "+x(g+1)+" ",1)]),_:2},1024),a(ee,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"6"},{default:s(()=>[a(T,{modelValue:d.student_id,"onUpdate:modelValue":I=>d.student_id=I,url:"selectInfiniteStudent",arrayInfo:"student",rules:ye,label:"Estudiante","error-messages":u.value[`students.${g}.student_id`],onInput:I=>u.value[`students.${g}.student_id`]="",readonly:r.value,params:{type_education_id:t.value.type_education_id}},null,8,["modelValue","onUpdate:modelValue","error-messages","onInput","readonly","params"])]),_:2},1024),a(E,{cols:"12",md:"6"},{default:s(()=>[a(H,{modelValue:d.subjects,"onUpdate:modelValue":I=>d.subjects=I,items:ne.value,label:"Materias",multiple:"",chips:"","closable-chips":"",rules:xe,"error-messages":u.value[`students.${g}.subjects`],onInput:I=>u.value[`students.${g}.subjects`]="",readonly:r.value},null,8,["modelValue","onUpdate:modelValue","items","error-messages","onInput","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value?F("",!0):(m(),q(W,{key:0,color:"primary",onClick:p,class:"mt-2"},{default:s(()=>[J(" Agregar Estudiante ")]),_:1}))]),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>[Object.keys(u.value).length>0?(m(),k("div",ga," Por favor, corrige los errores indicados. ")):F("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),a(X,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d;return[f("h2",ya,x(We(b).company.name),1),f("p",xa," Año Escolar: "+x(((d=S.value.find(g=>g.value===t.value.term_id))==null?void 0:d.title)||"N/A")+" | Fecha: "+x(new Date().toLocaleDateString("es-ES")),1),ba]}),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d,g,I;return[f("h3",null," Sección: "+x(((d=S.value.find(c=>c.value===t.value.term_id))==null?void 0:d.title)||"N/A")+" - "+x(((g=P.value.find(c=>c.value===t.value.type_education_id))==null?void 0:g.title)||"N/A")+" - "+x(((I=Y.value.find(c=>c.value===t.value.grade_id))==null?void 0:I.title)||"N/A")+" - "+x(t.value.code||"N/A"),1),a(ra,{class:"bordered-table"},{default:s(()=>[f("thead",null,[f("tr",null,[Va,Pa,(m(!0),k(G,null,M(D.value,c=>(m(),k("th",{key:c.value},x(c.abbreviation||c.title),1))),128))])]),f("tbody",null,[(m(!0),k(G,null,M(t.value.students,(c,be)=>{var se,oe;return m(),k("tr",{key:(se=c.student_id)==null?void 0:se.value},[f("td",null,x(be+1),1),f("td",null,x(((oe=c.student_id)==null?void 0:oe.title)||"N/A"),1),(m(!0),k(G,null,M(D.value,U=>(m(),k("td",{key:U.value,class:Xe({"bg-yellow-lighten-3":c.subjects.includes(U.value),"bg-grey-lighten-3":!c.subjects.includes(U.value)&&D.value.length>0})},x(c.subjects.includes(U.value)?"--":""),3))),128))])}),128)),t.value.students.length?F("",!0):(m(),k("tr",ha,[f("td",{colspan:D.value.length+2,class:"text-center"}," No hay estudiantes seleccionados. ",8,ka)]))])]),_:1})]}),_:1})]),_:1})]),_:1}),a(X,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[a(L,{disabled:w.value,loading:w.value},null,8,["disabled","loading"]),r.value?F("",!0):(m(),q(W,{key:0,disabled:w.value,loading:w.value,onClick:N,color:"primary"},{default:s(()=>[J(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}}),il=ca(Ea,[["__scopeId","data-v-3260d25e"]]);export{il as default};
