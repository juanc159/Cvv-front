import{V as K,r as S}from"./VForm-BJhwRq6d.js";import{d as O,s as Q}from"./helpers-B_m2l3ye.js";import{_ as W}from"./AppTextField.vue_vue_type_script_setup_true_lang-C0MivaU_.js";import{_ as X}from"./HeaderAlertView.vue_vue_type_script_setup_true_lang-Bo_lO2CK.js";import{d as Y,r as _,ax as $,M as Z,af as z,o as c,c as k,b as a,f as l,q as j,k as r,g as V,e as v,D as h,F as A,p as q,E as ee,C as x,ad as b,a8 as E,G as D,al as ae,$ as le,a0 as te}from"./index-DIyPu2n-.js";import{u as N,V as oe}from"./VFileInput-DIDaneqK.js";import{V as G,b as re}from"./VCard-B7mzswJk.js";import{V as w}from"./VGrid-BcXXTAEE.js";import{V as C,a as p}from"./VRow-CI_zrIUd.js";import{V as ie}from"./VInput-BwqZ5sdn.js";import{V as ne}from"./VDataTable-DDygFyNj.js";import{V as P}from"./VTooltip-DJp5BLXe.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./forwardRefs-C-GTDzx5.js";import"./constants-2GBt7OCP.js";import"./VTextField-DQo78I90.js";import"./VImg-BpKv5MOY.js";import"./VAlert-BIx2v0D_.js";import"./VAvatar-CM2QcUUV.js";import"./sweetalert2.esm.all-DOYwHpwi.js";import"./VChip-DFTErpd2.js";import"./VOverlay-Ccbj0hdB.js";import"./VSelect-BuS0nwkg.js";import"./VList-CMTaG0P-.js";import"./ssrBoot-Bm2AJ9kZ.js";import"./VDivider-CG8nLZlY.js";import"./dialog-transition-DtVn6ULP.js";import"./VMenu-BpruL3NV.js";import"./VCheckboxBtn-wG_U6moa.js";import"./VSelectionControl-DdNTnAZP.js";const ce=y=>(le("data-v-5d441c62"),y=y(),te(),y),de=ce(()=>v("b",{class:"text-warning"},"*",-1)),ue={key:1},pe=["onClick"],me=Y({__name:"Planning",setup(y){const U=j();_(),_(),_([]);const L=_(N()),M=["jpg","jpeg","png","pdf","ppsx","pptx"];L.value.allowedExtensions=M;const R=async()=>{var i;const e=new FormData;e.append("teacher_id",d.value.id);let t=0;d.value.complementaries.forEach(n=>{n.subjects.forEach(o=>{o.files.forEach((f,u)=>{e.append("file_id_"+t,f.id),e.append("file_grade_id_"+t,n.grade_id),e.append("file_section_id_"+t,n.section_id),e.append("file_subject_id_"+t,o.value),e.append("file_file_"+t,f.file),e.append("file_name_"+t,f.name),e.append("file_delete_"+t,f.delete),t++})}),e.append("files_cant",t)}),g.form=!0;const{data:m,response:F}=await z("/teacher-planningStore").post(e);g.form=!1,(i=F.value)!=null&&i.ok&&m.value&&ae.push({name:"Teacher-Index"})},g=$({form:!1}),d=_(),s=$({});Z(async()=>{var i;g.form=!0;const{data:e,response:t,error:m,isFetching:F}=await z("/teacher-planning/"+U.params.id).get();g.form=!1,(i=t.value)!=null&&i.ok&&e.value&&(d.value=e.value.data,d.value.complementaries.forEach(n=>{n.subjects.forEach(o=>{s["file-"+o.value]=_(N()),s["file-"+o.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))});const H=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],J=async e=>{e.files.push({name:s["file-"+e.value].name,file:s["file-"+e.value].imageFile,id:null,delete:0}),s["file-"+e.value].clearData()},B=(e,t,m)=>{e[t].delete=m};return(e,t)=>{const m=X,F=W;return c(),k("div",null,[a(G,null,{default:l(()=>[a(w,null,{default:l(()=>[a(C,null,{default:l(()=>[a(p,null,{default:l(()=>[a(m,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:e.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),r(d)?(c(),V(w,{key:0},{default:l(()=>[a(C,null,{default:l(()=>[a(p,{cols:"12",sm:"6"},{default:l(()=>{var i,n;return[v("h2",null,h((i=r(d))==null?void 0:i.name)+" "+h((n=r(d))==null?void 0:n.last_name),1)]}),_:1})]),_:1}),a(C,null,{default:l(()=>[(c(!0),k(A,null,q(r(d).complementaries,(i,n)=>(c(),V(p,{cols:"12",key:n},{default:l(()=>[a(G,{class:ee({"green-background":n%2===0,"red-background":n%2!==0})},{default:l(()=>[a(re,{"primary-title":""},{default:l(()=>[v("h2",null,"Grado: "+h(i.grade_name)+" "+h(i.section_name),1)]),_:2},1024),a(w,null,{default:l(()=>[(c(!0),k(A,null,q(i.subjects,(o,f)=>(c(),k("div",{key:f},[v("h3",null,"Planificacion: "+h(o.title),1),a(r(K),{"lazy-validation":""},{default:l(()=>[a(C,null,{default:l(()=>[a(p,{cols:"12",sm:"6"},{default:l(()=>[a(F,{clearable:"",modelValue:r(s)["file-"+o.value].name,"onUpdate:modelValue":u=>r(s)["file-"+o.value].name=u,rules:["requiredValidator"in e?e.requiredValidator:r(S)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(p,{cols:"12",sm:"3"},{default:l(()=>[a(ie,null,{default:l(()=>[x("Archivo "),de]),_:1}),(c(),V(oe,{rules:["requiredValidator"in e?e.requiredValidator:r(S)],onChange:r(s)["file-"+o.value].handleImageSelected,key:r(s)["file-"+o.value].key,"onClick:clear":r(s)["file-"+o.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),a(p,{cols:"12",sm:"3"},{default:l(()=>[a(b,{size:"30",class:"mt-6",icon:"",color:"success",onClick:u=>J(o)},{default:l(()=>[a(E,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),a(p,{cols:"12"},{default:l(()=>[a(ne,{headers:H,items:o.files,"items-per-page":999},{"item.actions":l(({item:u,index:T})=>[v("div",null,[u.id?(c(),V(b,{key:0,icon:"",size:"x-small",color:"primary",variant:"text",onClick:I=>("descargarArchivo"in e?e.descargarArchivo:r(O))(("storageBack"in e?e.storageBack:r(Q))(u.file),u.name)},{default:l(()=>[a(E,{size:"22",icon:"tabler-eye"}),a(P,{location:"top",transition:"scale-transition",activator:"parent",text:"Visualizar"})]),_:2},1032,["onClick"])):D("",!0),u.delete?(c(),k("span",ue,[x(" Sera eliminado al guardar, "),v("b",{style:{cursor:"pointer"},onClick:I=>B(o.files,T,0)},"restaurar",8,pe)])):(c(),V(b,{key:2,icon:"",size:"x-small",color:"error",variant:"text",onClick:I=>B(o.files,T,1)},{default:l(()=>[a(E,{size:"22",icon:"tabler-trash"}),a(P,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]))])]),bottom:l(()=>[]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),_:1})):D("",!0),a(C,null,{default:l(()=>[a(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[a(b,{loading:r(g).form,color:"primary",onClick:t[0]||(t[0]=i=>R())},{default:l(()=>[x(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),He=se(me,[["__scopeId","data-v-5d441c62"]]);export{He as default};
