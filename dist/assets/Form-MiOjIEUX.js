import{r as $}from"./validators-DGW2_v18.js";import{s as q}from"./helpers-B_D3gEzg.js";import{d as M,V as A,r as d,t as E,aU as L,N as R,w as G,Y as J,c as O,o as f,b as i,f as l,e as C,l as e,a9 as P,h as v,D as k,y,a8 as Y,aJ as F,aM as z,aV as H}from"./index-BtPrw34q.js";import{_ as K}from"./BtnBack.vue_vue_type_script_setup_true_lang-CTWZmH9l.js";import{u as Q,V as W}from"./VFileInput-D3Nfawqw.js";import{a as X,V as Z}from"./VCard-BEAqT0ca.js";import{V as h}from"./VCardText-Z36eyzCX.js";import{V as aa}from"./VForm-BEGpeZ2M.js";import{V as w,a as B}from"./VRow-Bmxsg9Yu.js";import{V as ea}from"./VImg-xvMxTqcW.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-B5kva452.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-DcqQcj6Q.js";import"./VDialog-BTgBBGt0.js";import"./VOverlay-B5b-L0xY.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-CjlEn4ZK.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./VInput-DgIp7pGl.js";import"./VCounter-BKfT5Flo.js";import"./VChip-WZ11lR4t.js";import"./VAvatar-C06t2Pxx.js";/* empty css              */const oa=C("span",null," Formulario Banner ",-1),ta=C("b",{class:"text-warning"},"*",-1),ja=M({__name:"Form",setup(la){const x=A(),{toast:j}=H(),D=d({}),p=d(!1),g=E(),V=d(),n=L({form:!1}),o=d({id:null,path:null,company_id:null}),N=()=>{for(const a in o.value)o.value[a]=null},T=async()=>{var u;o.value.id=g.params.id||null;const a=o.value.id?`/banner/${o.value.id}/edit`:"/banner/create";n.form=!0;const{response:r,data:s}=await F(a).get();n.form=!1,(u=r.value)!=null&&u.ok&&s.value&&s.value.form&&(o.value=s.value.form)},I=async()=>{var r,s;const a=await((r=V.value)==null?void 0:r.validate());if(a!=null&&a.valid){o.value.company_id=x.company.id;const u=o.value.id?`/banner/update/${o.value.id}`:"/banner/store";t.value.imageFile&&(o.value.path=t.value.imageFile);const _=new FormData;for(const b in o.value)_.append(b,o.value[b]);n.form=!0;const{data:c,response:U}=await F(u).post(_);n.form=!1,(s=U.value)!=null&&s.ok&&c.value&&c.value.code==200&&z.push({name:"Banner-List"}),c.value.code===422&&(D.value=c.value.errors??{})}else j("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(p.value=!0),R(async()=>{N(),await T()});const t=d(Q());t.value.allowedExtensions=["jpg","jpeg","png"],G(t.value,(a,r)=>{a.imageFile&&(o.value.path=a.imageFile)});const m=J(()=>Object.values(n).some(a=>a)),S=a=>{t.value.handleImageSelected(a),setTimeout(()=>{o.value.path=t.value.imageFile},1e3)};return(a,r)=>{const s=K;return f(),O("div",null,[i(Z,{disabled:e(n).form,loading:e(n).form},{default:l(()=>[i(X,{class:"d-flex justify-space-between"},{default:l(()=>[oa]),_:1}),i(h,null,{default:l(()=>[i(aa,{ref_key:"formValidation",ref:V,onSubmit:P(()=>{},["prevent"]),disabled:e(p)},{default:l(()=>[i(w,null,{default:l(()=>[i(B,{sm:"4"},{default:l(()=>[(f(),v(W,{accept:"image/*",loading:e(t).loading,onChange:r[0]||(r[0]=u=>S(u)),key:e(t).key,"onClick:clear":e(t).clearData,rules:["requiredValidator"in a?a.requiredValidator:e($)]},{label:l(()=>[k(" ImagenÂ "),ta]),_:1},8,["loading","onClick:clear","rules"]))]),_:1})]),_:1}),i(w,null,{default:l(()=>[e(t).imageUrl||e(o).path?(f(),v(B,{key:0,class:"d-flex justify-center"},{default:l(()=>[i(ea,{src:e(t).imageUrl??("storageBack"in a?a.storageBack:e(q))(e(o).path),alt:"alt"},null,8,["src"])]),_:1})):y("",!0)]),_:1})]),_:1},8,["disabled"])]),_:1}),i(h,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:l(()=>[i(s,{disabled:e(m),loading:e(m)},null,8,["disabled","loading"]),e(p)?y("",!0):(f(),v(Y,{key:0,disabled:e(m),loading:e(m),onClick:r[1]||(r[1]=u=>I()),color:"primary"},{default:l(()=>[k(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{ja as default};
