import{V as j,r as N}from"./VForm-BoF2taKj.js";import{_ as J}from"./DragAndDrop.vue_vue_type_script_setup_true_lang-Cl1GfLz3.js";import{_ as K}from"./AppSelect.vue_vue_type_script_setup_true_lang-4lSDkSNC.js";import{d as O,U as Q,ax as W,r as n,M as X,af as p,Z as Y,o as _,c as q,b as e,f as a,k as l,C as c,g as S,ad as U,e as D,ae as ee,F as I,p as L,D as ae,ay as le}from"./index-XAxmUuBU.js";import{u as oe,V as te}from"./VFileInput-Bq8dZXwP.js";import{c as se}from"./createUrl-NC_h4V2G.js";import{b as ie}from"./helpers-CrMfgFGd.js";import{V as k,b as z}from"./VCard-BQYrq4U8.js";import{V as v}from"./VGrid-tMgPPhFT.js";import{V as m,a as u}from"./VRow-Bl0u0Gco.js";import{V as re}from"./VInput-UhPKCbVL.js";import{V as P}from"./VSwitch-BgM56xqS.js";import{V as de}from"./VDivider-DOw4_X1q.js";import"./forwardRefs-C-GTDzx5.js";import"./VImg-BZHy_5El.js";import"./VSpacer-9FBtvQ9H.js";import"./VAvatar-BHpdbSk7.js";import"./VTooltip-X5YcPelC.js";import"./VOverlay-DpT-NkBd.js";import"./VSelect-BGSZH8Kq.js";import"./VTextField-jWqPGEyU.js";import"./VList-DcKwGH4J.js";import"./ssrBoot-CGtueF5U.js";import"./dialog-transition-DUXW318i.js";import"./VMenu-BPEp48IE.js";import"./VCheckboxBtn-DSuq3ah-.js";import"./VSelectionControl-BXHk7c7E.js";import"./VChip-DuRBhMnS.js";import"./sweetalert2.esm.all-DOYwHpwi.js";import"./index-0F-JFElI.js";import"./constants-2GBt7OCP.js";const ne=D("b",{class:"text-warning"},"*",-1),ue={class:"demo-space-x"},me={class:"demo-space-x"},Ge=O({__name:"Index",setup(ce){const B=Q(),{toast:$}=le(),s=W({form:!1,excel:!1}),f=n({company_id:null,type_education_id:null,archive:null}),w=n({}),A=n(),T=n(),V=n([]),y=n(oe());y.value.allowedExtensions=["xls","xlsx"];const g=n(!1),C=n({});X(async()=>{var r;await h(),s.form=!0;const{data:t,response:o}=await p("note-dataForm").get();(r=o.value)!=null&&r.ok&&t.value&&(V.value=t.value.typeEducations,g.value=t.value.blockData),s.form=!1});const h=async()=>{var r;const{data:t,response:o}=await p("/type_educations/visualization/show").get();(r=o.value)!=null&&r.ok&&t.value&&(C.value=t.value.selectedNotes)},M=async()=>{var o;f.value.archive=y.value.imageFile,f.value.company_id=B.company.id;const t=await((o=A.value)==null?void 0:o.validate());if(t!=null&&t.valid){const r=new FormData;for(const d in f.value)r.append(d,f.value[d]);s.form=!0,await p("note-store").post(r),s.form=!1}else $("Faltan Campos Por Diligenciar","","danger")},x=n({type_education_id:null}),R=async()=>{var o,r;const t=await((o=T.value)==null?void 0:o.validate());if(t!=null&&t.valid){s.excel=!0;const d=V.value.find(F=>F.value==x.value.type_education_id),{data:i,response:b}=await p(se("/note-downloadAllConsolidated",{query:{type_education_id:x.value.type_education_id,company_id:B.company.id}}));s.excel=!1,(r=b.value)!=null&&r.ok&&i.value&&ie(i.value.excel,"Consolidado "+(d==null?void 0:d.title))}else $("Faltan Campos Por Diligenciar","","danger")},E=async t=>{var d;const{data:o,response:r}=await p("/note-blockPayrollUpload").post({value:t});(d=r.value)!=null&&d.ok&&o.value},G=Y(()=>g.value?"Sí":"No"),Z=async()=>{s.form=!0,await p("/type_educations/visualization/store").post({selectedNotes:C.value}),s.form=!1};return(t,o)=>{const r=K,d=J;return _(),q("div",null,[e(k,{disabled:l(s).form,loading:l(s).form},{default:a(()=>[e(z,{"primary-title":""},{default:a(()=>[c("Cargar Notas")]),_:1}),e(v,null,{default:a(()=>[e(l(j),{ref_key:"formValidation",ref:A,"lazy-validation":""},{default:a(()=>[e(m,null,{default:a(()=>[e(u,{cols:"12",sm:"4"},{default:a(()=>[e(r,{clearable:"",modelValue:l(f).type_education_id,"onUpdate:modelValue":o[0]||(o[0]=i=>l(f).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:l(N)],"error-messages":l(w).type_education_id,label:"Tipo",onChange:o[1]||(o[1]=i=>l(w).type_education_id=""),requiredField:!0,items:l(V)},null,8,["modelValue","rules","error-messages","items"])]),_:1}),e(u,{cols:"12",sm:"4"},{default:a(()=>[e(re,null,{default:a(()=>[c("Archivo "),ne]),_:1}),(_(),S(te,{key:l(y).key,onChange:l(y).handleImageSelected,"onClick:clear":l(y).clearData,rules:["requiredValidator"in t?t.requiredValidator:l(N)]},null,8,["onChange","onClick:clear","rules"]))]),_:1})]),_:1}),e(m,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[e(U,{loading:l(s).form,disabled:l(s).form,color:"primary",onClick:o[2]||(o[2]=i=>M())},{default:a(()=>[c(" Cargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),e(k,{disabled:l(s).form,loading:l(s).form,class:"mt-3"},{default:a(()=>[e(z,{"primary-title":""},{default:a(()=>[c("Descargar Notas")]),_:1}),e(v,null,{default:a(()=>[e(l(j),{ref_key:"formValidationDownload",ref:T,"lazy-validation":""},{default:a(()=>[e(m,null,{default:a(()=>[e(u,{cols:"12",sm:"4"},{default:a(()=>[e(r,{clearable:"",modelValue:l(x).type_education_id,"onUpdate:modelValue":o[3]||(o[3]=i=>l(x).type_education_id=i),rules:["requiredValidator"in t?t.requiredValidator:l(N)],"error-messages":l(w).type_education_id,label:"Tipo",onChange:o[4]||(o[4]=i=>l(w).type_education_id=""),requiredField:!0,items:l(V)},null,8,["modelValue","rules","error-messages","items"])]),_:1})]),_:1}),e(m,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[e(U,{loading:l(s).excel,disabled:l(s).excel,color:"primary",onClick:o[5]||(o[5]=i=>R())},{default:a(()=>[c(" Descargar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["disabled","loading"]),e(k,{disabled:l(s).form,loading:l(s).form,class:"mt-3"},{default:a(()=>[e(z,{"primary-title":""},{default:a(()=>[c("Bloquear carga de notas a los profesores")]),_:1}),e(v,null,{default:a(()=>[e(m,null,{default:a(()=>[e(u,{cols:"12",sm:"4"},{default:a(()=>[D("div",ue,[e(P,{modelValue:l(g),"onUpdate:modelValue":[o[6]||(o[6]=i=>ee(g)?g.value=i:null),o[7]||(o[7]=i=>E(i))],label:l(G),color:"success"},null,8,["modelValue","label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"]),e(k,{disabled:l(s).form,loading:l(s).form,class:"mt-3",title:"Visualización de las notas"},{default:a(()=>[(_(!0),q(I,null,L(l(V),i=>(_(),S(v,{key:i.value},{default:a(()=>[e(de),e(m,null,{default:a(()=>[e(u,null,{default:a(()=>[D("span",null,ae(i.title),1)]),_:2},1024)]),_:2},1024),e(m,null,{default:a(()=>[(_(!0),q(I,null,L(i.cantNotes,(b,F)=>(_(),S(u,{cols:"12",sm:"4",key:F},{default:a(()=>[D("div",me,[e(P,{modelValue:l(C)[i.value]["note_"+b],"onUpdate:modelValue":H=>l(C)[i.value]["note_"+b]=H,label:"Nota "+b,color:"success"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128)),e(v,null,{default:a(()=>[e(m,null,{default:a(()=>[e(u,{cols:"12",class:"d-flex justify-center"},{default:a(()=>[e(U,{loading:l(s).form,disabled:l(s).form,color:"primary",onClick:o[8]||(o[8]=i=>Z())},{default:a(()=>[c(" Guardar Visualización ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","loading"]),e(k,{title:"Carga de archivos masivos",class:"mt-3"},{default:a(()=>[e(v,null,{default:a(()=>[e(d)]),_:1})]),_:1})])}}});export{Ge as default};
