import{_ as Ve}from"./BtnBack.vue_vue_type_script_setup_true_lang-6NFJP1r7.js";import{_ as Pe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-BjRGXNI-.js";import{_ as ke}from"./AppSelectRemote-Bb_MliS1.js";import{_ as he}from"./AppTextField.vue_vue_type_script_setup_true_lang-DibyExRk.js";import{_ as Ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-CkAHpG8R.js";import{ag as O,ah as z,a1 as ue,ai as X,b as a,bw as Se,ak as te,P as de,Q as Ce,bn as Ie,am as re,X as V,b7 as we,aY as ce,a8 as Te,aw as ie,c7 as Ae,aT as $e,an as Fe,aj as me,au as Re,c8 as je,aZ as Be,$ as Ne,c2 as De,aR as Ue,aX as Le,a7 as x,at as qe,bW as Ge,c5 as Me,d as Oe,U as ze,q as Xe,r as $,ax as Ye,M as Ze,c as h,o as p,f as s,ac as Qe,g as q,x as R,F as G,p as M,C as H,D as y,ad as J,e as f,k as We,E as He,af as Je,al as Ke,ay as ea,Y as aa,Z as ta}from"./index-DGwLTG7y.js";import{c as la}from"./createUrl-D03Fl8cq.js";import{u as na}from"./useAxios-Dvg6aL0V.js";import{b as sa,V as oa}from"./VCard-B9EhiGn2.js";import{V as K}from"./VCardText-Dmphpwd1.js";import{V as ia}from"./VForm-mCchx-qh.js";import{V as j,a as E}from"./VRow-Xte8JFyh.js";import{i as ua,j as da}from"./VOverlay-CNNg-6AI.js";import{V as ra}from"./VTable-53P3SFgd.js";import{_ as ca}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-Kz1vqZB4.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CDxiJw-a.js";import"./VDialog-D2GGbiG7.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-D5-b5KYT.js";import"./VInput-BgQCon_g.js";import"./VImg--0-jo666.js";import"./VTooltip-B15W4Tjj.js";import"./VSelect-EKLp2Do1.js";import"./VTextField-CQRneivX.js";/* empty css                   */import"./VCounter-CFKbFaHM.js";import"./VList-wmt1cssJ.js";import"./ssrBoot-80LRmI8v.js";import"./VAvatar-CMndsomI.js";import"./VDivider-QSx7DlWx.js";import"./VMenu-C9guvoAV.js";import"./VCheckboxBtn-CYB9O97d.js";import"./VSelectionControl-BvU7KPO7.js";import"./VChip-Cb5sgnvF.js";import"./filter-CCq1Pyw-.js";import"./helpers-DwTae8Vr.js";import"./constants-2GBt7OCP.js";import"./index-0F-JFElI.js";/* empty css              */const B=Symbol.for("vuetify:v-expansion-panel"),pe=z({...te(),...da()},"VExpansionPanelText"),ee=O()({name:"VExpansionPanelText",props:pe(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:r}=ua(e,n.isSelected);return X(()=>a(Se,{onAfterLeave:r},{default:()=>{var _;return[de(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&u.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(_=o.default)==null?void 0:_.call(o)])]),[[Ce,n.isSelected.value]])]}})),{}}}),ve=z({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...te()},"VExpansionPanelTitle"),ae=O()({name:"VExpansionPanelTitle",directives:{Ripple:Ie},props:ve(),setup(e,b){let{slots:o}=b;const n=ue(B);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"color"),_=V(()=>({collapseIcon:e.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),m=V(()=>n.isSelected.value?e.collapseIcon:e.expandIcon);return X(()=>{var S;return de(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[r.value,e.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:e.readonly?void 0:n.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(S=o.default)==null?void 0:S.call(o,_.value),!e.hideActions&&a(ce,{defaults:{VIcon:{icon:m.value}}},{default:()=>{var P;return[a("span",{class:"v-expansion-panel-title__icon"},[((P=o.actions)==null?void 0:P.call(o,_.value))??a(Te,null,null)])]}})]),[[we("ripple"),e.ripple]])}),{}}}),fe=z({title:String,text:String,bgColor:String,...Be(),...je(),...Re(),...me(),...ve(),...pe()},"VExpansionPanel"),ma=O()({name:"VExpansionPanel",props:fe(),emits:{"group:selected":e=>!0},setup(e,b){let{slots:o}=b;const n=Ae(e,B),{backgroundColorClasses:u,backgroundColorStyles:r}=re(e,"bgColor"),{elevationClasses:_}=$e(e),{roundedClasses:m}=Fe(e),S=V(()=>(n==null?void 0:n.disabled.value)||e.disabled),P=V(()=>n.group.items.value.reduce((k,v,F)=>(n.group.selected.value.includes(v.id)&&k.push(F),k),[])),l=V(()=>{const k=n.group.items.value.findIndex(v=>v.id===n.id);return!n.isSelected.value&&P.value.some(v=>v-k===1)}),Z=V(()=>{const k=n.group.items.value.findIndex(v=>v.id===n.id);return!n.isSelected.value&&P.value.some(v=>v-k===-1)});return Ne(B,n),X(()=>{const k=!!(o.text||e.text),v=!!(o.title||e.title),F=ae.filterProps(e),N=ee.filterProps(e);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":l.value,"v-expansion-panel--after-active":Z.value,"v-expansion-panel--disabled":S.value},m.value,u.value,e.class],style:[r.value,e.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",..._.value]},null),a(ce,{defaults:{VExpansionPanelTitle:{...F},VExpansionPanelText:{...N}}},{default:()=>{var w;return[v&&a(ae,{key:"title"},{default:()=>[o.title?o.title():e.title]}),k&&a(ee,{key:"text"},{default:()=>[o.text?o.text():e.text]}),(w=o.default)==null?void 0:w.call(o)]}})]})}),{groupItem:n}}}),pa=["default","accordion","inset","popout"],va=z({flat:Boolean,...Me(),...Ge(fe(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...qe(),...te(),...me(),variant:{type:String,default:"default",validator:e=>pa.includes(e)}},"VExpansionPanels"),fa=O()({name:"VExpansionPanels",props:va(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:o}=b;const{next:n,prev:u}=De(e,B),{themeClasses:r}=Ue(e),_=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Le({VExpansionPanel:{bgColor:x(e,"bgColor"),collapseIcon:x(e,"collapseIcon"),color:x(e,"color"),eager:x(e,"eager"),elevation:x(e,"elevation"),expandIcon:x(e,"expandIcon"),focusable:x(e,"focusable"),hideActions:x(e,"hideActions"),readonly:x(e,"readonly"),ripple:x(e,"ripple"),rounded:x(e,"rounded"),static:x(e,"static")}}),X(()=>a(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,_.value,e.class],style:e.style},{default:()=>{var m;return[(m=o.default)==null?void 0:m.call(o,{prev:u,next:n})]}})),{next:n,prev:u}}}),Y=e=>(aa("data-v-3260d25e"),e=e(),ta(),e),_a=Y(()=>f("span",null," Formulario periodo escolar ",-1)),ga={key:0,class:"error--text"},xa={class:"text-center"},ya={class:"text-center"},ba=Y(()=>f("p",{class:"text-center"}," Reporte de materia pendiente. ",-1)),Va=Y(()=>f("th",null,"No.",-1)),Pa=Y(()=>f("th",null,"ALUMNO",-1)),ka={key:0},ha=["colspan"],Ea=Oe({__name:"Form",setup(e){const b=ze(),o=Xe(),{toast:n}=ea(),u=$({}),r=$(!1),_=$(),m=Ye({form:!1}),S=$([]),P=$([]),l=$({id:null,term_id:null,type_education_id:null,grade_id:null,code:null,students:[]}),Z=()=>{l.value={id:null,term_id:null,type_education_id:null,grade_id:null,students:[]}},k=async()=>{var T;l.value.id=o.params.id;const i=l.value.id?`/pendingRegistration/${l.value.id}/edit`:"/pendingRegistration/create";m.form=!0;const{data:t,response:C}=await Je(la(`${i}`,{query:{company_id:b.company.id}}));m.form=!1,(T=C.value)!=null&&T.ok&&t.value&&(t.value.form&&(l.value={id:t.value.form.id||null,term_id:t.value.form.term_id||null,code:t.value.form.code||null,type_education_id:t.value.form.type_education_id||null,grade_id:t.value.form.grade_id||null,students:t.value.form.students||[]}),t.value.terms&&(S.value=t.value.terms),t.value.typeEducations&&(P.value=t.value.typeEducations))},v=()=>{l.value.students.push({student_id:null,subjects:[]})},F=i=>{l.value.students.splice(i,1)},N=async()=>{var t;const i=await((t=_.value)==null?void 0:t.validate());if(i!=null&&i.valid){const C={...l.value,company_id:b.company.id,students:l.value.students.map(U=>({student_id:U.student_id,subjects:U.subjects}))},T=l.value.id?`/pendingRegistration/update/${l.value.id}`:"/pendingRegistration/store";m.form=!0;const{data:A,response:W}=await na(T).post(C);m.form=!1,W.status==200&&A&&A.code===200&&Ke.push({name:"PendingRegistration-List"}),A.code===422&&(u.value=A.errors??{})}else n("Faltan campos por diligenciar","","danger")};o.params.action==="view"&&(r.value=!0),Ze(async()=>{Z(),await k()});const w=V(()=>Object.values(m).some(i=>i)),_e=[i=>!!i||"El código es obligatorio"],le=[i=>!!i||"El periodo es obligatorio"],ge=[i=>!!i||"El grado es obligatorio"],xe=[i=>!!i||"El estudiante es obligatorio"],ye=[i=>i.length>0||"Debe seleccionar al menos una materia"],Q=V(()=>{if(l.value.type_education_id){const i=P.value.find(t=>t.value==l.value.type_education_id);return i?i.grades:[]}return[]}),ne=V(()=>l.value.grade_id?Q.value.find(i=>i.value==l.value.grade_id).subjects:[]),D=V(()=>{const i=l.value.students.flatMap(t=>t.subjects);return[...new Set(i)].map(t=>ne.value.find(C=>C.value===t)).filter(t=>t!==void 0)});return(i,t)=>{const C=Ee,T=he,A=ke,W=Pe,U=Ve;return p(),h("div",null,[a(oa,{disabled:m.form,loading:m.form},{default:s(()=>[a(sa,{class:"d-flex justify-space-between"},{default:s(()=>[_a]),_:1}),a(K,null,{default:s(()=>[a(ia,{ref_key:"formValidation",ref:_,onSubmit:Qe(N,["prevent"]),disabled:r.value},{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:l.value.term_id,"onUpdate:modelValue":t[0]||(t[0]=d=>l.value.term_id=d),items:S.value,label:"Periodo",rules:le,"error-messages":u.value.term_id,onChange:t[1]||(t[1]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(T,{requiredField:"true",modelValue:l.value.code,"onUpdate:modelValue":t[2]||(t[2]=d=>l.value.code=d),rules:_e,label:"Código de sección"},null,8,["modelValue"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:l.value.type_education_id,"onUpdate:modelValue":t[3]||(t[3]=d=>l.value.type_education_id=d),items:P.value,label:"Tipo de educación",rules:le,"error-messages":u.value.term_id,onChange:t[4]||(t[4]=d=>u.value.term_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12",md:"3"},{default:s(()=>[a(C,{requiredField:"true",clearable:"",modelValue:l.value.grade_id,"onUpdate:modelValue":t[5]||(t[5]=d=>l.value.grade_id=d),items:Q.value,label:"Grados y niveles",rules:ge,"error-messages":u.value.grade_id,onChange:t[6]||(t[6]=d=>u.value.grade_id=""),readonly:r.value},null,8,["modelValue","items","error-messages","readonly"])]),_:1}),a(E,{cols:"12"},{default:s(()=>[a(fa,{multiple:""},{default:s(()=>[(p(!0),h(G,null,M(l.value.students,(d,g)=>(p(),q(ma,{key:g},{default:s(()=>[a(ae,null,{actions:s(()=>[r.value?R("",!0):(p(),q(J,{key:0,icon:"tabler-x",color:"error",onClick:I=>F(g)},null,8,["onClick"]))]),default:s(()=>[H(" Estudiante "+y(g+1)+" ",1)]),_:2},1024),a(ee,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12",md:"6"},{default:s(()=>[a(A,{modelValue:d.student_id,"onUpdate:modelValue":I=>d.student_id=I,url:"selectInfiniteStudent",arrayInfo:"student",rules:xe,label:"Estudiante","error-messages":u.value[`students.${g}.student_id`],onInput:I=>u.value[`students.${g}.student_id`]="",readonly:r.value,params:{type_education_id:l.value.type_education_id}},null,8,["modelValue","onUpdate:modelValue","error-messages","onInput","readonly","params"])]),_:2},1024),a(E,{cols:"12",md:"6"},{default:s(()=>[a(W,{modelValue:d.subjects,"onUpdate:modelValue":I=>d.subjects=I,items:ne.value,label:"Materias",multiple:"",chips:"","closable-chips":"",rules:ye,"error-messages":u.value[`students.${g}.subjects`],onInput:I=>u.value[`students.${g}.subjects`]="",readonly:r.value},null,8,["modelValue","onUpdate:modelValue","items","error-messages","onInput","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value?R("",!0):(p(),q(J,{key:0,color:"primary",onClick:v,class:"mt-2"},{default:s(()=>[H(" Agregar Estudiante ")]),_:1}))]),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>[Object.keys(u.value).length>0?(p(),h("div",ga," Por favor, corrige los errores indicados. ")):R("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),a(K,null,{default:s(()=>[a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d;return[f("h2",xa,y(We(b).company.name),1),f("p",ya," Año Escolar: "+y(((d=S.value.find(g=>g.value===l.value.term_id))==null?void 0:d.title)||"N/A")+" | Fecha: "+y(new Date().toLocaleDateString("es-ES")),1),ba]}),_:1})]),_:1}),a(j,null,{default:s(()=>[a(E,{cols:"12"},{default:s(()=>{var d,g,I;return[f("h3",null," Sección: "+y(((d=S.value.find(c=>c.value===l.value.term_id))==null?void 0:d.title)||"N/A")+" - "+y(((g=P.value.find(c=>c.value===l.value.type_education_id))==null?void 0:g.title)||"N/A")+" - "+y(((I=Q.value.find(c=>c.value===l.value.grade_id))==null?void 0:I.title)||"N/A")+" - "+y(l.value.code||"N/A"),1),a(ra,{class:"bordered-table"},{default:s(()=>[f("thead",null,[f("tr",null,[Va,Pa,(p(!0),h(G,null,M(D.value,c=>(p(),h("th",{key:c.value},y(c.abbreviation||c.title),1))),128))])]),f("tbody",null,[(p(!0),h(G,null,M(l.value.students,(c,be)=>{var se,oe;return p(),h("tr",{key:(se=c.student_id)==null?void 0:se.value},[f("td",null,y(be+1),1),f("td",null,y(((oe=c.student_id)==null?void 0:oe.title)||"N/A"),1),(p(!0),h(G,null,M(D.value,L=>(p(),h("td",{key:L.value,class:He({"bg-yellow-lighten-3":c.subjects.includes(L.value),"bg-grey-lighten-3":!c.subjects.includes(L.value)&&D.value.length>0})},y(c.subjects.includes(L.value)?"--":""),3))),128))])}),128)),l.value.students.length?R("",!0):(p(),h("tr",ka,[f("td",{colspan:D.value.length+2,class:"text-center"}," No hay estudiantes seleccionados. ",8,ha)]))])]),_:1})]}),_:1})]),_:1})]),_:1}),a(K,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[a(U,{disabled:w.value,loading:w.value},null,8,["disabled","loading"]),r.value?R("",!0):(p(),q(J,{key:0,disabled:w.value,loading:w.value,onClick:N,color:"primary"},{default:s(()=>[H(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}}),mt=ca(Ea,[["__scopeId","data-v-3260d25e"]]);export{mt as default};
