import{s as w,b as J}from"./helpers-nlAMT8CX.js";import{a as H}from"./formatters-YBNePeY6.js";import{_ as K}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CHrMvmXo.js";import{_ as O}from"./ModalQuestion.vue_vue_type_script_setup_true_lang-BxXeVVMU.js";import{_ as W,a as X}from"./FilterDialogNew-RK7h9j_c.js";import{_ as Y}from"./ModalUnsubscribe.vue_vue_type_script_setup_true_lang-CpPBqGU0.js";import{d as Z,t as ee,V as te,r as s,aU as oe,c as ae,o as p,b as e,f as o,e as r,a8 as T,l as n,a6 as f,D as C,h as _,E as S,y as le,aI as ne,aM as B,aJ as se}from"./index-lrlC7dU6.js";import{u as ie}from"./useAxios-YWxU-3u4.js";import{a as re,V as E}from"./VCard-u4KjVU6S.js";import{V as ce}from"./VTooltip-DtKi32nu.js";import{V as y}from"./VCardText-BWBQCuaJ.js";import{a as D}from"./VList-B08cmeCh.js";import{V as b}from"./VAvatar-Dh--CA_q.js";import{V as M}from"./VImg-CHZL3vTv.js";import{V as ue}from"./VDialog-BH4E8l9N.js";import"./constants-2GBt7OCP.js";import"./VDataTable-D8Hup8Tx.js";import"./VSelect-B_Uw_j_U.js";import"./VTextField-Cn0h9Jbo.js";/* empty css                   */import"./VCounter-B4tjcVkd.js";import"./VInput-DI6tl7Gf.js";import"./VOverlay-onlbvDoS.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-B5aYFXc4.js";import"./VMenu-B5PHd5e4.js";import"./VCheckboxBtn-C7iXD_AJ.js";import"./VSelectionControl-CjT_Q8-s.js";import"./VChip-Bx98Ga3Z.js";import"./VTable-JWqno1cB.js";import"./filter-CgxZeQB3.js";import"./VDivider-Dcm9G-1v.js";import"./VSkeletonLoader-mO3d7K4A.js";import"./VRow-Y-px9dy8.js";/* empty css              */import"./AppDateTimePicker.vue_vue_type_style_index_0_lang-BcuMg_op.js";import"./AppSelectRemote--oVX-ZGK.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-CJwmaM6Y.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-Ck9sddvT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VToolbar-ChDo8ITW.js";import"./validators-DKbmw92y.js";import"./VAlert-BBdU4i0J.js";import"./VForm-C1UsIQOl.js";import"./VContainer-DHd5emsA.js";import"./ssrBoot-4AFRnSrN.js";const pe=r("span",null," Estudiantes ",-1),de={class:"d-flex justify-end gap-3 flex-wrap"},me={class:"my-3"},fe=r("span",null,"Resetear contraseña",-1),_e=r("span",null,"Dar de baja",-1),ct=Z({__name:"List",setup(ye){const F=ee(),v=te(),d=s(),I={url:"/student/list",paramsGlobal:{company_id:v.company.id},headers:[{title:"Acciones",key:"actions",sortable:!1},{title:"Foto ",key:"photo",sortable:!1},{title:"Grado ",key:"grade_name"},{title:"Sección ",key:"section_name"},{title:"Tipo de documento ",key:"type_document_name"},{title:"Documento ",key:"identity_document"},{title:"Nombre",key:"full_name"},{title:"Tipo de educación",key:"type_education_name"}],actions:{changeStatus:{show:!1},view:{show:!1},delete:{url:"/student/delete"}}},$=s({dialog:{cols:4,width:800,inputs:[{type:"selectApi",label:"Tipo de educación",name:"type_education_id",url:"selectInifiniteTypeEducation",arrayInfo:"typeEducation",multiple:!0},{type:"selectApi",label:"Sección",name:"section_id",url:"selectInfiniteSection",arrayInfo:"section",multiple:!0},{type:"selectApi",label:"Tipo de documento",name:"type_document_id",url:"selectInfiniteTypedocument",arrayInfo:"typeDocument",multiple:!0},{type:"select",name:"photo",label:"Foto",value:null,options:[{value:1,title:"Con foto"},{value:0,title:"Sin foto"}]}]},filterLabels:{inputGeneral:"Buscar en todo",is_active:"Estado"}}),i=oe({table:!1,btnPdf:!1,excel:!1}),A=async t=>{i.table=!0;const{data:l,response:x}=await se("/student-resetPassword/"+t).get();i.table=!1},m=s(),N=t=>{m.value.openModal(t),m.value.componentData.title="¿Seguro desea reiniciar la contraseña al registro?"},c=s(!1),u=s(null),z=(t=null)=>{c.value=!0,u.value=t},P=()=>{u.value=null,c.value=!1},g=s(),U=t=>{g.value.openModal(t)},L=t=>{B.push({name:"Student-Form",params:{action:"edit",id:t.id}})},Q=()=>{B.push({name:"Student-Form",params:{action:"create"}})},k=s(!1),V=()=>{d.value&&d.value.fetchTableData(null,!1,!0)},j=async()=>{i.excel=!0;const{data:t,response:l}=await ie("/students/excelExport").get({params:{...F.query,company_id:v.company.id}});i.excel=!1,l.status==200&&t&&J(t.excel,"Lista de estudiantes")};return(t,l)=>{const x=W,G=X,R=O,q=K;return p(),ae("div",null,[e(E,null,{default:o(()=>[e(re,{class:"d-flex justify-space-between"},{default:o(()=>[pe,r("div",de,[e(T,{loading:n(i).excel,disabled:n(i).excel,size:"38",color:"primary",icon:"",onClick:l[0]||(l[0]=a=>j())},{default:o(()=>[e(f,{icon:"tabler-file-spreadsheet"}),e(ce,{location:"top",transition:"scale-transition",activator:"parent",text:"Descargar Excel"})]),_:1},8,["loading","disabled"]),e(T,{onClick:l[1]||(l[1]=a=>Q())},{default:o(()=>[C(" Agregar estudiante ")]),_:1})])]),_:1}),e(y,null,{default:o(()=>[e(x,{"options-filter":n($),onForceSearch:V,"table-loading":n(k)},null,8,["options-filter","table-loading"])]),_:1}),e(y,{class:"mt-2"},{default:o(()=>[e(G,{ref_key:"refTableFull",ref:d,options:I,onEdit:L,"onUpdate:loading":l[2]||(l[2]=a=>k.value=a)},{"item.photo":o(({item:a})=>[r("div",me,[a.photo?(p(),_(b,{key:0,rounded:"",size:"120",color:"primary",variant:"tonal",class:"user-profile-avatar mx-auto",style:{cursor:"pointer"},onClick:h=>z(a)},{default:o(()=>[e(M,{src:("storageBack"in t?t.storageBack:n(w))(a.photo)},null,8,["src"])]),_:2},1032,["onClick"])):(p(),_(b,{key:1,color:"primary",variant:"tonal",size:"50"},{default:o(()=>[C(S(("avatarText"in t?t.avatarText:n(H))(a.full_name)),1)]),_:2},1024))])]),"item.actions2":o(({item:a})=>[e(D,{onClick:h=>N(a.id)},{prepend:o(()=>[e(f,{size:"22",icon:"tabler-lock-open"})]),default:o(()=>[fe]),_:2},1032,["onClick"]),e(D,{onClick:h=>U(a.id)},{prepend:o(()=>[e(f,{size:"22",icon:"tabler-user-down"})]),default:o(()=>[_e]),_:2},1032,["onClick"])]),_:1},512)]),_:1})]),_:1}),e(R,{ref_key:"refModalQuestion",ref:m,onSuccess:A},null,512),e(ue,{modelValue:n(c),"onUpdate:modelValue":l[4]||(l[4]=a=>ne(c)?c.value=a:null),"max-width":"40rem"},{default:o(()=>[e(q,{onClick:l[3]||(l[3]=a=>P())}),n(u)?(p(),_(E,{key:0},{default:o(()=>[e(y,{class:"text-center"},{default:o(()=>[r("h3",null,S(n(u).full_name),1),e(b,{rounded:"",size:"520",color:"primary",variant:"tonal",class:"user-profile-avatar mx-auto"},{default:o(()=>[e(M,{src:("storageBack"in t?t.storageBack:n(w))(n(u).photo)},null,8,["src"])]),_:1})]),_:1})]),_:1})):le("",!0)]),_:1},8,["modelValue"]),e(Y,{ref_key:"refModalUnsubscribe",ref:g,onExecute:V},null,512)])}}});export{ct as default};
