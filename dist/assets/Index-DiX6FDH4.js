import{s as te,o as oe}from"./helpers-DpoOu2Gd.js";import{d as re,r as c,X as ie,c as S,o as _,b as e,f as a,a8 as h,e as y,az as O,x as I,k as ne,D as F,C as v,F as ue,p as se,E as de,g as $,ad as A,ac as U,Y as ce,Z as me}from"./index-v62QzUgb.js";import{_ as fe}from"./AppSelect.vue_vue_type_script_setup_true_lang-s_uNeCP7.js";import{_ as pe}from"./AppTextField.vue_vue_type_script_setup_true_lang-DRTqQ6nI.js";import{_ as ve}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-Ds0pD_mZ.js";import{_ as be}from"./AppSelectRemote-CeDWjzcS.js";import{u as Q}from"./useAxios-Dv_cXzGe.js";import{b as X,V as B}from"./VCard-EX7YkvuV.js";import{V as z}from"./VCardText-BzwaDpth.js";import{V as b,a as n}from"./VRow-DCZrpGKb.js";import{V as Ve}from"./VAvatar-BbJ_odT7.js";import{V as _e}from"./VImg-urEA1vUl.js";import{V as Z}from"./VDivider-Bp9v2kOl.js";import{V as L}from"./VForm-Bug1t0fD.js";import{V as M}from"./VInput-vaB9dEM4.js";import{V as ye}from"./VSpacer-DUQSdPma.js";import{V as ge}from"./VDialog-dfjmgiZz.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./constants-2GBt7OCP.js";import"./VTooltip-BI0famzk.js";import"./VOverlay-CNAFiuqO.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-BA34Ef73.js";import"./VTextField-CUXRldaw.js";/* empty css                   */import"./VCounter-CFO2jdF3.js";import"./VList-D3EVGFbt.js";import"./ssrBoot-D9UInlug.js";import"./dialog-transition-CE-yxmch.js";import"./VMenu-C8h0fx02.js";import"./VCheckboxBtn-MQw1sH32.js";import"./VSelectionControl-Dq43D-f5.js";import"./VChip-D1O8EWip.js";/* empty css              */const H=N=>(ce("data-v-5a699fe1"),N=N(),me(),N),qe=H(()=>y("span",{class:"text-white text-h5"},"Generador de Constancias",-1)),he={class:"search-section mb-6"},Fe={key:0,class:"student-info mb-6"},ke={class:"text-h5 mb-2"},xe={class:"text-body-1 mb-1"},Ie={key:0,class:"certificates-section"},we=H(()=>y("h3",{class:"text-h6 mb-4"},"Seleccione el tipo de constancia",-1)),De={class:"d-flex align-center mb-3"},Ee={class:"text-h6"},Te={class:"text-body-2 text-grey-darken-1"},$e={class:"text-h6 font-weight-bold"},Ne=re({__name:"Index",setup(N){const E=c(""),u=c(null),k=c(!1),r=c(null),g=c(!0),T=c(null),x=c(!1),m=c({name:"",documentType:"V",documentNumber:""}),f=c({name:"",documentType:"V",documentNumber:""}),p=c({startDate:"",endDate:""}),s=c({registrationFee:68,monthlyFee:68,educationalCouncilFee:25,totalAmount:0}),R=ie(()=>s.value.registrationFee+s.value.monthlyFee+s.value.educationalCouncilFee),V=async(o,l,j)=>{try{const{data:C,response:d}=await Q(o).get({params:{additionalInfo:j}});if(d.status===200&&(C!=null&&C.pdf))oe(C.pdf);else throw new Error("Invalid response format")}catch(C){console.error(`Error downloading certificate from ${o}:`,C)}},K=[{id:1,title:"Constancia de Estudios",icon:"tabler-school",description:"Certifica que el estudiante está inscrito y cursando estudios.",handler:o=>V(`/documents/certificate/${o}`)},{id:2,title:"Constancia de Culminación",icon:"tabler-user-check",description:"Documenta la finalización exitosa de un período académico.",handler:o=>V(`/documents/certificate-completion/${o}`)},{id:3,title:"Constancia de no poseer beca",icon:"tabler-notebook",description:"Confirma que el estudiante no recibe becas institucionales.",handler:o=>V(`/documents/proof-no-scholarship/${o}`)},{id:4,title:"Constancia de Aprobación",icon:"tabler-coin",description:"Certifica la aprobación de materias o cursos específicos.",handler:o=>V(`/documents/certificate-approval/${o}`)},{id:5,title:"Constancia de Buena Conducta",icon:"tabler-shield-check",description:"Atestigua el buen comportamiento del estudiante.",handler:o=>V(`/documents/certificate-good-conduct/${o}`)},{id:6,title:"Constancia de Inscripción",icon:"tabler-calendar-check",description:"Verifica la inscripción del estudiante en la institución.",handler:o=>V(`/documents/certificate-enrollment/${o}`)},{id:7,title:"Constancia de Transportista",icon:"tabler-bus",description:"Certifica al transportista autorizado del estudiante.",requiresAdditionalInfo:!0,handler:(o,l)=>V(`/documents/certificate-transporter/${o}`,o,l)},{id:8,title:"Constancia de Inscripción por monto",icon:"tabler-receipt",description:"Detalla los montos pagados por inscripción y mensualidades.",requiresAdditionalInfo:!0,handler:(o,l)=>V(`/documents/certificate-enrollment-amount/${o}`,o,l)},{id:9,title:"Constancia de Retiro",icon:"tabler-logout",description:"Documenta el retiro del estudiante de la institución.",requiresAdditionalInfo:!0,handler:(o,l)=>V(`/documents/certificate-withdrawal/${o}`,o,l)}],W=async()=>{const o=T.value;if(!o)return!1;const{valid:l}=await o.validate();return l},ee=async()=>{if(E.value){k.value=!0;try{const{response:o,data:l}=await Q(`/documents/${E.value}/show`).get();o.status===200&&(l!=null&&l.student)&&(u.value=l.student)}catch(o){console.error("Error al buscar estudiante:",o)}finally{k.value=!1}}},le=o=>{r.value=o,m.value={name:"",documentType:"V",documentNumber:""},f.value={name:"",documentType:"V",documentNumber:""},p.value={startDate:"",endDate:""},s.value={registrationFee:0,monthlyFee:0,educationalCouncilFee:0,totalAmount:0},o.requiresAdditionalInfo&&(x.value=!0)},w=async(o=!0)=>{if(!(!u.value||!r.value)&&!(o&&!await W())){console.log("aaaaaaaaaaa"),k.value=!0;try{let l=null;if(r.value.id===7){if(!m.value.name||!m.value.documentNumber)return;l=m.value}else if(r.value.id===8)s.value.totalAmount=R.value,l=s.value;else if(r.value.id===9){if(!f.value.name||!f.value.documentNumber)return;l=f.value}else if(r.value.id===10){if(!p.value.startDate||!p.value.endDate)return;l=p.value}await r.value.handler(u.value.id,l),x.value=!1}catch(l){console.error("Error al generar certificado:",l)}finally{k.value=!1}}},G=()=>{u.value=null,r.value=null,E.value="",x.value=!1},P=[{value:"V",title:"V"},{value:"E",title:"E"},{value:"J",title:"J"},{value:"P",title:"P"}],ae=(o=!1)=>{x.value=o};return(o,l)=>{const j=be,C=ve,d=pe,J=fe;return _(),S("div",null,[e(B,{class:"elevation-3",loading:k.value},{default:a(()=>[e(X,{class:"d-flex align-center pa-4 bg-primary"},{default:a(()=>[e(h,{icon:"tabler-certificate",class:"me-2",color:"white"}),qe]),_:1}),e(z,{class:"pa-6"},{default:a(()=>[y("div",he,[e(b,null,{default:a(()=>[e(n,{cols:"12",md:"8",class:"mx-auto"},{default:a(()=>[e(j,{"return-object":!1,modelValue:E.value,"onUpdate:modelValue":[l[0]||(l[0]=i=>E.value=i),ee],url:"selectInfiniteStudent",arrayInfo:"student",label:"Estudiante","onClick:clear":G},null,8,["modelValue"])]),_:1})]),_:1})]),e(O,null,{default:a(()=>[u.value?(_(),S("div",Fe,[e(B,{class:"pa-4 bg-grey-lighten-4"},{default:a(()=>[e(b,{align:"center"},{default:a(()=>[e(n,{cols:"12",sm:"3"},{default:a(()=>[e(Ve,{size:"100",class:"elevation-2"},{default:a(()=>[e(_e,{src:("storageBack"in o?o.storageBack:ne(te))(u.value.photo),cover:""},null,8,["src"])]),_:1})]),_:1}),e(n,{cols:"12",sm:"9"},{default:a(()=>[y("h3",ke,F(u.value.full_name),1),y("p",xe,[e(h,{icon:"tabler-school",class:"me-2"}),v(" "+F(u.value.type_education_name)+", "+F(u.value.grade_name)+" "+F(u.value.section_name),1)])]),_:1})]),_:1})]),_:1})])):I("",!0)]),_:1}),e(O,null,{default:a(()=>[u.value?(_(),S("div",Ie,[we,e(b,null,{default:a(()=>[(_(),S(ue,null,se(K,i=>e(n,{key:i.id,cols:"12",sm:"6",md:"4"},{default:a(()=>{var q;return[e(B,{class:de(["certificate-card pa-4 cursor-pointer",{selected:((q=r.value)==null?void 0:q.id)===i.id}]),onClick:D=>le(i),elevation:"2",hover:""},{default:a(()=>{var D;return[y("div",De,[e(h,{icon:i.icon,size:"32",class:"me-3",color:((D=r.value)==null?void 0:D.id)===i.id?"primary":"grey"},null,8,["icon","color"]),y("h4",Ee,F(i.title),1)]),y("p",Te,F(i.description),1)]}),_:2},1032,["class","onClick"])]}),_:2},1024)),64))]),_:1})])):I("",!0)]),_:1})]),_:1}),e(Z),e(z,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:a(()=>[e(A,{color:"error",variant:"outlined",onClick:G,disabled:!u.value},{default:a(()=>[e(h,{icon:"tabler-x",class:"me-2"}),v(" Cancelar ")]),_:1},8,["disabled"]),r.value&&!r.value.requiresAdditionalInfo?(_(),$(A,{key:0,color:"primary",onClick:l[1]||(l[1]=i=>w(!1)),disabled:!u.value||!r.value,loading:k.value},{default:a(()=>[e(h,{icon:"tabler-printer",class:"me-2"}),v(" Generar Constancia ")]),_:1},8,["disabled","loading"])):I("",!0)]),_:1})]),_:1},8,["loading"]),e(ge,{modelValue:x.value,"onUpdate:modelValue":l[19]||(l[19]=i=>x.value=i),width:"600",persistent:""},{default:a(()=>[e(C,{onClick:l[2]||(l[2]=i=>ae())}),e(B,null,{default:a(()=>[e(X,{class:"bg-primary text-white pa-4"},{default:a(()=>{var i,q;return[e(h,{icon:(i=r.value)==null?void 0:i.icon,class:"me-2",color:"white"},null,8,["icon"]),v(" "+F((q=r.value)==null?void 0:q.title),1)]}),_:1}),e(z,{class:"pa-6"},{default:a(()=>{var i,q,D,Y;return[((i=r.value)==null?void 0:i.id)===7?(_(),$(L,{key:0,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[6]||(l[6]=t=>g.value=t),ref_key:"form",ref:T},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(d,{clearable:"",modelValue:m.value.name,"onUpdate:modelValue":l[3]||(l[3]=t=>m.value.name=t),label:"Nombre del Transportista",rules:[t=>!!t||"El nombre es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(J,{modelValue:m.value.documentType,"onUpdate:modelValue":l[4]||(l[4]=t=>m.value.documentType=t),items:P,label:"Tipo de Documento",required:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"8"},{default:a(()=>[e(d,{clearable:"",modelValue:m.value.documentNumber,"onUpdate:modelValue":l[5]||(l[5]=t=>m.value.documentNumber=t),label:"Número de Documento",rules:[t=>!!t||"El número de documento es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((q=r.value)==null?void 0:q.id)===8?(_(),$(L,{key:1,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[10]||(l[10]=t=>g.value=t),ref_key:"form",ref:T},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(M,null,{default:a(()=>[v("Inscripción:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",modelValue:s.value.registrationFee,"onUpdate:modelValue":l[7]||(l[7]=t=>s.value.registrationFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(M,null,{default:a(()=>[v("Mensualidad Septiembre:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",modelValue:s.value.monthlyFee,"onUpdate:modelValue":l[8]||(l[8]=t=>s.value.monthlyFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(M,null,{default:a(()=>[v("Consejo Educativo:")]),_:1})]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",modelValue:s.value.educationalCouncilFee,"onUpdate:modelValue":l[9]||(l[9]=t=>s.value.educationalCouncilFee=t),modelModifiers:{number:!0},prefix:"$",type:"number",rules:[t=>!!t||"Este campo es requerido",t=>t>=0||"El valor debe ser positivo"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(b,{class:"mt-4"},{default:a(()=>[e(n,{cols:"8"},{default:a(()=>[e(M,{class:"font-weight-bold"},{default:a(()=>[v("TOTAL:")]),_:1})]),_:1}),e(n,{cols:"4"},{default:a(()=>[y("div",$e,"$ "+F(R.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((D=r.value)==null?void 0:D.id)===9?(_(),$(L,{key:2,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[14]||(l[14]=t=>g.value=t),ref_key:"form",ref:T},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(d,{clearable:"",modelValue:f.value.name,"onUpdate:modelValue":l[11]||(l[11]=t=>f.value.name=t),label:"Nombre del Representante",rules:[t=>!!t||"El nombre es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(J,{requiredField:!0,clearable:"",modelValue:f.value.documentType,"onUpdate:modelValue":l[12]||(l[12]=t=>f.value.documentType=t),items:P,label:"Tipo de Documento",required:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"8"},{default:a(()=>[e(d,{clearable:"",modelValue:f.value.documentNumber,"onUpdate:modelValue":l[13]||(l[13]=t=>f.value.documentNumber=t),label:"Número de Documento",rules:[t=>!!t||"El número de documento es requerido"],required:"",requiredField:!0},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0),((Y=r.value)==null?void 0:Y.id)===10?(_(),$(L,{key:3,onSubmit:U(w,["prevent"]),modelValue:g.value,"onUpdate:modelValue":l[17]||(l[17]=t=>g.value=t),ref_key:"form",ref:T},{default:a(()=>[e(b,null,{default:a(()=>[e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",type:"date",modelValue:p.value.startDate,"onUpdate:modelValue":l[15]||(l[15]=t=>p.value.startDate=t),label:"Fecha de Inicio",rules:[t=>!!t||"La fecha de inicio es requerida"],required:""},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:a(()=>[e(d,{requiredField:!0,clearable:"",type:"date",modelValue:p.value.endDate,"onUpdate:modelValue":l[16]||(l[16]=t=>p.value.endDate=t),label:"Fecha de Fin",rules:[t=>!!t||"La fecha de fin es requerida",t=>!p.value.startDate||t>=p.value.startDate||"La fecha de fin debe ser posterior a la fecha de inicio"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0)]}),_:1}),e(Z),e(z,{class:"d-flex align-center justify-center gap-4"},{default:a(()=>[e(ye),e(A,{color:"error",variant:"outlined",onClick:l[18]||(l[18]=i=>x.value=!1)},{default:a(()=>[e(h,{icon:"tabler-x",class:"me-2"}),v(" Cancelar ")]),_:1}),e(A,{color:"primary",onClick:w,loading:k.value,disabled:!u.value||!r.value},{default:a(()=>[e(h,{icon:"tabler-printer",class:"me-2"}),v(" Generar Constancia ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),pl=Ce(Ne,[["__scopeId","data-v-5a699fe1"]]);export{pl as default};
