import{r as b}from"./validators-CCH37e5z.js";import{s as oe}from"./helpers-DtRiZpzE.js";import{d as Z,r as c,M as h,w as ee,g as P,o as B,bY as re,f as r,p as se,k as e,e as j,b as i,c as E,x as M,cn as ne,ad as Q,a8 as X,z as ue,H as de,n as me,j as ce,U as fe,q as pe,ax as ve,X as Y,ac as ye,C as x,af as T,al as Ve,ay as ge}from"./index-Dl5ek0NS.js";import{_ as _e}from"./BtnBack.vue_vue_type_script_setup_true_lang-CTklSnVX.js";import{_ as be}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-B2lxk2eb.js";import{_ as ke}from"./AppTextField.vue_vue_type_script_setup_true_lang-CsCt6hsx.js";import{_ as qe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-DCFDDQmI.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-B7VAs8De.js";import{V as Fe}from"./VTextField-DH2VakAb.js";import{V as K}from"./VDivider-Cm2uZgFT.js";import{V as z,a as p}from"./VRow-D1RC1T7e.js";import{u as Ie,V as we}from"./VFileInput-CTxVeuEq.js";import{b as $e,V as Ce}from"./VCard-rY6Noe6k.js";import{V as W}from"./VCardText--nLa4AsB.js";import{V as Se}from"./VForm-Cajyw0G7.js";import{V as Ue}from"./VImg-BPxl9zya.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-BEoXigGb.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-CkCvpngV.js";import"./VDialog-B_yTWE9k.js";import"./VOverlay-CcbbDn4H.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-DX65Ay37.js";import"./VInput-CmsT0ynG.js";import"./VTooltip-CuN9trdF.js";import"./VSelect-CdHuoamg.js";import"./VList-DX-PfAWU.js";import"./ssrBoot-CRCz_0bP.js";import"./VAvatar-sof9KUP9.js";import"./VMenu-CCAMsYCM.js";import"./VCheckboxBtn-C2s4z4Fa.js";import"./VSelectionControl-ClIc-v4k.js";import"./VChip-CCQ5Itm2.js";import"./filter-BzQG20E3.js";/* empty css                   */import"./VCounter-BZS11_e3.js";/* empty css              */import"./sweetalert2.esm.all-B0Dix5B2.js";const Be={key:0,class:"text-center"},Ne={key:1,class:"d-flex justify-content-between aling-items-center p-2"},Te=Z({__name:"SelectInfinite",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},select:{type:Object,default:()=>({})},multiple:{type:Boolean,default:()=>!1}},emits:["clearVmodel"],setup(v,{emit:I}){const{items:U,loading:n,select:y}=v,g=I,d=c(!1);h(()=>{y.totalLinks.value>1&&(d.value=!0)});const s=()=>{g("clearVmodel",!0),y.next()},_=()=>{g("clearVmodel",!0),y.prev()};return ee(y.dataNueva,()=>{d.value==!1&&y.totalLinks.value>1&&(d.value=!0)}),(w,t)=>{const $=ae;return B(),P($,ue(w.$attrs,{items:v.select.dataNueva.value,multiple:v.multiple}),re({_:2},[e(d)?{name:"prepend-item",fn:r(()=>[j("div",null,[i(Fe,{clearable:"",placeholder:"Buscar...	",class:"mb-2",modelValue:v.select.searchQueryInfinite.value,"onUpdate:modelValue":t[0]||(t[0]=k=>v.select.searchQueryInfinite.value=k)},null,8,["modelValue"]),i(K)])]),key:"0"}:void 0,e(d)?{name:"append-item",fn:r(()=>[j("div",null,[i(K),v.loading?(B(),E("div",Be,[i(ne,{size:"24",color:"primary",indeterminate:""})])):M("",!0),v.loading?M("",!0):(B(),E("div",Ne,[i(z,null,{default:r(()=>[i(p,{sm:"6",class:"text-left"},{default:r(()=>[i(Q,{class:"mt-2 ml-5",disabled:v.select.page.value<=1,onClick:t[1]||(t[1]=k=>_()),color:"primary",icon:""},{default:r(()=>[i(X,{icon:"tabler-chevron-left"})]),_:1},8,["disabled"])]),_:1}),i(p,{sm:"6",class:"text-right"},{default:r(()=>[i(Q,{class:"mt-2 mr-5",disabled:v.select.page.value>=v.select.totalLinks.value,onClick:t[2]||(t[2]=k=>s()),color:"primary",icon:""},{default:r(()=>[i(X,{icon:"tabler-chevron-right"})]),_:1},8,["disabled"])]),_:1})]),_:1})]))])]),key:"1"}:void 0,se(w.$slots,(k,q)=>({name:q,fn:r(V=>[de(w.$slots,q,me(ce(V||{})))])}))]),1040,["items","multiple"])}}});function je(v,I=[],U=0,n={}){const y=c(""),g=c([]),d=c(1),s=c(1),_=c({}),w=async()=>{d.value--,d.value<=1&&(d.value=1),await $()},t=async()=>{d.value++,d.value>s.value&&(d.value=s.value),await $()},$=async()=>{let q={page:d.value,searchQueryInfinite:y.value};for(const V in n)q[V]=n[V];for(const V in _.value)q[V]=_[V];await v(q),g.value=[],g.value.push(...I.value)};let k=null;return ee(y,async(q,V)=>{k&&clearTimeout(k),d.value=1;let F={page:d.value,searchQueryInfinite:q};for(const C in n)F[C]=n[C];for(const C in _.value)F[C]=_[C];k=setTimeout(async()=>{await v(F),g.value=[],I&&I.value!==void 0&&g.value.push(...I.value),U&&U.value!==void 0&&(s.value=U.value)},300)}),{searchQueryInfinite:y,dataNueva:g,page:d,filterInterno:_,next:t,prev:w,search:$,totalLinks:s}}const Ae=j("span",null," Formulario estudiante ",-1),Le=j("b",{class:"text-warning"},"*",-1),Pe={style:{"block-size":"200px","inline-size":"200px"}},qa=Z({__name:"Form",setup(v){const I=fe(),{toast:U}=ge(),n=c({}),y=c(!1),g=pe(),d=c(),s=ve({form:!1,countries:!1,states:!1,cities:!1}),_=c([]),w=c([]),t=c({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null}),$=()=>{for(const l in t.value)t.value[l]=null},k=async()=>{var f;t.value.id=g.params.id||null;const l=t.value.id?`/student/${t.value.id}/edit`:"/student/create";s.form=!0;const{response:a,data:u}=await T(l).get();if(s.form=!1,(f=a.value)!=null&&f.ok&&u.value&&(L.dataNueva.value=u.value.countries_arrayInfo,L.totalLinks.value=u.value.countries_countLinks,_.value=u.value.typeEducations,w.value=u.value.sections,u.value.form)){t.value=u.value.form;const m=JSON.parse(JSON.stringify(u.value.form));u.value.form.id&&m.country_id&&m.state_id&&(await J(m.country_id),await H(m.state_id),t.value.country_id=m.country_id,t.value.state_id=m.state_id,t.value.city_id=m.city_id)}},q=async()=>{var a,u;const l=await((a=d.value)==null?void 0:a.validate());if(l!=null&&l.valid){t.value.company_id=I.company.id;const f=t.value.id?`/student/update/${t.value.id}`:"/student/store",m=new FormData;for(const N in t.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(N)||m.append(N,t.value[N]);m.append("country_id",t.value.country_id.value),m.append("state_id",t.value.state_id),m.append("city_id",t.value.city_id),m.append("gender",t.value.gender),m.append("birthday",t.value.birthday),s.form=!0;const{data:S,response:A}=await T(f).post(m);s.form=!1,(u=A.value)!=null&&u.ok&&S.value&&S.value.code==200&&Ve.push({name:"Student-List"}),S.value.code===422&&(n.value=S.value.errors??{})}else U("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(y.value=!0),h(async()=>{$(),await k()});const V=Y(()=>Object.values(s).some(l=>l)),F=c(Ie()),C=["jpg","jpeg","png"];F.value.allowedExtensions=C;const te=l=>{s.form=!0,F.value.handleImageSelected(l),setTimeout(()=>{t.value.photo=F.value.imageFile,s.form=!1},1e3)},le=Y(()=>t.value.type_education_id?_.value.find(l=>l.value==t.value.type_education_id).grades:[]),O=c([]),R=c([]),D=c([]),G=c(1),L=je(async l=>{var f;s.countries=!0;const{data:a,response:u}=await T("/selectInfiniteCountries").post(l);s.countries=!1,(f=u.value)!=null&&f.ok&&a.value&&(D.value=a.value.countries_arrayInfo,G.value=a.value.countries_countLinks)},D,G,{}),J=async l=>{var f;t.value.state_id=null,t.value.city_id=null,s.states=!0;const{data:a,response:u}=await T(`/selectStates/${l.value}`).get();s.states=!1,(f=u.value)!=null&&f.ok&&a.value&&(O.value=a.value.states)},H=async l=>{var f;t.value.city_id=null,s.cities=!0;const{data:a,response:u}=await T(`/selectCities/${l}`).get();s.cities=!1,(f=u.value)!=null&&f.ok&&a.value&&(R.value=a.value.cities)},ie=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(l,a)=>{const u=ae,f=Te,m=qe,S=ke,A=be,N=_e;return B(),E("div",null,[i(Ce,{disabled:e(s).form,loading:e(s).form},{default:r(()=>[i($e,{class:"d-flex justify-space-between"},{default:r(()=>[Ae]),_:1}),i(W,null,{default:r(()=>[i(Se,{ref_key:"formValidation",ref:d,onSubmit:ye(()=>{},["prevent"]),disabled:e(y)},{default:r(()=>[i(z,null,{default:r(()=>[i(p,{cols:"12",sm:"4"},{default:r(()=>[i(u,{items:e(_),clearable:"",rules:["requiredValidator"in l?l.requiredValidator:e(b)],modelValue:e(t).type_education_id,"onUpdate:modelValue":a[0]||(a[0]=o=>e(t).type_education_id=o),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),i(p,{cols:"12",sm:"4"},{default:r(()=>[i(u,{clearable:"",items:e(le),rules:["requiredValidator"in l?l.requiredValidator:e(b)],modelValue:e(t).grade_id,"onUpdate:modelValue":a[1]||(a[1]=o=>e(t).grade_id=o),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),i(p,{cols:"12",sm:"4"},{default:r(()=>[i(u,{clearable:"",items:e(w),rules:["requiredValidator"in l?l.requiredValidator:e(b)],modelValue:e(t).section_id,"onUpdate:modelValue":a[2]||(a[2]=o=>e(t).section_id=o),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),i(p,{cols:"12",md:"4"},{default:r(()=>[i(f,{requiredField:!0,label:"País",returnObject:"",modelValue:e(t).country_id,"onUpdate:modelValue":[a[3]||(a[3]=o=>e(t).country_id=o),a[4]||(a[4]=o=>J(o))],select:e(L),"error-messages":e(n).country_id,onInput:a[5]||(a[5]=o=>e(n).country_id=""),clearable:"",loading:e(s).countries,rules:["requiredValidator"in l?l.requiredValidator:e(b)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),i(p,{cols:"12",md:"4"},{default:r(()=>[i(m,{loading:e(s).states,requiredField:!0,clearable:"",items:e(O),modelValue:e(t).state_id,"onUpdate:modelValue":[a[6]||(a[6]=o=>e(t).state_id=o),a[7]||(a[7]=o=>H(o))],label:"Estado","error-messages":e(n).state_id,onInput:a[8]||(a[8]=o=>e(n).state_id=""),rules:["requiredValidator"in l?l.requiredValidator:e(b)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),i(p,{cols:"12",md:"4"},{default:r(()=>[i(m,{loading:e(s).cities,requiredField:!0,clearable:"",items:e(R),modelValue:e(t).city_id,"onUpdate:modelValue":a[9]||(a[9]=o=>e(t).city_id=o),label:"Municipio","error-messages":e(n).city_id,onInput:a[10]||(a[10]=o=>e(n).city_id=""),rules:["requiredValidator"in l?l.requiredValidator:e(b)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),i(p,{cols:"12",sm:"3"},{default:r(()=>[i(S,{clearable:"",modelValue:e(t).identity_document,"onUpdate:modelValue":a[11]||(a[11]=o=>e(t).identity_document=o),rules:["requiredValidator"in l?l.requiredValidator:e(b)],"error-messages":e(n).identity_document,label:"Cédula de identidad",onInput:a[12]||(a[12]=o=>e(n).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),i(p,{cols:"12",sm:"9"},{default:r(()=>[i(S,{clearable:"",modelValue:e(t).full_name,"onUpdate:modelValue":a[13]||(a[13]=o=>e(t).full_name=o),rules:["requiredValidator"in l?l.requiredValidator:e(b)],"error-messages":e(n).full_name,label:"Nombre completo",onInput:a[14]||(a[14]=o=>e(n).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),i(p,{cols:"12",sm:"4"},{default:r(()=>[i(u,{clearable:"",modelValue:e(t).gender,"onUpdate:modelValue":a[15]||(a[15]=o=>e(t).gender=o),items:ie,rules:["requiredValidator"in l?l.requiredValidator:e(b)],"error-messages":e(n).gender,label:"Sexo",onInput:a[16]||(a[16]=o=>e(n).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),i(p,{cols:"12",sm:"4"},{default:r(()=>[i(A,{clearable:"",modelValue:e(t).birthday,"onUpdate:modelValue":a[17]||(a[17]=o=>e(t).birthday=o),label:"Fecha de nacimiento",rules:["requiredValidator"in l?l.requiredValidator:e(b)],requiredField:!0,"error-messages":e(n).birthday,onInput:a[18]||(a[18]=o=>e(n).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),i(p,{cols:"12",sm:"4"},{default:r(()=>[i(A,{clearable:"",modelValue:e(t).real_entry_date,"onUpdate:modelValue":a[19]||(a[19]=o=>e(t).real_entry_date=o),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in l?l.requiredValidator:e(b)],requiredField:!0,"error-messages":e(n).real_entry_date,onInput:a[20]||(a[20]=o=>e(n).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),i(p,{cols:"12",sm:"4"},{default:r(()=>[(B(),P(we,{accept:"image/*",key:e(F).key,onChange:a[21]||(a[21]=o=>te(o)),"onClick:clear":e(F).clearData},{label:r(()=>[x(" Foto "),Le]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),i(z,null,{default:r(()=>[i(p,{cols:"12",class:"d-flex justify-center"},{default:r(()=>[j("div",Pe,[i(Ue,{src:e(F).imageUrl??("storageBack"in l?l.storageBack:e(oe))(e(t).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),i(W,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:r(()=>[i(N,{disabled:e(V),loading:e(V)},null,8,["disabled","loading"]),e(y)?M("",!0):(B(),P(Q,{key:0,disabled:e(V),loading:e(V),onClick:a[22]||(a[22]=o=>q()),color:"primary"},{default:r(()=>[x(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{qa as default};
