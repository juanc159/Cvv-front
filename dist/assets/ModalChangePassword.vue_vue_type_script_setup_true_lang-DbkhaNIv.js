import{V as T,r as U}from"./VForm-CLVj92l5.js";import{d as A,U as N,r as c,ax as P,o as f,c as S,b as s,f as r,k as o,g as V,G as _,e as v,C as g,D as I,ac as M,a8 as y,ad as C,af as z}from"./index-0u8zvxzr.js";import{_ as R}from"./AppTextField.vue_vue_type_script_setup_true_lang-Ctv8epG7.js";import{_ as j}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-E0PtK6I_.js";import{V as E}from"./VDialog-D075NDHl.js";import{V as G,a as Z}from"./VToolbar-CRUExr_K.js";import{V as h}from"./VCard-DDFxyb0f.js";import{V as D}from"./VGrid-BJjW3lzw.js";import{V as H,a as w}from"./VRow-CBdBAyyV.js";const J=v("h4",null,"¡Bienvenido! Como es tu primera vez ingresando al sistema, es necesario que cambies tu contraseña. Por favor, elige una nueva contraseña que sea segura y fácil de recordar.",-1),K=v("span",null," Requisitos de la Contraseña: Mínimo de 8 caracteres. Debe incluir al menos: Una letra mayúscula (A-Z) Una letra minúscula (a-z) Un número (0-9) Asegúrate de que la nueva contraseña no sea igual a la contraseña actual. ",-1),te=A({__name:"ModalChangePassword",emits:["execute"],setup(O,{expose:k,emit:x}){const B=N(),n=c({}),q=x,e=P({titleDialog:"Cambiar contraseña",isDialogVisible:!1,isLoading:!1,first_time:!1,statuses:[],form:{id:null,new_password:""}}),$=()=>{e.form={id:null,new_password:""},n.value={},l.value=!1},d=()=>{e.isDialogVisible=!e.isDialogVisible},F=async i=>{$(),d(),e.form.id=i},L=async()=>{var a,u,m;const i=await((a=b.value)==null?void 0:a.validate());if(i!=null&&i.valid){e.isLoading=!0;const{response:t,data:p}=await z("/user/changePassword").post({id:e.form.id,new_password:e.form.new_password,type_user:B.user.type_user});e.isLoading=!1,(u=t.value)!=null&&u.ok&&((m=p.value)==null?void 0:m.code)==200&&(d(),q("execute")),p.value.code==422&&(n.value=p.value.errors??{})}},b=c();k({openDialog:F});const l=c(!1);return(i,a)=>{const u=j,m=R;return f(),S("div",null,[s(E,{modelValue:o(e).isDialogVisible,"onUpdate:modelValue":a[6]||(a[6]=t=>o(e).isDialogVisible=t),persistent:"","max-width":"40rem",transition:"dialog-transition"},{default:r(()=>[o(e).first_time?_("",!0):(f(),V(u,{key:0,onClick:a[0]||(a[0]=t=>d())})),v("div",null,[s(G,{color:"primary"},{default:r(()=>[s(Z,null,{default:r(()=>[g(I(o(e).titleDialog),1)]),_:1})]),_:1})]),s(h,null,{default:r(()=>[s(D,null,{default:r(()=>[s(T,{ref_key:"refForm",ref:b,onSubmit:M(()=>{},["prevent"])},{default:r(()=>[s(H,null,{default:r(()=>[o(e).first_time?(f(),V(w,{key:0,cols:"12"},{default:r(()=>[J]),_:1})):_("",!0),s(w,{cols:"12"},{default:r(()=>[s(m,{clearable:"",modelValue:o(e).form.new_password,"onUpdate:modelValue":a[1]||(a[1]=t=>o(e).form.new_password=t),label:"Contraseña",placeholder:"············",type:o(l)?"text":"password","append-inner-icon":o(l)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[2]||(a[2]=t=>l.value=!o(l)),rules:["requiredValidator"in i?i.requiredValidator:o(U)],"error-messages":o(n).new_password,onInput:a[3]||(a[3]=t=>o(n).new_password="")},null,8,["modelValue","type","append-inner-icon","rules","error-messages"])]),_:1}),s(w,{cols:"12"},{default:r(()=>[K]),_:1})]),_:1})]),_:1},512)]),_:1}),s(D,{class:"d-flex justify-end gap-3 flex-wrap"},{default:r(()=>[o(e).first_time?_("",!0):(f(),V(C,{key:0,loading:o(e).isLoading,color:"secondary",variant:"tonal",onClick:a[4]||(a[4]=t=>d())},{default:r(()=>[s(y,{start:"",icon:"tabler-x"}),g(" Cancelar ")]),_:1},8,["loading"])),s(C,{disabled:o(e).isLoading,loading:o(e).isLoading,onClick:a[5]||(a[5]=t=>L()),color:"primary"},{default:r(()=>[s(y,{start:"",icon:"tabler-device-floppy"}),g(" Cambiar contraseña ")]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{te as _};
