import{V as H,r as S}from"./VForm-fa69f99f.js";import{_ as J}from"./AppTextField.vue_vue_type_script_setup_true_lang-ca6c5f3e.js";import{d as M,j as K,r as m,aB as I,E as Q,ab as T,o as d,c as v,b as e,f as l,n as i,g as C,e as h,v as g,F as B,i as $,y as W,a9 as b,t as x,aw as X,x as Y,a1 as q,a7 as Z,O as j,P as ee,_ as ae}from"./index-d7cd4679.js";import{u as D}from"./useImageUpload-0e495373.js";import{V as F}from"./VCardText-7ded879f.js";import{V}from"./VRow-6f2922fc.js";import{V as p}from"./VCol-613d1fb3.js";import{V as z,b as le}from"./VCard-e3db9ab7.js";import{V as te}from"./VField-72ba6fec.js";import{V as oe}from"./VFileInput-5bacc0d0.js";import{V as ie}from"./VDataTable-98eca19a.js";import"./helpers-3edea678.js";import"./VTextField-7aa7290a.js";import"./VImg-6fa5e3fc.js";import"./sweetalert2.all-ae952bba.js";import"./_commonjsHelpers-725317a4.js";/* empty css              */import"./VAvatar-a7a3edab.js";import"./VChip-000d3afd.js";import"./VSelect-77da1a23.js";import"./VList-0ccd67c2.js";import"./ssrBoot-1fa108f3.js";import"./VDivider-c727d838.js";import"./dialog-transition-e366f808.js";import"./VMenu-fbbddea5.js";const re=k=>(j("data-v-fcd12a2b"),k=k(),ee(),k),ne=re(()=>h("b",{class:"text-warning"},"*",-1)),se={key:0},de=["onClick"],ce=M({__name:"Planning",setup(k){const A=K();m(),m(),m([]);const N=m(D()),P=["jpg","jpeg","png","pdf","ppsx","pptx"];N.value.allowedExtensions=P;const U=async()=>{const a=new FormData;a.append("teacher_id",JSON.stringify(c.value.id));let t=0;c.value.complementaries.forEach(u=>{u.subjects.forEach(f=>{f.files.forEach((o,s)=>{a.append("file_id_"+t,o.id),a.append("file_grade_id_"+t,u.grade_id),a.append("file_section_id_"+t,u.section_id),a.append("file_subject_id_"+t,f.value),a.append("file_file_"+t,o.file),a.append("file_name_"+t,o.name),a.append("file_delete_"+t,o.delete),t++})}),a.append("files_cant",t)}),_.form=!0,await T("/teacher-planningStore").post(a),_.form=!1},_=I({form:!1}),c=m(),n=I({});Q(async()=>{var o;_.form=!0;const{data:a,response:t,error:u,isFetching:f}=await T("/teacher-planning/"+A.params.id).get();_.form=f.value,(o=t.value)!=null&&o.ok&&a.value&&(c.value=a.value.data,c.value.complementaries.forEach(s=>{s.subjects.forEach(r=>{n["file-"+r.value]=m(D()),n["file-"+r.value].allowedExtensions=["jpg","jpeg","png","pdf","ppsx","pptx"]})}))});const G=[{title:"Título",key:"name"},{title:"Acciones",key:"actions"}],L=async a=>{a.files.push({name:n["file-"+a.value].name,file:n["file-"+a.value].imageFile,id:null,delete:0}),n["file-"+a.value].clearData()},w=(a,t,u)=>{a[t].delete=u};return(a,t)=>{const u=X,f=J;return d(),v("div",null,[e(z,null,{default:l(()=>[e(F,null,{default:l(()=>[e(V,null,{default:l(()=>[e(p,null,{default:l(()=>[e(u,{"sub-title":"Formulario Teacher planificacion","btn-action":"list","validate-crud":!0,"btn-back":!0,onChangeScreenBack:a.$router.back},null,8,["onChangeScreenBack"])]),_:1})]),_:1}),i(c)?(d(),C(F,{key:0},{default:l(()=>[e(V,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>{var o,s;return[h("h2",null,g((o=i(c))==null?void 0:o.name)+" "+g((s=i(c))==null?void 0:s.last_name),1)]}),_:1})]),_:1}),e(V,null,{default:l(()=>[(d(!0),v(B,null,$(i(c).complementaries,(o,s)=>(d(),C(p,{cols:"12",key:s},{default:l(()=>[e(z,{class:Y({"green-background":s%2===0,"red-background":s%2!==0})},{default:l(()=>[e(le,{"primary-title":""},{default:l(()=>[h("h2",null,"Grado: "+g(o.grade_name)+" "+g(o.section_name),1)]),_:2},1024),e(F,null,{default:l(()=>[(d(!0),v(B,null,$(o.subjects,(r,O)=>(d(),v("div",{key:O},[h("h3",null,"Planificacion: "+g(r.title),1),e(i(H),{"lazy-validation":""},{default:l(()=>[e(V,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(f,{clearable:"",modelValue:i(n)["file-"+r.value].name,"onUpdate:modelValue":y=>i(n)["file-"+r.value].name=y,rules:["requiredValidator"in a?a.requiredValidator:i(S)],label:"Titulo",requiredField:!0},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(te,null,{default:l(()=>[x("Archivo "),ne]),_:1}),(d(),C(oe,{rules:["requiredValidator"in a?a.requiredValidator:i(S)],onChange:i(n)["file-"+r.value].handleImageSelected,key:i(n)["file-"+r.value].key,"onClick:clear":i(n)["file-"+r.value].clearData},null,8,["rules","onChange","onClick:clear"]))]),_:2},1024),e(p,{cols:"12",sm:"3"},{default:l(()=>[e(b,{size:"30",class:"mt-6",icon:"",color:"success",onClick:y=>L(r)},{default:l(()=>[e(q,{icon:"tabler-plus"})]),_:2},1032,["onClick"])]),_:2},1024),e(p,{cols:"12"},{default:l(()=>[e(i(ie),{headers:G,items:r.files,"items-per-page":999},{"item.actions":l(({item:y,index:E})=>[y.delete?(d(),v("span",se,[x(" Sera eliminado al guardar, "),h("b",{style:{cursor:"pointer"},onClick:R=>w(r.files,E,0)},"restaurar",8,de)])):(d(),C(b,{key:1,icon:"",size:"x-small",color:"error",variant:"text",onClick:R=>w(r.files,E,1)},{default:l(()=>[e(q,{size:"22",icon:"tabler-trash"}),e(Z,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]))]),bottom:l(()=>[]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),_:1})):W("",!0),e(V,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(b,{loading:i(_).form,color:"primary",onClick:t[0]||(t[0]=o=>U())},{default:l(()=>[x(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})])}}});const Ae=ae(ce,[["__scopeId","data-v-fcd12a2b"]]);export{Ae as default};
