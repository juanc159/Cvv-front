import{V as W,r as c}from"./VForm-DLvgRuUn.js";import{s as X}from"./helpers-Bx7coLRZ.js";import{d as Y,U as x,r as f,ax as h,M as ee,Z as D,o as C,c as ae,b as o,f as s,ac as te,k as e,g as E,C as L,e as w,ad as le,G as re,q as oe,af as y,al as ie,ay as se}from"./index-d--exNae.js";import{_ as ne}from"./BtnBack.vue_vue_type_script_setup_true_lang-CexwOZdC.js";import{_ as ue}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-DZiNFCtT.js";import{_ as de}from"./AppTextField.vue_vue_type_script_setup_true_lang-B7kqXgOx.js";import{_ as me}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-B-_rCsof.js";import{u as pe,_ as ce}from"./useSelect-CfNAmvf0.js";import{_ as fe}from"./AppSelect.vue_vue_type_script_setup_true_lang-BB4zhTDl.js";import{u as ve,V as _e}from"./VFileInput-BC42TYMq.js";import{b as Ve,V as ye}from"./VCard-CRcIyXSu.js";import{V as M}from"./VCardText-Csh7jUF6.js";import{V as O,a as p}from"./VRow-DWtH4oj-.js";import{V as ge}from"./VImg-BbHm1gH0.js";import"./VInput-C3Rirru3.js";import"./VOverlay-C-sRhPRL.js";import"./forwardRefs-C-GTDzx5.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-Dm_ZvH01.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BAUX9ZLZ.js";import"./VDialog-DeXCBK_p.js";import"./dialog-transition-Bw1HtQZo.js";import"./VTooltip-lFZ4t2eE.js";import"./VTextField-Dy7eg4Nt.js";/* empty css                   */import"./VCounter-CmXY_vZM.js";import"./VSelect-Bzd3zoto.js";import"./VList-C9R-yzAB.js";import"./ssrBoot-BtYT17o-.js";import"./VAvatar-BF3wOyv9.js";import"./VDivider-BA1CFZFw.js";import"./VMenu-D0ipXlgM.js";import"./VCheckboxBtn-BRL1WHu_.js";import"./VSelectionControl-D_jNqe_d.js";import"./VChip-DQUnJtIw.js";import"./filter-BeYmgejZ.js";import"./sweetalert2.esm.all-DOYwHpwi.js";/* empty css              */const be=w("span",null," Formulario estudiante ",-1),qe=w("b",{class:"text-warning"},"*",-1),ke={style:{"block-size":"200px","inline-size":"200px"}},ua=Y({__name:"Form",setup(Fe){const P=x(),{toast:G}=se(),d=f({}),q=f(!1),I=oe(),$=f(),n=h({form:!1,countries:!1,states:!1,cities:!1}),k=f([]),S=f([]),t=f({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null}),z=()=>{for(const l in t.value)t.value[l]=null},J=async()=>{var m;t.value.id=I.params.id||null;const l=t.value.id?`/student/${t.value.id}/edit`:"/student/create";n.form=!0;const{response:a,data:i}=await y(l).get();if(n.form=!1,(m=a.value)!=null&&m.ok&&i.value&&(F.dataNueva.value=i.value.countries_arrayInfo,F.totalLinks.value=i.value.countries_countLinks,k.value=i.value.typeEducations,S.value=i.value.sections,i.value.form)){t.value=i.value.form;const u=JSON.parse(JSON.stringify(i.value.form));i.value.form.id&&u.country_id&&u.state_id&&(await j(u.country_id),await A(u.state_id),t.value.country_id=u.country_id,t.value.state_id=u.state_id,t.value.city_id=u.city_id)}},R=async()=>{var a,i;const l=await((a=$.value)==null?void 0:a.validate());if(l!=null&&l.valid){t.value.company_id=P.company.id;const m=t.value.id?`/student/update/${t.value.id}`:"/student/store",u=new FormData;for(const V in t.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(V)||u.append(V,t.value[V]);u.append("country_id",t.value.country_id.value),u.append("state_id",t.value.state_id),u.append("city_id",t.value.city_id),u.append("gender",t.value.gender),u.append("birthday",t.value.birthday),n.form=!0;const{data:v,response:b}=await y(m).post(u);n.form=!1,(i=b.value)!=null&&i.ok&&v.value&&v.value.code==200&&ie.push({name:"Student-List"}),v.value.code===422&&(d.value=v.value.errors??{})}else G("Faltan Campos Por Diligenciar","","danger")};I.params.action=="view"&&(q.value=!0),ee(async()=>{z(),await J()});const g=D(()=>Object.values(n).some(l=>l)),_=f(ve()),Z=["jpg","jpeg","png"];_.value.allowedExtensions=Z;const H=l=>{n.form=!0,_.value.handleImageSelected(l),setTimeout(()=>{t.value.photo=_.value.imageFile,n.form=!1},1e3)},K=D(()=>t.value.type_education_id?k.value.find(l=>l.value==t.value.type_education_id).grades:[]),U=f([]),B=f([]),N=f([]),T=f(1),F=pe(async l=>{var m;n.countries=!0;const{data:a,response:i}=await y("/selectInfiniteCountries").post(l);n.countries=!1,(m=i.value)!=null&&m.ok&&a.value&&(N.value=a.value.countries_arrayInfo,T.value=a.value.countries_countLinks)},N,T,{}),j=async l=>{var m;t.value.state_id=null,t.value.city_id=null,n.states=!0;const{data:a,response:i}=await y(`/selectStates/${l.value}`).get();n.states=!1,(m=i.value)!=null&&m.ok&&a.value&&(U.value=a.value.states)},A=async l=>{var m;t.value.city_id=null,n.cities=!0;const{data:a,response:i}=await y(`/selectCities/${l}`).get();n.cities=!1,(m=i.value)!=null&&m.ok&&a.value&&(B.value=a.value.cities)},Q=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(l,a)=>{const i=fe,m=ce,u=me,v=de,b=ue,V=ne;return C(),ae("div",null,[o(ye,{disabled:e(n).form,loading:e(n).form},{default:s(()=>[o(Ve,{class:"d-flex justify-space-between"},{default:s(()=>[be]),_:1}),o(M,null,{default:s(()=>[o(W,{ref_key:"formValidation",ref:$,onSubmit:te(()=>{},["prevent"]),disabled:e(q)},{default:s(()=>[o(O,null,{default:s(()=>[o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{items:e(k),clearable:"",rules:["requiredValidator"in l?l.requiredValidator:e(c)],modelValue:e(t).type_education_id,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).type_education_id=r),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{clearable:"",items:e(K),rules:["requiredValidator"in l?l.requiredValidator:e(c)],modelValue:e(t).grade_id,"onUpdate:modelValue":a[1]||(a[1]=r=>e(t).grade_id=r),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{clearable:"",items:e(S),rules:["requiredValidator"in l?l.requiredValidator:e(c)],modelValue:e(t).section_id,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).section_id=r),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),o(p,{cols:"12",md:"4"},{default:s(()=>[o(m,{requiredField:!0,label:"País",returnObject:"",modelValue:e(t).country_id,"onUpdate:modelValue":[a[3]||(a[3]=r=>e(t).country_id=r),a[4]||(a[4]=r=>j(r))],select:e(F),"error-messages":e(d).country_id,onInput:a[5]||(a[5]=r=>e(d).country_id=""),clearable:"",loading:e(n).countries,rules:["requiredValidator"in l?l.requiredValidator:e(c)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),o(p,{cols:"12",md:"4"},{default:s(()=>[o(u,{loading:e(n).states,requiredField:!0,clearable:"",items:e(U),modelValue:e(t).state_id,"onUpdate:modelValue":[a[6]||(a[6]=r=>e(t).state_id=r),a[7]||(a[7]=r=>A(r))],label:"Estado","error-messages":e(d).state_id,onInput:a[8]||(a[8]=r=>e(d).state_id=""),rules:["requiredValidator"in l?l.requiredValidator:e(c)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),o(p,{cols:"12",md:"4"},{default:s(()=>[o(u,{loading:e(n).cities,requiredField:!0,clearable:"",items:e(B),modelValue:e(t).city_id,"onUpdate:modelValue":a[9]||(a[9]=r=>e(t).city_id=r),label:"Municipio","error-messages":e(d).city_id,onInput:a[10]||(a[10]=r=>e(d).city_id=""),rules:["requiredValidator"in l?l.requiredValidator:e(c)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),o(p,{cols:"12",sm:"3"},{default:s(()=>[o(v,{clearable:"",modelValue:e(t).identity_document,"onUpdate:modelValue":a[11]||(a[11]=r=>e(t).identity_document=r),rules:["requiredValidator"in l?l.requiredValidator:e(c)],"error-messages":e(d).identity_document,label:"Cédula de identidad",onInput:a[12]||(a[12]=r=>e(d).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"9"},{default:s(()=>[o(v,{clearable:"",modelValue:e(t).full_name,"onUpdate:modelValue":a[13]||(a[13]=r=>e(t).full_name=r),rules:["requiredValidator"in l?l.requiredValidator:e(c)],"error-messages":e(d).full_name,label:"Nombre completo",onInput:a[14]||(a[14]=r=>e(d).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(i,{clearable:"",modelValue:e(t).gender,"onUpdate:modelValue":a[15]||(a[15]=r=>e(t).gender=r),items:Q,rules:["requiredValidator"in l?l.requiredValidator:e(c)],"error-messages":e(d).gender,label:"Sexo",onInput:a[16]||(a[16]=r=>e(d).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(b,{clearable:"",modelValue:e(t).birthday,"onUpdate:modelValue":a[17]||(a[17]=r=>e(t).birthday=r),label:"Fecha de nacimiento",rules:["requiredValidator"in l?l.requiredValidator:e(c)],requiredField:!0,"error-messages":e(d).birthday,onInput:a[18]||(a[18]=r=>e(d).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[o(b,{clearable:"",modelValue:e(t).real_entry_date,"onUpdate:modelValue":a[19]||(a[19]=r=>e(t).real_entry_date=r),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in l?l.requiredValidator:e(c)],requiredField:!0,"error-messages":e(d).real_entry_date,onInput:a[20]||(a[20]=r=>e(d).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(p,{cols:"12",sm:"4"},{default:s(()=>[(C(),E(_e,{accept:"image/*",key:e(_).key,onChange:a[21]||(a[21]=r=>H(r)),"onClick:clear":e(_).clearData},{label:s(()=>[L(" Foto "),qe]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),o(O,null,{default:s(()=>[o(p,{cols:"12",class:"d-flex justify-center"},{default:s(()=>[w("div",ke,[o(ge,{src:e(_).imageUrl??("storageBack"in l?l.storageBack:e(X))(e(t).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),o(M,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:s(()=>[o(V,{disabled:e(g),loading:e(g)},null,8,["disabled","loading"]),e(q)?re("",!0):(C(),E(le,{key:0,disabled:e(g),loading:e(g),onClick:a[22]||(a[22]=r=>R()),color:"primary"},{default:s(()=>[L(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{ua as default};
