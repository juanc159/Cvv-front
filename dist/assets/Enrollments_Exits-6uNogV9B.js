import{f as x}from"./formatters-jXmQG_TZ.js";import{_ as H}from"./AppCardActions.vue_vue_type_style_index_0_lang-COAUBNE7.js";import{d as G,U as L,V as P,r as S,Y as k,N as Y,a$ as C,c as s,o as n,b as i,l as r,f as h,cj as Z,a9 as A,D as B,a7 as R,e,F as u,q as m,y as F,E as a,aO as U,Z as z,$ as J}from"./index-CP1x6TMv.js";import{c as K}from"./createUrl-B-cSQ0bH.js";import{b as Q}from"./helpers-BWkPk87b.js";import{V as $}from"./VCardText-liak_PP2.js";import{V as W,a as I}from"./VRow-CFC8hs93.js";import{V as M}from"./VTable-C_S_Q_tT.js";import{V as j}from"./VContainer-BYuHzhCU.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VCard-BbGIaCZi.js";import"./VAvatar-Dhynoy1k.js";import"./VImg-Cypx3H-K.js";import"./index-0F-JFElI.js";import"./constants-2GBt7OCP.js";/* empty css              */const w=y=>(z("data-v-57e0eea3"),y=y(),J(),y),ee=w(()=>e("thead",null,[e("tr",{class:"header-row"},[e("th",{class:"header-cell",rowspan:"2"},"Tipo de Educación"),e("th",{class:"header-cell",rowspan:"2"},"Grado y Sección"),e("th",{class:"header-cell initial-header",colspan:"3"},"Matrícula Inicial"),e("th",{class:"header-cell entries-header",colspan:"3"},"Ingresos"),e("th",{class:"header-cell withdrawals-header",colspan:"3"},"Egresos"),e("th",{class:"header-cell current-header",colspan:"3"},"Matrícula Actual"),e("th",{class:"header-cell foreign-header",colspan:"3"},"Extranjeros"),e("th",{class:"header-cell nationals-header",colspan:"3"},"Nacionales")]),e("tr",{class:"header-row"},[e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T"),e("th",{class:"header-cell"},"M"),e("th",{class:"header-cell"},"F"),e("th",{class:"header-cell"},"T")])],-1)),le=["rowspan"],te={class:"grade-cell"},ae={class:"initial-cell"},se={class:"initial-cell"},ne={class:"initial-cell"},oe={class:"entries-cell"},re={class:"entries-cell"},ce={class:"entries-cell"},ie={class:"withdrawals-cell"},de={class:"withdrawals-cell"},ue={class:"withdrawals-cell"},he={class:"current-cell"},me={class:"current-cell"},_e={class:"current-cell"},fe={class:"foreign-cell"},pe={class:"foreign-cell"},we={class:"foreign-cell"},be={class:"nationals-cell"},ge={class:"nationals-cell"},ye={class:"nationals-cell"},Ne={class:"subtotal-row"},Ee=w(()=>e("td",{class:"subtotal-cell"},"Subtotal",-1)),xe={class:"initial-cell"},De={class:"entries-cell"},ve={class:"withdrawals-cell"},Ve={class:"current-cell"},Se={class:"current-cell"},Fe={class:"current-cell"},Ie={class:"total-row"},Me=w(()=>e("td",{colspan:"2",class:"total-cell"},"Total General",-1)),Te={class:"initial-cell"},ke={class:"entries-cell"},Ce={class:"withdrawals-cell"},Ae={class:"current-cell"},Be={class:"current-cell"},Re={class:"current-cell"},Ue=w(()=>e("h2",{class:"text-h4 font-weight-bold mb-4"},"Estudiantes Retirados",-1)),$e=w(()=>e("thead",null,[e("tr",null,[e("th",null,"Documento"),e("th",null,"Apellidos y Nombres"),e("th",null,"Fecha Nacimiento"),e("th",null,"Grado"),e("th",null,"Sección"),e("th",null,"Sexo"),e("th",null,"Fecha Retiro"),e("th",null,"Motivo")])],-1)),je={key:0},Ge=w(()=>e("td",{colspan:"8",class:"text-center"},"No hay estudiantes retirados registrados",-1)),Oe=[Ge],qe=w(()=>e("h2",{class:"text-h4 font-weight-bold mb-4"},"Estudiantes Ingresados",-1)),He=w(()=>e("thead",null,[e("tr",null,[e("th",null,"Documento"),e("th",null,"Apellidos y Nombres"),e("th",null,"Fecha Nacimiento"),e("th",null,"Grado"),e("th",null,"Sección"),e("th",null,"Sexo"),e("th",null,"Fecha Ingreso")])],-1)),Le={key:0},Pe=w(()=>e("td",{colspan:"8",class:"text-center"},"No hay estudiantes retirados registrados",-1)),Ye=[Pe],Ze=G({__name:"StudentStatistics",setup(y){const{company:D}=L(P()),E=S([]),N=S([]),v=S([]),g=k(()=>{const o={male:0,female:0,total:0},c={male:0,female:0,total:0},d={male:0,female:0,total:0},_={male:0,female:0,total:0},t={male:0,female:0,total:0},p={male:0,female:0,total:0};return E.value.forEach(l=>{o.male+=Number(l.initial.male),o.female+=Number(l.initial.female),o.total+=Number(l.initial.total),c.male+=Number(l.new_entries.male),c.female+=Number(l.new_entries.female),c.total+=Number(l.new_entries.total),d.male+=Number(l.withdrawals.male),d.female+=Number(l.withdrawals.female),d.total+=Number(l.withdrawals.total),_.male+=Number(l.current.male),_.female+=Number(l.current.female),_.total+=Number(l.current.total),t.male+=Number(l.foreign.male),t.female+=Number(l.foreign.female),t.total+=Number(l.foreign.total),p.male+=Number(l.nationals.male),p.female+=Number(l.nationals.female),p.total+=Number(l.nationals.total)}),{initial:o,new_entries:c,withdrawals:d,current:_,foreign:t,nationals:p}}),V=async()=>{f.fetchData=!0;try{const{data:o,response:c}=await U(K("/students/statistics",{query:{dateInitial:b.dateInitial,dateEnd:b.dateEnd,company_id:D.value.id}}));if(!c.value.ok)throw new Error("Error al obtener datos");E.value=Object.values(o.value.statistics),N.value=o.value.withdrawnStudents,v.value=o.value.entriesStudents}catch(o){console.error("Error al obtener datos:",o)}finally{f.fetchData=!1}};Y(async()=>{V()});const O=k(()=>{const o={};return E.value.forEach(c=>{const d=c.type_education_name;o[d]||(o[d]={type:d,items:[],subtotal:{initial:{male:0,female:0,total:0},new_entries:{male:0,female:0,total:0},withdrawals:{male:0,female:0,total:0},current:{male:0,female:0,total:0},foreign:{male:0,female:0,total:0},nationals:{male:0,female:0,total:0}}}),o[d].items.push(c),["initial","new_entries","withdrawals","current","foreign","nationals"].forEach(_=>{o[d].subtotal[_].male+=Number(c[_].male),o[d].subtotal[_].female+=Number(c[_].female),o[d].subtotal[_].total+=Number(c[_].total)})}),Object.values(o)}),b=C({dateInitial:null,dateEnd:null}),f=C({excel:!1,fetchData:!1}),q=async()=>{var d;f.excel=!0;const{data:o,response:c}=await U("/students/statisticsExcelExport").post({dateInitial:b.dateInitial,dateEnd:b.dateEnd,company_id:D.value.id});f.excel=!1,(d=c.value)!=null&&d.ok&&o.value&&Q(o.value.excel,"Estadisticas de Estudiantes")};return(o,c)=>{const d=Z,_=H;return n(),s("div",null,[i(_,{title:"Estadísticas de Estudiantes",actionRefresh:"",onRefresh:V,loading:r(f).fetchData,"onUpdate:loading":c[2]||(c[2]=t=>r(f).fetchData=t)},{default:h(()=>[i($,null,{default:h(()=>[i(W,null,{default:h(()=>[i(I,{cols:"12",md:"3"},{default:h(()=>[i(d,{clearable:"",modelValue:r(b).dateInitial,"onUpdate:modelValue":c[0]||(c[0]=t=>r(b).dateInitial=t),label:"Fecha inicio",placeholder:"Desde"},null,8,["modelValue"])]),_:1}),i(I,{cols:"12",md:"3"},{default:h(()=>[i(d,{clearable:"",modelValue:r(b).dateEnd,"onUpdate:modelValue":c[1]||(c[1]=t=>r(b).dateEnd=t),label:"Fecha fin",placeholder:"Hasta"},null,8,["modelValue"])]),_:1}),i(I,{cols:"12",md:"3",class:"d-flex gap-3 flex-wrap"},{default:h(()=>[i(A,{class:"mt-6",onClick:V,loading:r(f).fetchData,disabled:r(f).fetchData},{prepend:h(()=>[i(R,{icon:"tabler-search"})]),default:h(()=>[B(" Buscar ")]),_:1},8,["loading","disabled"]),i(A,{class:"mt-6",onClick:q,loading:r(f).excel,disabled:r(f).excel},{prepend:h(()=>[i(R,{icon:"tabler-file-type-xls"})]),default:h(()=>[B(" Exportar ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),i($,null,{default:h(()=>[i(M,{class:"stats-table"},{default:h(()=>[ee,e("tbody",null,[(n(!0),s(u,null,m(r(O),(t,p)=>(n(),s(u,{key:p},[(n(!0),s(u,null,m(t.items,(l,T)=>(n(),s("tr",{key:T,class:"data-row"},[T===0?(n(),s("td",{key:0,rowspan:t.items.length+1,class:"type-cell"},a(t.type),9,le)):F("",!0),e("td",te,a(l.grade_name)+" - "+a(l.section_name),1),e("td",ae,a(l.initial.male),1),e("td",se,a(l.initial.female),1),e("td",ne,a(l.initial.total),1),e("td",oe,a(l.new_entries.male),1),e("td",re,a(l.new_entries.female),1),e("td",ce,a(l.new_entries.total),1),e("td",ie,a(l.withdrawals.male),1),e("td",de,a(l.withdrawals.female),1),e("td",ue,a(l.withdrawals.total),1),e("td",he,a(l.current.male),1),e("td",me,a(l.current.female),1),e("td",_e,a(l.current.total),1),e("td",fe,a(l.foreign.male),1),e("td",pe,a(l.foreign.female),1),e("td",we,a(l.foreign.total),1),e("td",be,a(l.nationals.male),1),e("td",ge,a(l.nationals.female),1),e("td",ye,a(l.nationals.total),1)]))),128)),e("tr",Ne,[Ee,(n(!0),s(u,null,m(t.subtotal.initial,l=>(n(),s("td",xe,a(l),1))),256)),(n(!0),s(u,null,m(t.subtotal.new_entries,l=>(n(),s("td",De,a(l),1))),256)),(n(!0),s(u,null,m(t.subtotal.withdrawals,l=>(n(),s("td",ve,a(l),1))),256)),(n(!0),s(u,null,m(t.subtotal.current,l=>(n(),s("td",Ve,a(l),1))),256)),(n(!0),s(u,null,m(t.subtotal.foreign,l=>(n(),s("td",Se,a(l),1))),256)),(n(!0),s(u,null,m(t.subtotal.nationals,l=>(n(),s("td",Fe,a(l),1))),256))])],64))),128)),e("tr",Ie,[Me,(n(!0),s(u,null,m(r(g).initial,t=>(n(),s("td",Te,a(t),1))),256)),(n(!0),s(u,null,m(r(g).new_entries,t=>(n(),s("td",ke,a(t),1))),256)),(n(!0),s(u,null,m(r(g).withdrawals,t=>(n(),s("td",Ce,a(t),1))),256)),(n(!0),s(u,null,m(r(g).current,t=>(n(),s("td",Ae,a(t),1))),256)),(n(!0),s(u,null,m(r(g).foreign,t=>(n(),s("td",Be,a(t),1))),256)),(n(!0),s(u,null,m(r(g).nationals,t=>(n(),s("td",Re,a(t),1))),256))])])]),_:1}),i(j,{style:{"margin-top":"40px"}},{default:h(()=>[Ue,i(M,{"fixed-header":""},{default:h(()=>[$e,e("tbody",null,[(n(!0),s(u,null,m(r(N),(t,p)=>(n(),s("tr",{key:p},[e("td",null,a(t.identity_document),1),e("td",null,a(t.full_name),1),e("td",null,a(("formatDate"in o?o.formatDate:r(x))(t.birthday)),1),e("td",null,a(t.grade_name),1),e("td",null,a(t.section_name),1),e("td",null,a(t.gender==="M"?"Masculino":"Femenino"),1),e("td",null,a(("formatDate"in o?o.formatDate:r(x))(t.withdrawal_date)),1),e("td",null,a(t.reason),1)]))),128)),r(N).length===0?(n(),s("tr",je,Oe)):F("",!0)])]),_:1})]),_:1}),i(j,{style:{"margin-top":"40px"}},{default:h(()=>[qe,i(M,{"fixed-header":""},{default:h(()=>[He,e("tbody",null,[(n(!0),s(u,null,m(r(v),(t,p)=>(n(),s("tr",{key:p},[e("td",null,a(t.identity_document),1),e("td",null,a(t.full_name),1),e("td",null,a(("formatDate"in o?o.formatDate:r(x))(t.birthday)),1),e("td",null,a(t.grade_name),1),e("td",null,a(t.section_name),1),e("td",null,a(t.gender==="M"?"Masculino":"Femenino"),1),e("td",null,a(("formatDate"in o?o.formatDate:r(x))(t.real_entry_date)),1)]))),128)),r(v).length===0?(n(),s("tr",Le,Ye)):F("",!0)])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])])}}}),ze=X(Ze,[["__scopeId","data-v-57e0eea3"]]),ul=G({__name:"Enrollments&Exits",setup(y){return(D,E)=>{const N=ze;return n(),s("div",null,[i(N)])}}});export{ul as default};
