import{r as V}from"./validators-BHTN6IsO.js";import{s as se}from"./helpers-k4gBJwIF.js";import{d as x,r as c,N as h,w as ee,h as L,o as B,c6 as ne,f as r,q as ue,l as e,e as N,b as l,c as P,y as D,aI as de,a9 as E,a7 as Z,B as me,I as ce,n as fe,k as pe,V as ve,t as ye,aa as Ve,Y as H,af as ge,D as A,E as _e,ct as be,ad as K,aZ as ke,b6 as qe,aU as j}from"./index-C9b6hrcK.js";import{_ as Fe}from"./BtnBack.vue_vue_type_script_setup_true_lang-Bqqux5iC.js";import{_ as Ie}from"./AppTextField.vue_vue_type_script_setup_true_lang-1kb894KG.js";import{_ as we}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-DfccHCZ9.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-CBNeKW5u.js";import{V as $e}from"./VTextField-J-V-HBXf.js";import{V as W}from"./VDivider-DvYWI5ti.js";import{V as Q,a as f}from"./VRow-ZGlPE998.js";import{u as Ce}from"./useFileUpload-Lqub9KWs.js";import{a as Se,V as Ue}from"./VCard-e9jpbFqx.js";import{V as X}from"./VCardText-CxJltrbS.js";import{V as Be}from"./VForm-CokzWhvo.js";import{V as Ne}from"./VCheckbox-sV5D0K3H.js";import{V as Te}from"./VFileInput-xSaOaucP.js";import{V as ze}from"./VImg-MODgQ4GY.js";import"./constants-30sb_wC2.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-CLeitNmU.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-D7mzW6Fx.js";import"./VDialog-RqZjDXAw.js";import"./dialog-transition-Di1pGNk8.js";import"./VSelect-BhKRerLF.js";import"./VList-MUuu6vN0.js";import"./ssrBoot-DxvvqgRH.js";import"./VAvatar-CaIuQVp3.js";import"./VMenu-CsSg1Nwp.js";import"./VCheckboxBtn-CZeXJj-D.js";import"./VSelectionControl-CN7dOi7m.js";import"./VChip-DuawQfnX.js";import"./filter-BDNlLOSp.js";/* empty css                   */import"./VCounter-J0O_p47B.js";/* empty css              */import"./sweetalert2.esm.all-DV3w3JmD.js";const Ae={key:0,class:"text-center"},je={key:1,class:"d-flex justify-content-between aling-items-center p-2"},Le=x({__name:"SelectInfinite",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},select:{type:Object,default:()=>({})},multiple:{type:Boolean,default:()=>!1}},emits:["clearVmodel"],setup(p,{emit:I}){const{items:S,loading:d,select:v}=p,g=I,m=c(!1);h(()=>{v.totalLinks.value>1&&(m.value=!0)});const n=()=>{g("clearVmodel",!0),v.next()},_=()=>{g("clearVmodel",!0),v.prev()};return ee(v.dataNueva,()=>{m.value==!1&&v.totalLinks.value>1&&(m.value=!0)}),(w,b)=>{const t=ae;return B(),L(t,me(w.$attrs,{items:p.select.dataNueva.value,multiple:p.multiple}),ne({_:2},[e(m)?{name:"prepend-item",fn:r(()=>[N("div",null,[l($e,{clearable:"",placeholder:"Buscar...	",class:"mb-2",modelValue:p.select.searchQueryInfinite.value,"onUpdate:modelValue":b[0]||(b[0]=k=>p.select.searchQueryInfinite.value=k)},null,8,["modelValue"]),l(W)])]),key:"0"}:void 0,e(m)?{name:"append-item",fn:r(()=>[N("div",null,[l(W),p.loading?(B(),P("div",Ae,[l(de,{size:"24",color:"primary",indeterminate:""})])):D("",!0),p.loading?D("",!0):(B(),P("div",je,[l(Q,null,{default:r(()=>[l(f,{sm:"6",class:"text-left"},{default:r(()=>[l(E,{class:"mt-2 ml-5",disabled:p.select.page.value<=1,onClick:b[1]||(b[1]=k=>_()),color:"primary",icon:""},{default:r(()=>[l(Z,{icon:"tabler-chevron-left"})]),_:1},8,["disabled"])]),_:1}),l(f,{sm:"6",class:"text-right"},{default:r(()=>[l(E,{class:"mt-2 mr-5",disabled:p.select.page.value>=p.select.totalLinks.value,onClick:b[2]||(b[2]=k=>n()),color:"primary",icon:""},{default:r(()=>[l(Z,{icon:"tabler-chevron-right"})]),_:1},8,["disabled"])]),_:1})]),_:1})]))])]),key:"1"}:void 0,ue(w.$slots,(k,q)=>({name:q,fn:r(F=>[ce(w.$slots,q,fe(pe(F||{})))])}))]),1040,["items","multiple"])}}});function Pe(p,I=[],S=0,d={}){const v=c(""),g=c([]),m=c(1),n=c(1),_=c({}),w=async()=>{m.value--,m.value<=1&&(m.value=1),await t()},b=async()=>{m.value++,m.value>n.value&&(m.value=n.value),await t()},t=async()=>{let q={page:m.value,searchQueryInfinite:v.value};for(const F in d)q[F]=d[F];for(const F in _.value)q[F]=_[F];await p(q),g.value=[],g.value.push(...I.value)};let k=null;return ee(v,async(q,F)=>{k&&clearTimeout(k),m.value=1;let $={page:m.value,searchQueryInfinite:q};for(const y in d)$[y]=d[y];for(const y in _.value)$[y]=_[y];k=setTimeout(async()=>{await p($),g.value=[],I&&I.value!==void 0&&g.value.push(...I.value),S&&S.value!==void 0&&(n.value=S.value)},300)}),{searchQueryInfinite:v,dataNueva:g,page:m,filterInterno:_,next:b,prev:w,search:t,totalLinks:n}}const De=N("span",null," Formulario estudiante ",-1),Ee=N("b",{class:"text-warning"},"*",-1),Qe={style:{"block-size":"200px","inline-size":"200px"}},Fa=x({__name:"Form",setup(p){const I=ve(),{toast:S}=qe(),d=c({}),v=c(!1),g=ye(),m=c(),n=Ve({form:!1,countries:!1,states:!1,cities:!1}),_=c([]),w=c([]),b=c([]),t=c({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null,country_id:null,state_id:null,city_id:null,gender:null,birthday:null,real_entry_date:null,nationalized:null}),k=()=>{for(const i in t.value)t.value[i]=null},q=async()=>{t.value.id=g.params.id||null;const i=t.value.id?`/student/${t.value.id}/edit`:"/student/create";n.form=!0;const{response:a,data:u}=await K(i).get({params:{company_id:I.company.id}});if(n.form=!1,a.status==200&&u&&(z.dataNueva.value=u.countries_arrayInfo,z.totalLinks.value=u.countries_countLinks,_.value=u.typeEducations,w.value=u.sections,b.value=u.typeDocuments,u.form)){t.value=u.form;const s=JSON.parse(JSON.stringify(u.form));u.form.id&&s.country_id&&s.state_id&&(await J(s.country_id),await Y(s.state_id),t.value.country_id=s.country_id,t.value.state_id=s.state_id,t.value.city_id=s.city_id)}},F=async()=>{var a;const i=await((a=m.value)==null?void 0:a.validate());if(i!=null&&i.valid){t.value.company_id=I.company.id;const u=t.value.id?`/student/update/${t.value.id}`:"/student/store",s=new FormData;for(const U in t.value)["arrayDetails","country_id","state_id","city_id","gender","birthday"].includes(U)||s.append(U,t.value[U]);s.append("country_id",t.value.country_id.value),s.append("state_id",t.value.state_id),s.append("city_id",t.value.city_id),s.append("gender",t.value.gender),s.append("birthday",t.value.birthday),n.form=!0;const{data:C,response:T}=await K(u).post(s);n.form=!1,T.status==200&&C&&C.code==200&&ke.push({name:"Student-List"}),C.code===422&&(d.value=C.errors??{})}else S("Faltan Campos Por Diligenciar","","danger")};g.params.action=="view"&&(v.value=!0),h(async()=>{k(),await q()});const $=H(()=>Object.values(n).some(i=>i)),y=c(Ce()),te=["jpg","jpeg","png"];y.value.allowedExtensions=te;const le=i=>{n.form=!0,y.value.handleImageSelected(i),setTimeout(()=>{t.value.photo=y.value.imageFile,n.form=!1},1e3)},ie=H(()=>t.value.type_education_id?_.value.find(i=>i.value==t.value.type_education_id).grades:[]),M=c([]),O=c([]),R=c([]),G=c(1),z=Pe(async i=>{var s;n.countries=!0;const{data:a,response:u}=await j("/selectInfiniteCountries").post(i);n.countries=!1,(s=u.value)!=null&&s.ok&&a.value&&(R.value=a.value.countries_arrayInfo,G.value=a.value.countries_countLinks)},R,G,{}),J=async i=>{var s;t.value.state_id=null,t.value.city_id=null,n.states=!0;const{data:a,response:u}=await j(`/selectStates/${i.value}`).get();n.states=!1,(s=u.value)!=null&&s.ok&&a.value&&(M.value=a.value.states)},Y=async i=>{var s;t.value.city_id=null,n.cities=!0;const{data:a,response:u}=await j(`/selectCities/${i}`).get();n.cities=!1,(s=u.value)!=null&&s.ok&&a.value&&(O.value=a.value.cities)},oe=[{value:"M",title:"Masculino"},{value:"F",title:"Femenino"}];return(i,a)=>{const u=ae,s=Le,C=we,T=Ie,U=be,re=Fe;return B(),P("div",null,[l(Ue,{disabled:e(n).form,loading:e(n).form},{default:r(()=>[l(Se,{class:"d-flex justify-space-between"},{default:r(()=>[De]),_:1}),l(X,null,{default:r(()=>[l(Be,{ref_key:"formValidation",ref:m,onSubmit:ge(()=>{},["prevent"]),disabled:e(v)},{default:r(()=>[l(Q,null,{default:r(()=>[l(f,{cols:"12",sm:"4"},{default:r(()=>[l(u,{items:e(_),clearable:"",requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(t).type_education_id,"onUpdate:modelValue":a[0]||(a[0]=o=>e(t).type_education_id=o),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),l(f,{cols:"12",sm:"4"},{default:r(()=>[l(u,{clearable:"",items:e(ie),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(t).grade_id,"onUpdate:modelValue":a[1]||(a[1]=o=>e(t).grade_id=o),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),l(f,{cols:"12",sm:"4"},{default:r(()=>[l(u,{clearable:"",items:e(w),requiredField:!0,rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(t).section_id,"onUpdate:modelValue":a[2]||(a[2]=o=>e(t).section_id=o),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),l(f,{cols:"12",md:"3"},{default:r(()=>[l(s,{requiredField:!0,label:"País",returnObject:"",modelValue:e(t).country_id,"onUpdate:modelValue":[a[3]||(a[3]=o=>e(t).country_id=o),a[4]||(a[4]=o=>J(o))],select:e(z),"error-messages":e(d).country_id,onInput:a[5]||(a[5]=o=>e(d).country_id=""),clearable:"",loading:e(n).countries,rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["modelValue","select","error-messages","loading","rules"])]),_:1}),l(f,{cols:"12",md:"3"},{default:r(()=>[l(C,{loading:e(n).states,requiredField:!0,clearable:"",items:e(M),modelValue:e(t).state_id,"onUpdate:modelValue":[a[6]||(a[6]=o=>e(t).state_id=o),a[7]||(a[7]=o=>Y(o))],label:"Estado","error-messages":e(d).state_id,onInput:a[8]||(a[8]=o=>e(d).state_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),l(f,{cols:"12",md:"4"},{default:r(()=>[l(C,{loading:e(n).cities,requiredField:!0,clearable:"",items:e(O),modelValue:e(t).city_id,"onUpdate:modelValue":a[9]||(a[9]=o=>e(t).city_id=o),label:"Municipio","error-messages":e(d).city_id,onInput:a[10]||(a[10]=o=>e(d).city_id=""),rules:["requiredValidator"in i?i.requiredValidator:e(V)]},null,8,["loading","items","modelValue","error-messages","rules"])]),_:1}),l(f,{cols:"12",md:"2"},{default:r(()=>[l(Ne,{modelValue:e(t).nationalized,"onUpdate:modelValue":a[11]||(a[11]=o=>e(t).nationalized=o),label:"Nacionalizado","true-value":!0,"false-value":!1},{label:r(()=>[A(" Nacionalizado: "+_e(e(t).nationalized?"Sí":"No"),1)]),_:1},8,["modelValue"])]),_:1}),l(f,{cols:"12",sm:"3"},{default:r(()=>[l(u,{clearable:"",items:e(b),rules:["requiredValidator"in i?i.requiredValidator:e(V)],modelValue:e(t).type_document_id,"onUpdate:modelValue":a[12]||(a[12]=o=>e(t).type_document_id=o),label:"Tipo de documento"},null,8,["items","rules","modelValue"])]),_:1}),l(f,{cols:"12",sm:"3"},{default:r(()=>[l(T,{clearable:"",modelValue:e(t).identity_document,"onUpdate:modelValue":a[13]||(a[13]=o=>e(t).identity_document=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).identity_document,label:"Documento",onInput:a[14]||(a[14]=o=>e(d).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),l(f,{cols:"12",sm:"6"},{default:r(()=>[l(T,{clearable:"",modelValue:e(t).full_name,"onUpdate:modelValue":a[15]||(a[15]=o=>e(t).full_name=o),rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).full_name,label:"Nombre completo",onInput:a[16]||(a[16]=o=>e(d).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),l(f,{cols:"12",sm:"3"},{default:r(()=>[l(u,{clearable:"",modelValue:e(t).gender,"onUpdate:modelValue":a[17]||(a[17]=o=>e(t).gender=o),items:oe,rules:["requiredValidator"in i?i.requiredValidator:e(V)],"error-messages":e(d).gender,label:"Sexo",onInput:a[18]||(a[18]=o=>e(d).gender=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),l(f,{cols:"12",sm:"3"},{default:r(()=>[l(U,{clearable:"",modelValue:e(t).birthday,"onUpdate:modelValue":a[19]||(a[19]=o=>e(t).birthday=o),label:"Fecha de nacimiento",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).birthday,onInput:a[20]||(a[20]=o=>e(d).birthday="")},null,8,["modelValue","rules","error-messages"])]),_:1}),l(f,{cols:"12",sm:"3"},{default:r(()=>[l(U,{clearable:"",modelValue:e(t).real_entry_date,"onUpdate:modelValue":a[21]||(a[21]=o=>e(t).real_entry_date=o),label:"Fecha de ingreso a la institución",rules:["requiredValidator"in i?i.requiredValidator:e(V)],requiredField:!0,"error-messages":e(d).real_entry_date,onInput:a[22]||(a[22]=o=>e(d).real_entry_date="")},null,8,["modelValue","rules","error-messages"])]),_:1}),l(f,{cols:"12",sm:"3"},{default:r(()=>[(B(),L(Te,{accept:"image/*",key:e(y).key,onChange:a[23]||(a[23]=o=>le(o)),"onClick:clear":e(y).clearData},{label:r(()=>[A(" Foto "),Ee]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),l(Q,null,{default:r(()=>[l(f,{cols:"12",class:"d-flex justify-center"},{default:r(()=>[N("div",Qe,[l(ze,{src:e(y).imageUrl??("storageBack"in i?i.storageBack:e(se))(e(t).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),l(X,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:r(()=>[l(re,{disabled:e($),loading:e($)},null,8,["disabled","loading"]),e(v)?D("",!0):(B(),L(E,{key:0,disabled:e($),loading:e($),onClick:a[24]||(a[24]=o=>F()),color:"primary"},{default:r(()=>[A(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Fa as default};
