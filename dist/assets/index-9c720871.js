const C=/#/g,p=/&/g,O=/\//g,P=/=/g,l=/\+/g,I=/%5e/gi,S=/%60/gi,T=/%7c/gi,w=/%20/gi;function N(e){return encodeURI(""+e).replace(T,"|")}function h(e){return N(typeof e=="string"?e:JSON.stringify(e)).replace(l,"%2B").replace(w,"+").replace(C,"%23").replace(p,"%26").replace(S,"`").replace(I,"^").replace(O,"%2F")}function i(e){return h(e).replace(P,"%3D")}function E(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function Q(e){return E(e.replace(l," "))}function b(e){return E(e.replace(l," "))}function U(e=""){const t={};e[0]==="?"&&(e=e.slice(1));for(const o of e.split("&")){const r=o.match(/([^=]+)=?(.*)/)||[];if(r.length<2)continue;const n=Q(r[1]);if(n==="__proto__"||n==="constructor")continue;const c=b(r[2]||"");t[n]===void 0?t[n]=c:Array.isArray(t[n])?t[n].push(c):t[n]=[t[n],c]}return t}function j(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(o=>`${i(e)}=${h(o)}`).join("&"):`${i(e)}=${h(t)}`:i(e)}function $(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>j(t,e[t])).filter(Boolean).join("&")}const x=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,G=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,H=/^([/\\]\s*){2,}[^/\\]/,W=/\/$|\/\?|\/#/,B=/^\.?\//;function m(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?x.test(e):G.test(e)||(t.acceptRelative?H.test(e):!1)}function f(e="",t){return t?W.test(e):e.endsWith("/")}function K(e="",t){if(!t)return(f(e)?e.slice(0,-1):e)||"/";if(!f(e,!0))return e||"/";let o=e,r="";const n=e.indexOf("#");n>=0&&(o=e.slice(0,n),r=e.slice(n));const[c,...s]=o.split("?");return((c.endsWith("/")?c.slice(0,-1):c)||"/")+(s.length>0?`?${s.join("?")}`:"")+r}function v(e="",t){if(!t)return e.endsWith("/")?e:e+"/";if(f(e,!0))return e||"/";let o=e,r="";const n=e.indexOf("#");if(n>=0&&(o=e.slice(0,n),r=e.slice(n),!o))return r;const[c,...s]=o.split("?");return c+"/"+(s.length>0?`?${s.join("?")}`:"")+r}function J(e,t){if(D(t)||m(e))return e;const o=K(t);return e.startsWith(o)?e:V(o,e)}function z(e,t){const o=y(e),r={...U(o.search),...t};return o.search=$(r),X(o)}function D(e){return!e||e==="/"}function M(e){return e&&e!=="/"}function V(e,...t){let o=e||"";for(const r of t.filter(n=>M(n)))if(o){const n=r.replace(B,"");o=v(o)+n}else o=r;return o}const g=Symbol.for("ufo:protocolRelative");function y(e="",t){const o=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(o){const[,u,R=""]=o;return{protocol:u.toLowerCase(),pathname:R,href:u+R,auth:"",host:"",search:"",hash:""}}if(!m(e,{acceptRelative:!0}))return t?y(t+e):_(e);const[,r="",n,c=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,s="",a=""]=c.match(/([^#/?]*)(.*)?/)||[];r==="file:"&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:A,search:L,hash:d}=_(a);return{protocol:r.toLowerCase(),auth:n?n.slice(0,Math.max(0,n.length-1)):"",host:s,pathname:A,search:L,hash:d,[g]:!r}}function _(e=""){const[t="",o="",r=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:o,hash:r}}function X(e){const t=e.pathname||"",o=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",r=e.hash||"",n=e.auth?e.auth+"@":"",c=e.host||"";return(e.protocol||e[g]?(e.protocol||"")+"//":"")+n+c+t+o+r}export{J as a,$ as s,z as w};
