import{u as I}from"./useCrudUserStore-60a9b398.js";import{d as E,a0 as A,k as N,$ as R,r as U,E as M,w as _,ay as F,a6 as Q,a as j,o as q,c as G,b as t,f as a,n as l,az as H,e as i,a4 as g,a9 as f,t as J,a1 as v,v as h,a7 as y}from"./index-8c389af3.js";import{S as K}from"./sweetalert2.all-ae952bba.js";import{V as C}from"./VCardText-7117b919.js";import{V as w}from"./VContainer-976259ee.js";import{V as L}from"./VSelect-7488be5c.js";import{V as O}from"./VSpacer-25f8ce6b.js";import{V as W}from"./VChip-03840711.js";import{V as X}from"./VRow-a7e43a76.js";import{V as Y}from"./VPagination-2c76b541.js";import{V as Z}from"./VCard-6ec5f0a2.js";import{V as tt}from"./VDataTable-631d8f68.js";import"./_commonjsHelpers-725317a4.js";import"./VTextField-cb9ff5f9.js";import"./VField-dd4f5130.js";import"./VImg-60b92111.js";import"./VList-ce46d66b.js";import"./ssrBoot-5165eff3.js";import"./VAvatar-c2c6df3a.js";import"./VDivider-85d289a2.js";import"./dialog-transition-93124d6f.js";import"./VMenu-e0085981.js";const et={class:"me-3",style:{"inline-size":"80px"}},at={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},ot={colspan:"4"},st={style:{"inline-size":"100"},class:"d-flex justify-center"},nt={class:"text-sm text-disabled"},Pt=E({__name:"Index",setup(lt){const c=I(),k=A(),b=N(),{currentPage:n,totalPage:u,lastPage:S,totalData:D,users:p,loading:z}=R(c),r=U(10),m=async(s=[])=>{await c.fetchAll({company_id:k.company.id,perPage:r.value,page:n.value,searchQuery:s})};M(async()=>{await m()}),_(n,async()=>{n.value>u.value&&(n.value=u.value)}),_(r,async()=>{n.value=1}),F([n,r],async()=>{await m()});const P=Q(()=>{const s=p.value.length?(n.value-1)*u.value+1:0,e=p.value.length+(n.value-1)*u.value;return`Mostrando ${s} a ${e} de ${D.value} registros`}),V=async(s="create",e)=>{b.push({name:"Users-Form",params:{action:s,id:e}})},B=async(s,e)=>{const d=!s[e];(await c.changeState({id:s.id,value:d,field:e})).code==200&&(s.state=d)},T=async s=>{K.fire({title:"Â¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async e=>{e.isConfirmed?(await c.fetchDelete(s),await m()):e.isDenied})},$=[{title:"Nombre",key:"name"},{title:"Correo",key:"email"},{title:"Rol",key:"role"},{title:"Estado",key:"state"},{title:"Acciones",key:"actions"}];return(s,e)=>{const d=j("PreloadInterno");return q(),G("div",null,[t(Z,null,{default:a(()=>[t(C,null,{default:a(()=>[t(l(tt),{headers:$,items:l(p),"items-per-page":5},H({top:a(()=>[t(w,{fluid:"",class:"d-flex flex-wrap py-4 gap-4"},{default:a(()=>[i("div",et,[t(L,{modelValue:l(r),"onUpdate:modelValue":e[0]||(e[0]=o=>g(r)?r.value=o:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),t(O),i("div",at,[t(f,{color:"primary",onClick:e[1]||(e[1]=o=>V())},{default:a(()=>[J(" Crear usuario ")]),_:1})])]),_:1})]),"item.state":a(({item:o})=>[t(W,{color:o.state==1?"success":"error",onClick:x=>B(o,"state")},{default:a(()=>[t(v,{start:"",size:"16",icon:o.state==1?"tabler-bell":"tabler-alert-circle"},null,8,["icon"]),i("span",null,h(o.state==1?"Activo":"Inactivo"),1),t(y,{location:"top",transition:"scale-transition",activator:"parent",text:"Cambiar Estado"})]),_:2},1032,["color","onClick"])]),"item.actions":a(({item:o})=>[t(f,{icon:"",size:"x-small",color:"error",variant:"text",onClick:x=>T(o.id)},{default:a(()=>[t(v,{size:"22",icon:"tabler-trash"}),t(y,{location:"top",transition:"scale-transition",activator:"parent",text:"Eliminar"})]),_:2},1032,["onClick"]),t(f,{icon:"",size:"x-small",color:"default",variant:"text",onClick:x=>V("edit",o.id)},{default:a(()=>[t(v,{size:"22",icon:"tabler-edit"}),t(y,{location:"top",transition:"scale-transition",activator:"parent",text:"Editar"})]),_:2},1032,["onClick"])]),bottom:a(()=>[t(C,{class:"pt-2"},{default:a(()=>[t(X,null,{default:a(()=>[t(w,{fluid:"",class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:a(()=>[i("span",nt,h(l(P)),1),t(Y,{modelValue:l(n),"onUpdate:modelValue":e[2]||(e[2]=o=>g(n)?n.value=o:null),size:"small","total-visible":5,length:l(S)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:2},[l(z).table?{name:"body",fn:a(()=>[i("tr",null,[i("td",ot,[i("div",st,[t(d)])])])]),key:"0"}:void 0]),1032,["items"])]),_:1})]),_:1})])}}});export{Pt as default};
