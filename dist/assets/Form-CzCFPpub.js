import{V as z,r as f}from"./VForm-BOvub0yM.js";import{s as L}from"./helpers-DpEV7f3y.js";import{d as P,U as R,r as u,ax as O,M as Z,Z as C,o as b,c as H,b as t,f as i,k as e,q as J,af as B,ac as K,g as U,C as $,e as k,ad as Q,G as W,al as X,ay as Y}from"./index-Beckcyx0.js";import{_ as h}from"./BtnBack.vue_vue_type_script_setup_true_lang-CNQhZltC.js";import{_ as ee}from"./AppTextField.vue_vue_type_script_setup_true_lang-DHJAiZPb.js";import{_ as ae}from"./AppSelect.vue_vue_type_script_setup_true_lang-B1_3oUZk.js";import{u as le,V as oe}from"./VFileInput-CUfWmBFC.js";import{V as te,b as re}from"./VCard-Dl-v77MZ.js";import{V as S}from"./VGrid-BuZ444Te.js";import{V as T,a as m}from"./VRow-C5AQkx25.js";import{V as ie}from"./VImg-hrG_q8t5.js";import"./VInput-DfRUPHc8.js";import"./VOverlay-CInLCweo.js";import"./forwardRefs-C-GTDzx5.js";import"./constants-2GBt7OCP.js";import"./ModalQuestion.vue_vue_type_script_setup_true_lang-DKqZcpIX.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-DfLnVt2Q.js";import"./VDialog-LwCmN1GJ.js";import"./dialog-transition-DfVxIrSo.js";import"./VTooltip-_UTdwfxP.js";import"./VTextField-BOnq8RWc.js";import"./VSelect-BBDYoSot.js";import"./VList-mp1GnCW_.js";import"./ssrBoot-pwlHSkgy.js";import"./VAvatar-Dv33BZj0.js";import"./VDivider-BjwItKp1.js";import"./VMenu-FixnG40M.js";import"./VCheckboxBtn-CJntfbgY.js";import"./VSelectionControl-LLIosjUH.js";import"./VChip-BErw9K7y.js";import"./sweetalert2.esm.all-DOYwHpwi.js";const se=k("span",null," Formulario estudiante ",-1),de=k("b",{class:"text-warning"},"*",-1),ne={style:{"block-size":"200px","inline-size":"200px"}},Pe=P({__name:"Form",setup(ue){const j=R(),{toast:D}=Y(),c=u({}),_=u(!1),F=J(),q=u(),d=O({form:!1}),g=u([]),w=u([]),l=u({id:null,type_education_id:null,grade_id:null,section_id:null,identity_document:null,full_name:null,photo:null,company_id:null}),I=()=>{for(const a in l.value)l.value[a]=null},E=async()=>{var n;l.value.id=F.params.id||null;const a=l.value.id?`/student/${l.value.id}/edit`:"/student/create";d.form=!0;const{response:o,data:s}=await B(a).get();d.form=!1,(n=o.value)!=null&&n.ok&&s.value&&(g.value=s.value.typeEducations,w.value=s.value.sections,s.value.form&&(l.value=s.value.form))},N=async()=>{var o,s;const a=await((o=q.value)==null?void 0:o.validate());if(a!=null&&a.valid){l.value.company_id=j.company.id;const n=l.value.id?`/student/update/${l.value.id}`:"/student/store",v=new FormData;for(const y in l.value)["arrayDetails"].includes(y)||v.append(y,l.value[y]);d.form=!0;const{data:r,response:M}=await B(n).post(v);d.form=!1,(s=M.value)!=null&&s.ok&&r.value&&r.value.code==200&&X.push({name:"Student-List"}),r.value.code===422&&(c.value=r.value.errors??{})}else D("Faltan Campos Por Diligenciar","","danger")};F.params.action=="view"&&(_.value=!0),Z(async()=>{I(),await E()});const V=C(()=>Object.values(d).some(a=>a)),p=u(le()),x=["jpg","jpeg","png"];p.value.allowedExtensions=x;const A=a=>{d.form=!0,p.value.handleImageSelected(a),setTimeout(()=>{l.value.photo=p.value.imageFile,d.form=!1},1e3)},G=C(()=>l.value.type_education_id?g.value.find(a=>a.value==l.value.type_education_id).grades:[]);return(a,o)=>{const s=ae,n=ee,v=h;return b(),H("div",null,[t(te,{disabled:e(d).form,loading:e(d).form},{default:i(()=>[t(re,{class:"d-flex justify-space-between"},{default:i(()=>[se]),_:1}),t(S,null,{default:i(()=>[t(z,{ref_key:"formValidation",ref:q,onSubmit:K(()=>{},["prevent"]),disabled:e(_)},{default:i(()=>[t(T,null,{default:i(()=>[t(m,{cols:"12",sm:"3"},{default:i(()=>[t(s,{items:e(g),clearable:"",rules:["requiredValidator"in a?a.requiredValidator:e(f)],modelValue:e(l).type_education_id,"onUpdate:modelValue":o[0]||(o[0]=r=>e(l).type_education_id=r),label:"Tipo de educación"},null,8,["items","rules","modelValue"])]),_:1}),t(m,{cols:"12",sm:"3"},{default:i(()=>[t(s,{clearable:"",items:e(G),rules:["requiredValidator"in a?a.requiredValidator:e(f)],modelValue:e(l).grade_id,"onUpdate:modelValue":o[1]||(o[1]=r=>e(l).grade_id=r),label:"Grados y niveles"},null,8,["items","rules","modelValue"])]),_:1}),t(m,{cols:"12",sm:"3"},{default:i(()=>[t(s,{clearable:"",items:e(w),rules:["requiredValidator"in a?a.requiredValidator:e(f)],modelValue:e(l).section_id,"onUpdate:modelValue":o[2]||(o[2]=r=>e(l).section_id=r),label:"Secciones"},null,8,["items","rules","modelValue"])]),_:1}),t(m,{cols:"12",sm:"3"},{default:i(()=>[t(n,{clearable:"",modelValue:e(l).identity_document,"onUpdate:modelValue":o[3]||(o[3]=r=>e(l).identity_document=r),rules:["requiredValidator"in a?a.requiredValidator:e(f)],"error-messages":e(c).identity_document,label:"Cédula de identidad",onInput:o[4]||(o[4]=r=>e(c).identity_document=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(m,{cols:"12",sm:"6"},{default:i(()=>[t(n,{clearable:"",modelValue:e(l).full_name,"onUpdate:modelValue":o[5]||(o[5]=r=>e(l).full_name=r),rules:["requiredValidator"in a?a.requiredValidator:e(f)],"error-messages":e(c).full_name,label:"Nombre completo",onInput:o[6]||(o[6]=r=>e(c).full_name=""),requiredField:!0},null,8,["modelValue","rules","error-messages"])]),_:1}),t(m,{cols:"12",sm:"3"},{default:i(()=>[(b(),U(oe,{accept:"image/*",key:e(p).key,onChange:o[7]||(o[7]=r=>A(r)),"onClick:clear":e(p).clearData},{label:i(()=>[$(" Foto "),de]),_:1},8,["onClick:clear"]))]),_:1})]),_:1}),t(T,null,{default:i(()=>[t(m,{cols:"12",class:"d-flex justify-center"},{default:i(()=>[k("div",ne,[t(ie,{src:e(p).imageUrl??("storageBack"in a?a.storageBack:e(L))(e(l).photo),alt:"alt"},null,8,["src"])])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1}),t(S,{class:"d-flex justify-end gap-3 flex-wrap mt-5"},{default:i(()=>[t(v,{disabled:e(V),loading:e(V)},null,8,["disabled","loading"]),e(_)?W("",!0):(b(),U(Q,{key:0,disabled:e(V),loading:e(V),onClick:o[8]||(o[8]=r=>N()),color:"primary"},{default:i(()=>[$(" Guardar ")]),_:1},8,["disabled","loading"]))]),_:1})]),_:1},8,["disabled","loading"])])}}});export{Pe as default};
